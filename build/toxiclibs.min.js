var toxi;!function(){var t,e,i;!function(n){function r(t,e){return b.call(t,e)}function s(t,e){var i,n,r,s,o,a,h,u,c,l,f,p=e&&e.split("/"),d=x.map,g=d&&d["*"]||{};if(t&&"."===t.charAt(0))if(e){for(p=p.slice(0,p.length-1),t=t.split("/"),o=t.length-1,x.nodeIdCompat&&S.test(t[o])&&(t[o]=t[o].replace(S,"")),t=p.concat(t),c=0;c<t.length;c+=1)if(f=t[c],"."===f)t.splice(c,1),c-=1;else if(".."===f){if(1===c&&(".."===t[2]||".."===t[0]))break;c>0&&(t.splice(c-1,2),c-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((p||g)&&d){for(i=t.split("/"),c=i.length;c>0;c-=1){if(n=i.slice(0,c).join("/"),p)for(l=p.length;l>0;l-=1)if(r=d[p.slice(0,l).join("/")],r&&(r=r[n])){s=r,a=c;break}if(s)break;!h&&g&&g[n]&&(h=g[n],u=c)}!s&&h&&(s=h,a=u),s&&(i.splice(0,a,s),t=i.join("/"))}return t}function o(t,e){return function(){return p.apply(n,w.call(arguments,0).concat([t,e]))}}function a(t){return function(e){return s(e,t)}}function h(t){return function(e){m[t]=e}}function u(t){if(r(y,t)){var e=y[t];delete y[t],v[t]=!0,f.apply(n,e)}if(!r(m,t)&&!r(v,t))throw new Error("No "+t);return m[t]}function c(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function l(t){return function(){return x&&x.config&&x.config[t]||{}}}var f,p,d,g,m={},y={},x={},v={},b=Object.prototype.hasOwnProperty,w=[].slice,S=/\.js$/;d=function(t,e){var i,n=c(t),r=n[0];return t=n[1],r&&(r=s(r,e),i=u(r)),r?t=i&&i.normalize?i.normalize(t,a(e)):s(t,e):(t=s(t,e),n=c(t),r=n[0],t=n[1],r&&(i=u(r))),{f:r?r+"!"+t:t,n:t,pr:r,p:i}},g={require:function(t){return o(t)},exports:function(t){var e=m[t];return"undefined"!=typeof e?e:m[t]={}},module:function(t){return{id:t,uri:"",exports:m[t],config:l(t)}}},f=function(t,e,i,s){var a,c,l,f,p,x,b=[],w=typeof i;if(s=s||t,"undefined"===w||"function"===w){for(e=!e.length&&i.length?["require","exports","module"]:e,p=0;p<e.length;p+=1)if(f=d(e[p],s),c=f.f,"require"===c)b[p]=g.require(t);else if("exports"===c)b[p]=g.exports(t),x=!0;else if("module"===c)a=b[p]=g.module(t);else if(r(m,c)||r(y,c)||r(v,c))b[p]=u(c);else{if(!f.p)throw new Error(t+" missing "+c);f.p.load(f.n,o(s,!0),h(c),{}),b[p]=m[c]}l=i?i.apply(m[t],b):void 0,t&&(a&&a.exports!==n&&a.exports!==m[t]?m[t]=a.exports:l===n&&x||(m[t]=l))}else t&&(m[t]=i)},t=e=p=function(t,e,i,r,s){if("string"==typeof t)return g[t]?g[t](e):u(d(t,e).f);if(!t.splice){if(x=t,x.deps&&p(x.deps,x.callback),!e)return;e.splice?(t=e,e=i,i=null):t=n}return e=e||function(){},"function"==typeof i&&(i=r,r=s),r?f(n,t,e,i):setTimeout(function(){f(n,t,e,i)},4),p},p.config=function(t){return p(t)},t._defined=m,i=function(t,e,i){e.splice||(i=e,e=[]),r(m,t)||r(y,t)||(y[t]=[t,e,i])},i.amd={jQuery:!0}}(),i("almond",function(){}),i("toxi/internals/has",["require","exports","module"],function(t,e){var i=function(t,e){if(void 0===t||"object"!=typeof t)return!1;var i,n=0,r=e.length;for(n=0;r>n;n++)if(i=e[n],!(i in t))return!1;return!0};e.property=function(t,e){return hasOwnProperty.call(t,e)},e.all=i,e.typedArrays=function(){return"undefined"!=typeof Int32Array&&"undefined"!=typeof Float32Array&&"undefined"!=typeof Uint8Array},e.XY=function(t){return t&&"number"==typeof t.x&&"number"==typeof t.y},e.XYZ=function(t){return t&&"number"==typeof t.x&&"number"==typeof t.y&&"number"==typeof t.z},e.XYWidthHeight=function(t){return t&&"number"==typeof t.x&&"number"==typeof t.y&&"number"==typeof t.width&&"number"==typeof t.height}}),i("toxi/internals/is",["./has","exports"],function(t,e){var i=function(e){return function(i){return t.all(i,e)}};e.Array=Array.isArray||function(t){return"[object Array]"==t.toString()},e.Object=function(t){return"object"==typeof t},e.undef=function(t){return void 0===t},e.existy=function(t){return null!=t},e.String=function(t){return"string"==typeof t},e.Number=function(t){return"number"==typeof t},e.Function=function(t){return"function"==typeof t},e.AABB=i(["setExtent","getNormalForPoint"]),e.ColorGradient=i(["gradient","interpolator","maxDither","addColorAt","calcGradient"]),e.ColorList=i(["add","addAll","adjustBrightness","adjustSaturation"]),e.ColorRange=i(["add","addAlphaRange","addBrightnessRange","addHueRange"]),e.Circle=i(["getCircumference","getRadius","intersectsCircle"]),e.FloatRange=i(["min","max","adjustCurrentBy","getMedian"]),e.Hue=i(["getHue","isPrimary"]),e.Line2D=i(["closestPointTo","intersectLine","getLength"]),e.Matrix4x4=i(["identity","invert","setFrustrum"]),e.Rect=i(["x","y","width","height","getArea","getCentroid","getDimensions"]),e.Sphere=i(["x","y","z","radius","toMesh"]),e.ScaleMap=i(["mapFunction","setInputRange","setOutputRange","getMappedValueFor"]),e.TColor=i(["rgb","cmyk","hsv"]),e.ParticleBehavior=i(["applyBehavior","configure"]),e.VerletParticle2D=i(["x","y","weight"])}),i("toxi/internals/extend",["require"],function(){return function(t,e){if("function"!=typeof t)throw Error("childClass was not function, possible circular: ",t);if("function"!=typeof e)throw Error("superClass was not function, possible circular: ",e);t.prototype=Object.create(e.prototype),t.constructor=t,t.prototype.parent=e.prototype}}),i("toxi/internals/each",["require"],function(){var t={};return function(e,i,n){if(null!=e)if(Array.prototype.forEach&&e.forEach===Array.prototype.forEach)e.forEach(i,n);else if(e.length===+e.length){for(var r=0,s=e.length;s>r;r++)if(r in e&&i.call(n,e[r],r,e)===t)return}else for(var o in e)if(hasOwnProperty.call(e,o)&&i.call(n,e[o],o,e)===t)return}}),i("toxi/internals/bind",["require"],function(){var t={};return function(e,i){var n,r,s=Function.prototype,o=Array.prototype.slice;return e.bind===s.bind&&s.bind?s.bind.apply(e,o.call(arguments,1)):(n=o.call(arguments,2),r=function(){if(!(this instanceof r))return e.apply(i,n.concat(o.call(arguments)));t.prototype=e.prototype;var s=new t;t.prototype=null;var a=e.apply(s,n.concat(o.call(arguments)));return Object(a)===a?a:s})}}),i("toxi/internals/keys",["require"],function(){return Object.keys||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var i in t)exports.has(t,i)&&e.push(i);return e}}),i("toxi/internals/values",["./has"],function(t){return function(e){var i=[];for(var n in e)t.property(e,n)&&i.push(e[n]);return i}}),i("toxi/internals/filter",[],function(){return function(t,e,i){var n=[];return null==t?n:Array.prototype.filter&&t.filter===Array.prototype.filter?t.filter(e,i):(exports.each(t,function(t,r,s){e.call(i,t,r,s)&&(n[n.length]=t)}),n)}}),i("toxi/internals/mixin",["./each"],function(t){return function(e,i){return t(i,function(t,i){e[i]=t}),e}}),i("toxi/internals/Iterator",["./is"],function(t){var e=function(t){this.__it=t.slice(0)};e.prototype={hasNext:function(){return this.__it.length>0},next:function(){return this.__it.shift()}};var i=function(t){this.__obj={},this.__keys=[];for(var i in t)this.__obj[i]=t[i],this.__keys.push(i);this.__it=new e(this.__keys)};i.prototype={hasNext:function(){return this.__it.hasNext()},next:function(){var t=this.__it.next();return this.__obj[t]}};var n=function(n){return t.array(n)?new e(n):new i(n)};return n}),i("toxi/internals/LinkedMap",["./each"],function(t){var e=function(t){this.__list=[],this.__map={},this.__inverseMap={},"function"==typeof t&&(this.generateKey=t)};return e.prototype={each:function(e){t(this.__map,e)},get:function(t){var e=this,i=function(){return void 0!==e.__inverseMap[t]?t:e.__map[t]},n=i();return void 0===n&&(t=this.generateKey(t),n=i()),n},generateKey:function(t){return t.toString()},getArray:function(){return this.__list},has:function(t){var e=this,i=function(t){return void 0!==e.__map[t]||void 0!==e.__inverseMap[t]};return i(t)?!0:i(this.generateKey(t))},put:function(t,e){t=this.generateKey(t),this.__map[t]=e,this.__inverseMap[e]=t,this.__list.push(e)},remove:function(t){t=this.get(t);var e=this.__inverseMap[t];return delete this.__inverseMap[t],delete this.__map[e],this.__list.splice(this.__list.indexOf(t),1)[0]},size:function(){return this.__list.length},values:function(){return this.getArray().slice(0)}},e}),i("toxi/internals/numberComparator",[],function(){return function(t,e){return t==e?0:e>t?-1:t>e?1:void 0}}),i("toxi/internals/removeItemFrom",[],function(){return function(t,e){var i=e.indexOf(t);return i>-1?e.splice(i,1):void 0}}),i("toxi/internals",["require","exports","module","./internals/is","./internals/has","./internals/extend","./internals/each","./internals/bind","./internals/keys","./internals/values","./internals/filter","./internals/mixin","./internals/Iterator","./internals/LinkedMap","./internals/numberComparator","./internals/removeItemFrom"],function(t,e){e.is=t("./internals/is"),e.has=t("./internals/has"),e.extend=t("./internals/extend"),e.each=t("./internals/each"),e.bind=t("./internals/bind"),e.keys=t("./internals/keys"),e.values=t("./internals/values"),e.filter=t("./internals/filter"),e.mixin=t("./internals/mixin"),e.Iterator=t("./internals/Iterator"),e.LinkedMap=t("./internals/LinkedMap"),e.numberComparator=t("./internals/numberComparator"),e.removeItemFrom=t("./internals/removeItemFrom")}),i("toxi/color/accessors",["require","exports","module","../internals","../internals"],function(t,e){function i(t,i){var s=t+"Accessor",o=t.toLowerCase();e[s]=function(t){this.component=t,this.compare=r(this.compare,this)},e[s].prototype.compare=function(t,e){var i=t[o][this.component],r=e[o][this.component];return n(i,r)},e[s].prototype.getComponentValueFor=function(t){return t[o][this.component]},e[s].prototype.setComponentValueFor=function(t,e){t["set"+i[this.component]](e)}}var n=t("../internals").numberComparator,r=t("../internals").bind;i("RGB",["Red","Green","Blue"]),i("HSV",["Hue","Saturation","Brightness"]),i("CMYK",["Cyan","Magenta","Yellow","Black"]);var s=function(){};s.prototype.compare=function(t,e){return n(t.luminance(),e.luminance())},s.prototype.getComponentValueFor=function(t){return t.luminance()},s.prototype.setComponentValueFor=function(){};var o=function(){};o.prototype.compare=function(t,e){return n(t.alpha(),e.alpha())},o.prototype.getComponentValueFor=function(t){return t.alpha()},o.prototype.setComponentValueFor=function(t,e){t.setAlpha(e)},e.LuminanceAccessor=s,e.AlphaAccessor=o}),i("toxi/color/HSVAccessor",["require","./accessors"],function(t){return t("./accessors").HSVAccessor}),i("toxi/color/RGBAccessor",["require","./accessors"],function(t){return t("./accessors").RGBAccessor}),i("toxi/color/CMYKAccessor",["require","./accessors"],function(t){return t("./accessors").CMYKAccessor}),i("toxi/color/AlphaAccessor",["require","./accessors"],function(t){return t("./accessors").AlphaAccessor}),i("toxi/color/LuminanceAccessor",["require","./accessors"],function(t){return t("./accessors").LuminanceAccessor}),i("toxi/color/accessCriteria",["require","exports","module","./HSVAccessor","./RGBAccessor","./CMYKAccessor","./AlphaAccessor","./LuminanceAccessor"],function(t,e){var i=t("./HSVAccessor"),n=t("./RGBAccessor"),r=t("./CMYKAccessor"),s=t("./AlphaAccessor"),o=t("./LuminanceAccessor");e.HUE=new i(0),e.SATURATION=new i(1),e.BRIGHTNESS=new i(2),e.RED=new n(0),e.GREEN=new n(1),e.BLUE=new n(2),e.CYAN=new r(0),e.MAGENTA=new r(1),e.YELLOW=new r(2),e.BLACK=new r(3),e.ALPHA=new s,e.LUMINANCE=new o}),i("toxi/color/distanceProxies",["require","exports","module"],function(t,e){function i(t){var i=t+"DistanceProxy";e[i]=function(){},e[i].prototype.distanceBetween=function(e,i){return e["distanceTo"+t](i)}}i("HSV"),i("RGB"),i("CMYK")}),i("toxi/color/CMYKDistanceProxy",["require","./distanceProxies"],function(t){return t("./distanceProxies").CMYKDistanceProxy}),i("toxi/math/mathUtils",[],function(){var t={};return t.SQRT2=Math.sqrt(2),t.SQRT3=Math.sqrt(3),t.LOG2=Math.log(2),t.PI=3.141592653589793,t.INV_PI=1/t.PI,t.HALF_PI=t.PI/2,t.THIRD_PI=t.PI/3,t.QUARTER_PI=t.PI/4,t.TWO_PI=2*t.PI,t.THREE_HALVES_PI=t.TWO_PI-t.HALF_PI,t.PI_SQUARED=t.PI*t.PI,t.EPS=1.1920928955078125e-7,t.DEG2RAD=t.PI/180,t.RAD2DEG=180/t.PI,t.SHIFT23=1<<23,t.INV_SHIFT23=1/t.SHIFT23,t.SIN_A=-4/(t.PI*t.PI),t.SIN_B=4/t.PI,t.SIN_P=.225,t.abs=Math.abs,t.ceilPowerOf2=function(t){for(var e=1;t>e;)e<<=1;return e},t.clip=function(t,e,i){return e>t?e:t>i?i:t},t.clipNormalized=function(t){return 0>t?0:t>1?1:t},t.cos=Math.cos,t.degrees=function(e){return e*t.RAD2DEG},t.fastCos=function(e){return t.fastSin(e+(e>t.HALF_PI?-t.THREE_HALVES_PI:t.HALF_PI))},t.fastSin=function(e){return e=t.SIN_B*e+t.SIN_A*e*Math.abs(e),t.SIN_P*(e*Math.abs(e)-e)+e},t.flipCoin=function(){return Math.random()<.5},t.floor=function(t){var e=~~t;return 0>t&&t!=e&&e--,e},t.floorPowerOf2=function(e){return~~Math.pow(2,parseInt(Math.log(e)/t.LOG2,10))},t.max=function(t,e,i){return void 0===i?Math.max(t,e):t>e?t>i?t:i:e>i?e:i},t.min=function(t,e,i){return void 0===i?Math.min(t,e):e>t?i>t?t:i:i>e?e:i},t.normalizedRandom=function(){return 2*Math.random()-1},t.radians=function(e){return e*t.DEG2RAD},t.random=function(t,e,i){return 1===arguments.length?Math.random()*arguments[0]:(2==arguments.length&&(i=e,e=t,t=Math.random),e||i?i?t()*(i-e)+e:(i=e,t()*i):Math.random())},t.reduceAngle=function(e){return e%=t.TWO_PI,Math.abs(e)>t.PI&&(e-=t.TWO_PI),Math.abs(e)>t.HALF_PI&&(e=t.PI-e),e},t.sign=function(t){return 0>t?-1:t>0?1:0},t.sin=function(e){return e=t.reduceAngle(e),Math.abs(e)<=t.QUARTER_PI?t.fastSin(e):t.fastCos(t.HALF_PI-e)},t}),i("toxi/math/LinearInterpolation",[],function(){var t=function(){},e=function(t,e,i){return t+(e-t)*i};return t.interpolate=e,t.prototype.interpolate=e,t}),i("toxi/geom/vectors",["require","exports","module","../math/mathUtils","../internals/has","../internals/is"],function(t,e){var i,n,r=t("../math/mathUtils"),s=t("../internals/has"),o=t("../internals/is"),a=s.XY,h=o.Rect;i=function(t,e){a(t)?(e=t.y,t=t.x):(t=t||0,e=e||0),this.x=t,this.y=e},i.Axis={X:{getVector:function(){return i.X_AXIS},toString:function(){return"Vec2D.Axis.X"}},Y:{getVector:function(){return i.Y_AXIS},toString:function(){return"Vec2D.Axis.Y"}}};var u=function(){var t={x:0,y:0};return function(e,i){return e&&"number"==typeof e.x&&"number"==typeof e.y?e:(void 0!==e&&void 0===i?i=e:void 0===e?e=0:void 0===i&&(i=0),t.x=e,t.y=i,t)}}();i.prototype={abs:function(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this},add:function(t,e){var n=new i(t,e);return n.x+=this.x,n.y+=this.y,n},addSelf:function(t,e){var i=u(t,e);return this.x+=i.x,this.y+=i.y,this},angleBetween:function(t,e){if(void 0===e){{this.dot(t)}return Math.acos(this.dot(t))}var i=e?this.getNormalized().dot(t.getNormalized()):this.dot(t);return Math.acos(i)},clear:function(){return this.x=this.y=0,this},compareTo:function(t){return this.x==t.x&&this.y==t.y?0:this.magSquared()-t.magSquared()},constrain:function(t,e){return a(t)&&a(e)?(this.x=r.clip(this.x,t.x,e.x),this.y=r.clip(this.y,t.y,e.y)):h(t)&&(this.x=r.clip(this.x,t.x,t.x+t.width),this.y=r.clip(this.y,t.y,t.y+t.height)),this},copy:function(){return new i(this)},cross:function(t){return this.x*t.y-this.y*t.x},distanceTo:function(t){if(void 0!==t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)}return 0/0},distanceToSquared:function(t){if(void 0!==t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i}return 0/0},dot:function(t){return this.x*t.x+this.y*t.y},equals:function(t){return a(t)?this.x==t.x&&this.y==t.y:!1},equalsWithTolerance:function(t,e){return a(t)&&r.abs(this.x-t.x)<e&&r.abs(this.y-t.y)<e?!0:!1},floor:function(){return this.x=r.floor(this.x),this.y=r.floor(this.y),this},frac:function(){return this.x-=r.floor(this.x),this.y-=r.floor(this.y),this},getAbs:function(){return new i(this).abs()},getComponent:function(t){return"number"==typeof t&&(t=0===t?i.Axis.X:i.Axis.Y),t==i.Axis.X?this.x:t==i.Axis.Y?this.y:0},getConstrained:function(t){return new i(this).constrain(t)},getFloored:function(){return new i(this).floor()},getFrac:function(){return new i(this).frac()},getInverted:function(){return new i(-this.x,-this.y)},getLimited:function(t){return this.magSquared()>t*t?this.getNormalizedTo(t):new i(this)},getNormalized:function(){return new i(this).normalize()},getNormalizedTo:function(t){return new i(this).normalizeTo(t)},getPerpendicular:function(){return new i(this).perpendicular()},getReciprocal:function(){return new i(this).reciprocal()},getReflected:function(t){return new i(this).reflect(t)},getRotated:function(t){return new i(this).rotate(t)},getSignum:function(){return new i(this).signum()},heading:function(){return Math.atan2(this.y,this.x)},interpolateTo:function(t,e,n){return void 0===n?new i(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e):new i(n.interpolate(this.x,t.x,e),n.interpolate(this.y,t.y,e))},interpolateToSelf:function(t,e,i){return void 0===i?(this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e):(this.x=i.interpolate(this.x,t.x,e),this.y=i.interpolate(this.y,t.y,e)),this},invert:function(){return this.x*=-1,this.y*=-1,this},isInCircle:function(t,e){var i=this.sub(t).magSquared();return e*e>=i},isInRectangle:function(t){return this.x<t.x||this.x>t.x+t.width?!1:this.y<t.y||this.y>t.y+t.height?!1:!0},isInTriangle:function(t,e,i){var n=this.sub(t).normalize(),s=this.sub(e).normalize(),o=this.sub(i).normalize(),a=Math.acos(n.dot(s));return a+=Math.acos(s.dot(o)),a+=Math.acos(o.dot(n)),Math.abs(a-r.TWO_PI)<=.005},isMajorAxis:function(t){var e=Math.abs(this.x),i=Math.abs(this.y),n=1-t;return e>n?t>i:i>n?t>e:!1},isZeroVector:function(){return Math.abs(this.x)<r.EPS&&Math.abs(this.y)<r.EPS},jitter:function(t,e){var i=u(t,e);return this.x+=r.normalizedRandom()*i.x,this.y+=r.normalizedRandom()*i.y,this},limit:function(t){return this.magSquared()>t*t?this.normalize().scaleSelf(t):this},magnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},magSquared:function(){return this.x*this.x+this.y*this.y},max:function(t){return new i(r.max(this.x,t.x),r.max(this.y,t.y))},maxSelf:function(t){return this.x=r.max(this.x,t.x),this.y=r.max(this.y,t.y),this},min:function(t){return new i(r.min(this.x,t.x),r.min(this.y,t.y))},minSelf:function(t){return this.x=r.min(this.x,t.x),this.y=r.min(this.y,t.y),this},normalize:function(){var t=this.x*this.x+this.y*this.y;return t>0&&(t=1/Math.sqrt(t),this.x*=t,this.y*=t),this},normalizeTo:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y);return e>0&&(e=t/e,this.x*=e,this.y*=e),this},perpendicular:function(){var t=this.x;return this.x=-this.y,this.y=t,this},positiveHeading:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);return this.y>=0?Math.acos(this.x/t):Math.acos(-this.x/t)+r.PI},reciprocal:function(){return this.x=1/this.x,this.y=1/this.y,this},reflect:function(t){return this.set(t.scale(2*this.dot(t)).subSelf(this))},rotate:function(t){var e=Math.cos(t),i=Math.sin(t),n=e*this.x-i*this.y;return this.y=i*this.x+e*this.y,this.x=n,this},roundToAxis:function(){return Math.abs(this.x)<.5?this.x=0:(this.x=this.x<0?-1:1,this.y=0),Math.abs(this.y)<.5?this.y=0:(this.y=this.y<0?-1:1,this.x=0),this},scale:function(t,e){var n=u(t,e);return new i(this.x*n.x,this.y*n.y)},scaleSelf:function(t,e){var i=u(t,e);return this.x*=i.x,this.y*=i.y,this},set:function(t,e){var i=u(t,e);return this.x=i.x,this.y=i.y,this},setComponent:function(t,e){return"number"==typeof t&&(t=0===t?i.Axis.X:i.Axis.Y),t===i.Axis.X?this.x=e:t===i.Axis.Y&&(this.y=e),this},signum:function(){return this.x=this.x<0?-1:0===this.x?0:1,this.y=this.y<0?-1:0===this.y?0:1,this},sub:function(t,e){var n=u(t,e);return new i(this.x-n.x,this.y-n.y)},subSelf:function(t,e){var i=u(t,e);return this.x-=i.x,this.y-=i.y,this},tangentNormalOfEllipse:function(t,e){var n=this.sub(t),r=e.x*e.x,s=e.y*e.y;return new i(n.x/r,n.y/s).normalize()},toArray:function(){return[this.x,this.y]},toCartesian:function(){var t=this.x*Math.cos(this.y);return this.y=this.x*Math.sin(this.y),this.x=t,this},toPolar:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);return this.y=Math.atan2(this.y,this.x),this.x=t,this},toString:function(){var t="{x:"+this.x+", y:"+this.y+"}";return t}},i.prototype.bisect=function(t){var e=this.sub(t),i=this.add(t),r=e.dot(i);return new n(e.x,e.y,-r/2)},i.prototype.to3DXY=function(){return new n(this.x,this.y,0)},i.prototype.to3DXZ=function(){return new n(this.x,0,this.y)},i.prototype.to3DYZ=function(){return new n(0,this.x,this.y)},i.X_AXIS=new i(1,0),i.Y_AXIS=new i(0,1),i.ZERO=new i,i.MIN_VALUE=new i(Number.MIN_VALUE,Number.MIN_VALUE),i.MAX_VALUE=new i(Number.MAX_VALUE,Number.MAX_VALUE),i.fromTheta=function(t){return new i(Math.cos(t),Math.sin(t))},i.max=function(t,e){return new i(r.max(t.x,e.x),r.max(t.y,e.y))},i.min=function(t,e){return new i(r.min(t.x,e.x),r.min(t.y,e.y))},i.randomVector=function(){var t=new i(2*Math.random()-1,2*Math.random()-1);return t.normalize()},n=function(t,e,i){s.XYZ(t)?(this.x=t.x,this.y=t.y,this.z=t.z):void 0===t?(this.x=0,this.y=0,this.z=0):(this.x=t,this.y=e,this.z=i)},n.prototype={abs:function(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this.z=Math.abs(this.z),this},add:function(t,e,i){return s.XYZ(t)?new n(this.x+t.x,this.y+t.y,this.z+t.z):new n(this.x+t,this.y+e,this.z+i)},addSelf:function(t,e,i){return void 0!==t&&void 0!==e&&void 0!==i?(this.x+=t,this.y+=e,this.z+=i):(this.x+=t.x,this.y+=t.y,this.z+=t.z),this},angleBetween:function(t,e){var i;return i=e?this.getNormalized().dot(t.getNormalized()):this.dot(t),Math.acos(i)},clear:function(){return this.x=this.y=this.z=0,this},compareTo:function(t){return this.x==t.x&&this.y==t.y&&this.z==t.z?0:this.magSquared()-t.magSqaured()},constrain:function(t,e){var i;return o.AABB(t)?(e=t.getMax(),i=t.getMin()):i=t,this.x=r.clip(this.x,i.x,e.x),this.y=r.clip(this.y,i.y,e.y),this.z=r.clip(this.z,i.z,e.z),this},copy:function(){return new n(this)},cross:function(t){return new n(this.y*t.z-t.y*this.z,this.z*t.x-t.z*this.x,this.x*t.y-t.x*this.y)},crossInto:function(t){var e=t.x,i=t.y,n=t.z;return result.x=this.y*n-i*this.z,result.y=this.z*e-n*this.x,result.z=this.x*i-e*this.y,result},crossSelf:function(t){var e=this.y*t.z-t.y*this.z,i=this.z*t.x-t.z*this.x;return this.z=this.x*t.y-t.x*this.y,this.y=i,this.x=e,this},distanceTo:function(t){if(void 0!==t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return Math.sqrt(e*e+i*i+n*n)}return 0/0},distanceToSquared:function(t){if(void 0!==t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return e*e+i*i+n*n}return 0/0},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},equals:function(t){return s.XYZ(t)?this.x==t.x&&this.y==t.y&&this.z==t.z:!1},equalsWithTolerance:function(t,e){return Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e&&Math.abs(this.z-t.z)<e?!0:!1},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},frac:function(){return this.x-=Math.floor(this.x),this.y-=Math.floor(this.y),this.z-=Math.floor(this.z),this},getAbs:function(){return new n(this).abs()},getComponent:function(t){switch("number"==typeof t&&(t=t===n.Axis.X?0:t===n.Axis.Y?1:2),t){case 0:return this.x;case 1:return this.y;case 2:return this.z}},getConstrained:function(t){return new n(this).constrain(t)},getFloored:function(){return new n(this).floor()},getFrac:function(){return new n(this).frac()},getInverted:function(){return new n(-this.x,-this.y,-this.z)},getLimited:function(t){return this.magSquared()>t*t?this.getNormalizedTo(t):new n(this)},getNormalized:function(){return new n(this).normalize()},getNormalizedTo:function(t){return new n(this).normalizeTo(t)},getReciprocal:function(){return this.copy().reciprocal()},getReflected:function(t){return this.copy().reflect(t)},getRotatedAroundAxis:function(t,e){return new n(this).rotateAroundAxis(t,e)},getRotatedX:function(t){return new n(this).rotateX(t)},getRotatedY:function(t){return new n(this).rotateY(t)},getRotatedZ:function(t){return new n(this).rotateZ(t)},getSignum:function(){return new n(this).signum()},headingXY:function(){return Math.atan2(this.y,this.x)},headingXZ:function(){return Math.atan2(this.z,this.x)},headingYZ:function(){return Math.atan2(this.y,this.z)},immutable:function(){return this},interpolateTo:function(t,e,i){return void 0===i?new n(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e,this.z+(t.z-this.z)*e):new n(i.interpolate(this.y,t.y,e),i.interpolate(this.y,t.y,e),i.interpolate(this.z,t.z,e))},interpolateToSelf:function(t,e,i){return void 0===i?(this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e):(this.x=i.interpolate(this.x,t.x,e),this.y=i.interpolate(this.y,t.y,e),this.z=i.interpolate(this.z,t.z,e)),this},invert:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},isInAABB:function(t,e){if(e){var i=e.x;if(this.x<t.x-i||this.x>t.x+i)return!1;if(i=e.y,this.y<t.y-i||this.y>t.y+i)return!1;if(i=e.y,this.z<t.z-i||this.y>t.z+i)return!1}return!0},isMajorAxis:function(t){var e=r.abs(this.x),i=r.abs(this.y),n=r.abs(this.z),s=1-t;if(e>s){if(t>i)return t>n}else if(i>s){if(t>e)return t>n}else if(n>s&&t>e)return t>i;return!1},isZeroVector:function(){return Math.abs(this.x)<r.EPS&&Math.abs(this.y)<r.EPS&&r.abs(this.z)<r.EPS},jitter:function(t,e,i){return(void 0===e||void 0===i)&&(e=i=t),this.x+=r.normalizedRandom()*t,this.y+=r.normalizedRandom()*e,this.z+=r.normalizedRandom()*i,this},limit:function(t){return this.magSquared()>t*t?this.normalize().scaleSelf(t):this},magnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},magSquared:function(){return this.x*this.x+this.y*this.y+this.z*this.z},maxSelf:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},minSelf:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},modSelf:function(t,e,i){return(void 0===e||void 0===i)&&(e=i=t),this.x%=t,this.y%=e,this.z%=i,this},normalize:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return t>0&&(t=1/t,this.x*=t,this.y*=t,this.z*=t),this},normalizeTo:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return e>0&&(e=t/e,this.x*=e,this.y*=e,this.z*=e),this},reciprocal:function(){return this.x=1/this.x,this.y=1/this.y,this.z=1/this.z,this},reflect:function(t){return this.set(t.scale(2*this.dot(t)).subSelf(this))},rotateAroundAxis:function(t,e){var i=t.x,n=t.y,r=t.z,s=i*this.x,o=i*this.y,a=i*this.z,h=n*this.x,u=n*this.y,c=n*this.z,l=r*this.x,f=r*this.y,p=r*this.z,d=Math.sin(e),g=Math.cos(e),m=i*(s+u+p)+(this.x*(n*n+r*r)-i*(u+p))*g+(-f+c)*d,y=n*(s+u+p)+(this.y*(i*i+r*r)-n*(s+p))*g+(l-a)*d,x=r*(s+u+p)+(this.z*(i*i+n*n)-r*(s+u))*g+(-h+o)*d;return this.x=m,this.y=y,this.z=x,this},rotateX:function(t){var e=Math.cos(t),i=Math.sin(t),n=e*this.z-i*this.y;return this.y=i*this.z+e*this.y,this.z=n,this},rotateY:function(t){var e=Math.cos(t),i=Math.sin(t),n=e*this.x-i*this.z;return this.z=i*this.x+e*this.z,this.x=n,this},rotateZ:function(t){var e=Math.cos(t),i=Math.sin(t),n=e*this.x-i*this.y;return this.y=i*this.x+e*this.y,this.x=n,this},roundToAxis:function(){return Math.abs(this.x)<.5?this.x=0:(this.x=this.x<0?-1:1,this.y=this.z=0),Math.abs(this.y)<.5?this.y=0:(this.y=this.y<0?-1:1,this.x=this.z=0),Math.abs(this.z)<.5?this.z=0:(this.z=this.z<0?-1:1,this.x=this.y=0),this},scale:function(t,e,i){return s.XYZ(t)?new n(this.x*t.x,this.y*t.y,this.z*t.z):((void 0===e||void 0===i)&&(e=i=t),new n(this.x*t,this.y*e,this.z*i))},scaleSelf:function(t,e,i){return s.XYZ(t)?(this.x*=t.x,this.y*=t.y,this.z*=t.z,this):((void 0===e||void 0===i)&&(e=i=t),this.x*=t,this.y*=e,this.z*=i,this)},set:function(t,e,i){return s.XYZ(t)?(this.x=t.x,this.y=t.y,this.z=t.z,this):((void 0===e||void 0===i)&&(e=i=t),this.x=t,this.y=e,this.z=i,this)},setXY:function(t){return this.x=t.x,this.y=t.y,this},shuffle:function(t){for(var e,i=0;t>i;i++)switch(Math.floor(3*Math.random())){case 0:e=this.x,this.x=this.y,this.z=e;break;case 1:e=this.x,this.x=this.z,this.z=e;break;case 2:e=this.y,this.y=this.z,this.z=e}return this},signum:function(){return this.x=this.x<0?-1:0===this.x?0:1,this.y=this.y<0?-1:0===this.y?0:1,this.z=this.z<0?-1:0===this.z?0:1,this},sub:function(t,e,i){return s.XYZ(t)?new n(this.x-t.x,this.y-t.y,this.z-t.z):((void 0===e||void 0===i)&&(e=i=t),new n(this.x-t,this.y-e,this.z-i))},subSelf:function(t,e,i){return s.XYZ(t)?(this.x-=t.x,this.y-=t.y,this.z-=t.z,this):((void 0===e||void 0===i)&&(e=i=t),this.x-=t,this.y-=e,this.z-=i,this)},to2DXY:function(){return new i(this.x,this.y)},to2DXZ:function(){return new i(this.x,this.z)},to2DYZ:function(){return new i(this.y,this.z)},toArray:function(){return[this.x,this.y,this.z]},toArray4:function(t){var e=this.toArray();return e[3]=t,e},toCartesian:function(){var t=this.x*Math.cos(this.z),e=t*Math.cos(this.y),i=this.x*Math.sin(this.z),n=t*Math.sin(this.y);return this.x=e,this.y=i,this.z=n,this},toSpherical:function(){var t=Math.abs(this.x)<=r.EPS?r.EPS:this.x,e=this.z,i=Math.sqrt(t*t+this.y*this.y+e*e);return this.z=Math.asin(this.y/i),this.y=Math.atan(e/t)+(0>t?Math.PI:0),this.x=i,this},toString:function(){return"[ x: "+this.x+", y: "+this.y+", z: "+this.z+"]"}},n.MIN_VALUE=new n(Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE),n.MAX_VALUE=new n(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),n.fromXYTheta=function(t){return new n(Math.cos(t),Math.sin(t),0)},n.fromXZTheta=function(t){return new n(Math.cos(t),0,Math.sin(t))},n.fromYZTheta=function(t){return new n(0,Math.cos(t),Math.sin(t))},n.max=function(t,e){return new n(Math.max(t.x,e.x),Math.max(t.y,e.y),Math.max(t.z,e.z))},n.min=function(t,e){return new n(Math.min(t.x,e.x),Math.min(t.y,e.y),Math.min(t.z,e.z))},n.randomVector=function(){var t=new n(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1);return t.normalize()},n.ZERO=new n(0,0,0),n.X_AXIS=new n(1,0,0),n.Y_AXIS=new n(0,1,0),n.Z_AXIS=new n(0,0,1),n.Axis={X:{getVector:function(){return n.X_AXIS},toString:function(){return"Vec3D.Axis.X"}},Y:{getVector:function(){return n.Y_AXIS},toString:function(){return"Vec3D.Axis.Y"}},Z:{getVector:function(){return n.Z_AXIS},toString:function(){return"Vec3D.Axis.Z"}}},e.Vec2D=i,e.Vec3D=n}),i("toxi/color/Hue",["../internals/LinkedMap","../internals/each"],function(t,e){var i,n=new t,r=[];return i=function(t,e,i){this._isPrimary=i===!0,this.name=t,this.hue=e,n.put(t,this),this._isPrimary&&r.push(this)},i.prototype={constructor:i,getHue:function(){return this.hue},getName:function(){return this.name},isPrimary:function(){return this._isPrimary},toString:function(){return"Hue: ID:"+this.name+" @ "+parseInt(360*this.hue,10)+" degrees"}},i.PRESETS={},e([["red",!0],["orange",!0],["yellow",!0],["lime"],["green",!0],["teal"],["cyan"],["azure"],["blue",!0],["indigo"],["purple",!0],["pink",!0]],function(t,e){var n=t[0],r=n.toUpperCase(),s=t[1];i[r]=new i(n,30*e/360,s),i.PRESETS[r]=i[r]}),i.PRIMARY_VARIANCE=.01,i.getClosest=function(t,i){t%=1,i=i===!0;var s,o=Number.MAX_VALUE,a=i?r:n.getArray();return e(a,function(e){var i=Math.min(Math.abs(e.getHue()-t),Math.abs(1+e.getHue()-t));o>i&&(o=i,s=e)}),s},i.getForName=function(t){return n.get(t)},i.isPrimary=function(t,e){e="number"==typeof e?e:i.PRIMARY_VARIANCE;for(var n=!1,s=0,o=r.length;o>s;s++){var a=r[s];if(Math.abs(t-a.getHue())<e){n=!0;break}}return n},i}),i("toxi/color/TColor",["require","exports","module","../math/mathUtils","../geom/vectors","../internals/numberComparator","../internals/is","./Hue"],function(t,e,i){function n(t){return t[0]=Math.floor(360*t[0]),t[1]=Math.floor(100*t[1]),t[2]=Math.floor(100*t[2]),t}function r(t,e){return(e=e||!1)?(t[0]=Math.floor(100*t[0]),t[1]=Math.floor(100*t[1]),t[2]=Math.floor(100*t[2]),"rgba("+t[0]+"%,"+t[1]+"%,"+t[2]+"%,"+t[3]+")"):(t[0]=Math.floor(255*t[0]),t[1]=Math.floor(255*t[1]),t[2]=Math.floor(255*t[2]),t)}var s=t("../internals/numberComparator"),o=t("../internals/is"),a=t("../math/mathUtils"),h=t("../geom/vectors"),u=h.Vec2D,c=h.Vec3D,l=t("./Hue"),f=function(t){return 0>t&&(t=4294967295+t+1),t.toString(16)},p=function(t){if(this.rgb=[],this.hsv=[],this.cmyk=[],this._alpha=1,void 0!==t){var e=t.toCMYKAArray();this.cmyk=e.splice(0,4),this.hsv=t.toHSVAArray().splice(0,3),this.rgb=t.toRGBAArray().splice(0,3),this._alpha=t._alpha}};p.prototype={add:function(t){return this.copy().addSelf(t)},addSelf:function(t){return this.rgb[0]=a.min(this.rgb[0]+t.rgb[0],1),this.rgb[1]=a.min(this.rgb[1]+t.rgb[1],1),this.rgb[2]=a.min(this.rgb[2]+t.rgb[2],1),this.setRGB(this.rgb)
},adjustConstrast:function(t){return this.hsv[2]<.5?this.darken(t):this.lighten(t)},adjustHSV:function(t,e,i){return this.setHSV([this.hsv[0]+t,this.hsv[1]+e,this.hsv[2]+i])},adjustRGB:function(t,e,i){return this.setRGB([this.rgb[0]+t,this.rgb[1]+e,this.rgb[2]+i])},alpha:function(){return this._alpha},analog:function(t,e){var i=a.degrees(t);return this.rotateRYB(i*a.normalizedRandom()),this.hsv[1]+=e*a.normalizedRandom(),this.hsv[2]+=e*a.normalizedRandom(),this.setHSV(this.hsv)},black:function(){return this.cmyk[3]},blend:function(t,e){void 0===e&&(e=.5);var i=t.toRGBAArray();return this.rgb[0]+=(i[0]-this.rgb[0])*e,this.rgb[1]+=(i[1]-this.rgb[1])*e,this.rgb[2]+=(i[2]-this.rgb[2])*e,this._alpha+=(t._alpha-this._alpha)*e,this.setRGB(this.rgb)},blue:function(){return this.rgb[2]},brightness:function(){return this.hsv[2]},complement:function(){return this.rotateRYB(180)},copy:function(){return new p(this)},cyan:function(){return this.cmyk[0]},darken:function(t){return this.hsv[2]=a.clip(this.hsv[2]-t,0,1),this.setHSV(this.hsv)},desaturate:function(t){return this.hsv[1]=a.clip(this.hsv[1]-t,0,1),this.setHSV(this.hsv)},differenceTo:function(t){return p.newRGB(Math.abs(this.rgb[0]-t.rgb[0]),Math.abs(this.rgb[1]-t.rgb[1]),Math.abs(this.rgb[2]-t.rgb[2]))},distanceToCMYK:function(t){var e=t.toCMYKAArray(),i=this.cmyk[0]-e[0],n=this.cmyk[1]-e[1],r=this.cmyk[2]-e[2],s=this.cmyk[3]-e[3];return Math.sqrt(i*i+n*n+r*r+s*s)},distanceToHSV:function(t){var e=this.hsv[0]*a.TWO_PI,i=t.hue()*a.TWO_PI,n=new c(a.cos(e)*this.hsv[1],a.sin(e)*this.hsv[1],this.hsv[2]),r=new c(a.cos(i)*t.saturation(),a.sin(i)*t.saturation(),t.brightness());return n.distanceTo(r)},distanceToRGB:function(t){var e=t.toRGBAArray(),i=this.rgb[0]-e[0],n=this.rgb[1]-e[1],r=this.rgb[2]-e[2];return Math.sqrt(i*i+n*n+r*r)},equals:function(t){if(o.TColor(t)){var e=t,i=e.rgb[0]-this.rgb[0],n=e.rgb[1]-this.rgb[1],r=e.rgb[2]-this.rgb[2],s=e.alpha()-this._alpha,a=Math.sqrt(i*i+n*n+r*r+s*s);return a<p.EPS}return!1},getAnalog:function(t,e){return new p(this).analog(t,e)},getBlended:function(t,e){return new p(this).blend(t,e)},getClosestHue:function(t){return l.getClosest(this.hsv[0],t===!0)},getComplement:function(){return new p(this).complement()},getComponentValue:function(t){return t.getComponentValueFor(this)},getDarkened:function(t){return new p(this).darken(t)},getDesaturated:function(t){return new p(this).desaturate(t)},getDifferenceTo:function(t){return this.copy().differenceTo(t)},getInverted:function(){return new p(this).invert()},getLightened:function(t){return new p(this).lighten(t)},getRotatedRYB:function(t){return new p(this).rotateRYB(t)},getSaturated:function(t){return new p(this).saturate(t)},green:function(){return this.rgb[1]},hue:function(){return this.hsv[0]},invert:function(){return this.rgb[0]=1-this.rgb[0],this.rgb[1]=1-this.rgb[1],this.rgb[2]=1-this.rgb[2],this.setRGB(this.rgb)},isBlack:function(){return this.rgb[0]<=p.BLACK_POINT&&this.rgb[0]===this.rgb[1]&&this.rgb[0]===this.rgb[2]},isGrey:function(){return this.hsv[1]<p.GREY_THRESHOLD},isWhite:function(){return this.rgb[0]>=p.WHITE_POINT&&this.rgb[0]===this.rgb[1]&&this.rgb[0]===this.rgb[2]},lighten:function(t){return this.hsv[2]=a.clip(this.hsv[2]+t,0,1),this.setHSV(this.hsv)},luminance:function(){return.299*this.rgb[0]+.587*this.rgb[1]+.114*this.rgb[2]},magenta:function(){return this.cmyk[1]},red:function(){return this.rgb[0]},rotateRYB:function(t){var e,i,n=(parseInt(a.degrees(t),10),360*this.hsv[0]),r=0;t%=360;var s=0;for(r=0;r<p.RYB_WHEEL.length-1;r++)if(e=p.RYB_WHEEL[r],i=p.RYB_WHEEL[r+1],i.y<e.y&&(i.y+=360),e.y<=n&&n<=i.y){s=e.x+(i.x-e.x)*(n-e.y)/(i.y-e.y);break}for(s=(s+t)%360,r=0;r<p.RYB_WHEEL.length-1;r++)if(e=p.RYB_WHEEL[r],i=p.RYB_WHEEL[r+1],i.y<e.y&&(i.y+=360),e.x<=s&&s<=i.x){n=e.y+(i.y-e.y)*(s-e.x)/(i.x-e.x);break}return this.hsv[0]=n%360/360,this.setHSV(this.hsv)},saturate:function(t){return this.hsv[1]=a.clip(this.hsv[1]+t,0,1),this.setHSV(this.hsv)},saturation:function(){return this.hsv[1]},setAlpha:function(t){return this._alpha=t,this},setARGB:function(t){return this.setRGB((t>>16&255)*p.INV8BIT,(t>>8&255)*p.INV8BIT,(255&t)*p.INV8BIT),this._alpha=(t>>>24)*p.INV8BIT,this},setBlack:function(t){return this.cmyk[3]=t,this.setCMYK(this.cmyk)},setBlue:function(t){return this.rgb[2]=t,this.setRGB(this.rgb)},setBrightness:function(t){return this.hsv[2]=a.clip(t,0,1),this.setHSV(this.hsv)},setCMYK:function(t,e,i,n){return o.Array(t)&&(e=t[1],i=t[2],n=t[3],t=t[0]),this.cmyk[0]=t,this.cmyk[1]=e,this.cmyk[2]=i,this.cmyk[3]=n,this.rgb=p.cmykToRGB(this.cmyk[0],this.cmyk[1],this.cmyk[2],this.cmyk[3]),this.hsv=p.rgbToHSV(this.rgb[0],this.rgb[1],this.rgb[2]),this},setComponent:function(t,e){return t.setComponentValueFor(this,e),this},setCyan:function(t){return this.cmyk[0]=t,this.setCMYK(this.cmyk)},setGreen:function(t){return this.rgb[1]=t,this.setRGB(this.rgb)},setHSV:function(t,e,i){o.Array(t)&&(e=t[1],i=t[2],t=t[0]);var n=[t,e,i];return this.hsv[0]=n[0]%1,this.hsv[0]<0&&this.hsv[0]++,this.hsv[1]=a.clip(n[1],0,1),this.hsv[2]=a.clip(n[2],0,1),this.rgb=p.hsvToRGB(this.hsv[0],this.hsv[1],this.hsv[2]),this.cmyk=p.rgbToCMYK(this.rgb[0],this.rgb[1],this.rgb[2]),this},setHue:function(t){return t%=1,0>t&&t++,this.hsv[0]=t,this.setHSV(this.hsv)},setMagenta:function(t){return this.cmyk[1]=t,this.setCMYK(this.cmyk)},setRed:function(t){return this.rgb[0]=t,this.setRGB(this.rgb)},setRGB:function(t,e,i){return o.Array(t)&&(e=t[1],i=t[2],t=t[0]),this.rgb[0]=a.clip(t,0,1),this.rgb[1]=a.clip(e,0,1),this.rgb[2]=a.clip(i,0,1),this.cmyk=p.rgbToCMYK(this.rgb[0],this.rgb[1],this.rgb[2]),this.hsv=p.rgbToHSV(this.rgb[0],this.rgb[1],this.rgb[2]),this},setSaturation:function(t){return this.hsv[1]=a.clip(t,0,1),this.setHSV(this.hsv)},setYellow:function(t){return this.cmyk[2]=t,this.setCMYK(this.cmyk)},sub:function(t){return this.copy().subSelf(t)},subSelf:function(t){return this.rgb[0]=a.max(this.rgb[0]-t.rgb[0],0),this.rgb[1]=a.max(this.rgb[1]-t.rgb[1],0),this.rgb[2]=a.max(this.rgb[2]-t.rgb[2],0),this.setRGB(this.rgb)},toARGB:function(){var t=parseInt(255*this.rgb[0],10),e=parseInt(255*this.rgb[1],10),i=parseInt(255*this.rgb[2],10),n=parseInt(255*this._alpha,10);return t<<16|e<<8|i|n<<24},toCMYKAArray:function(t){return void 0===t&&(t=[]),t[0]=this.cmyk[0],t[1]=this.cmyk[1],t[2]=this.cmyk[2],t[3]=this.cmyk[3],t[4]=this._alpha,t},toHex:function(){var t=f(this.toARGB());return t.length>6&&(t=t.substring(2)),t},toHexCSS:function(){return"#"+this.toHex()},toHSVAArray:function(t){return void 0===t&&(t=[]),t[0]=this.hsv[0],t[1]=this.hsv[1],t[2]=this.hsv[2],t[3]=this._alpha,t},toHSLCSS:function(){var t=n(this.toHSVAArray());return"hsl("+t[0]+","+t[1]+"%,"+t[2]+"%)"},toHSLACSS:function(){var t=n(this.toHSVAArray());return"hsla("+t[0]+","+t[1]+"%,"+t[2]+"%,"+t[3]+")"},toInt:function(){return Number("0x"+this.toHex())},toRGBAArray:function(t,e){return t=t||[],e=e||0,t[e++]=this.rgb[0],t[e++]=this.rgb[1],t[e++]=this.rgb[2],t[e]=this._alpha,t},toRGBADecimalArray:function(t,e){return t=t||[],e=e||0,t[e++]=255*this.rgb[0],t[e++]=255*this.rgb[1],t[e++]=255*this.rgb[2],t[e]=255*this._alpha,t},toRGBCSS:function(t){var e=r(this.toRGBAArray(),t);return"rgb("+e[0]+","+e[1]+","+e[2]+")"},toRGBACSS:function(t){var e=r(this.toRGBAArray(),t);return"rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]+")"},toString:function(){return"TColor: rgb: "+this.rgb[0]+", "+this.rgb[1]+", "+this.rgb[2]+" hsv: "+this.hsv[0]+","+this.hsv[1]+","+this.hsv[2]+" cmyk: "+this.cmyk[0]+", "+this.cmyk[1]+","+this.cmyk[2]+","+this.cmyk[3]+" alpha: "+this._alpha},yellow:function(){return this.cmyk[2]}},p.INV60DEGREES=60/360,p.INV8BIT=1/255,p.EPS=.001,p.BLACK_POINT=.08,p.WHITE_POINT=1,p.GREY_THRESHOLD=.01,p.cmykToRGB=function(t,e,i,n,r){return void 0===r&&(r=[0,0,0]),r[0]=1-Math.min(1,t+n),r[1]=1-Math.min(1,e+n),r[2]=1-Math.min(1,i+n),r},p.hexToRGB=function(t,e){return void 0===e&&(e=[]),t="#"==t.charAt(0)?t.substring(1,7):t,e[0]=parseInt(t.substring(0,2),16)*p.INV8BIT,e[1]=parseInt(t.substring(2,4),16)*p.INV8BIT,e[2]=parseInt(t.substring(4,6),16)*p.INV8BIT,e},p.hsvToRGB=function(t,e,i,n){if(void 0===n&&(n=[]),0===e)n[0]=n[1]=n[2]=i;else{t/=p.INV60DEGREES;var r=parseInt(t,10),s=t-r,o=i*(1-e),a=i*(1-e*s),h=i*(1-e*(1-s));0===r?(n[0]=i,n[1]=h,n[2]=o):1==r?(n[0]=a,n[1]=i,n[2]=o):2==r?(n[0]=o,n[1]=i,n[2]=h):3==r?(n[0]=o,n[1]=a,n[2]=i):4==r?(n[0]=h,n[1]=o,n[2]=i):(n[0]=i,n[1]=o,n[2]=a)}return n},p.labToRGB=function(t,e,i,n){void 0===n&&(n=[]);var r=(t+16)/116,s=e/500+r,o=r-i/200,a=0;for(n[0]=s,n[1]=r,n[2]=o,a=0;3>a;a++){var h=Math.pow(n[a],3);n[a]=h>.008856?h:(n[a]-16/116)/7.787}s=.95047*n[0],r=n[1],o=1.08883*n[2],n[0]=3.2406*s+-1.5372*r+o*-.4986,n[1]=s*-.9689+1.8758*r+.0415*o,n[2]=.0557*s+r*-.204+1.057*o;var u=1/2.4;for(a=0;3>a;a++)n[a]=n[a]>.0031308?1.055*Math.pow(n[a],u)-.055:12.92*n[a];return n},p.newARGB=function(t){return p.newRGBA((t>>16&255)*p.INV8BIT,(t>>8&255)*p.INV8BIT,(255&t)*p.INV8BIT,(t>>>24)*p.INV8BIT)},p.newCMYK=function(t,e,i,n){return p.newCMYKA(t,e,i,n,1)},p.newCMYKA=function(t,e,i,n,r){var s=new p;return s.setCMYK([t,e,i,n]),s.setAlpha(a.clip(r,0,1)),s},p.newCSS=function(t){function e(e){var i=t.substr(0,t.length-1);return i.substr(e.length+1,i.length).split(",")}function i(t){var e=0,i=t.length;for(e=0;i>e;e++)t[e]=Number(t[e]);return t}for(;t.indexOf(" ")>-1;)t=t.replace(" ","");t=t.toLowerCase();var n={"#":function(){return p.newHex(t.substr(1,t.length))},rgba:function(){var t=i(e("rgba"));return p.newRGBA(t[0]/255,t[1]/255,t[2]/255,t[3])},rgb:function(){var t=i(e("rgb"));return p.newRGBA(t[0]/255,t[1]/255,t[2]/255,1)},hsla:function(t){return t=t||e("hsla"),t[0]=Number(t[0])/360,t[1]=Number(t[1].substr(0,t[1].length-1))/100,t[2]=Number(t[2].substr(0,t[2].length-1))/100,t[3]=Number(t[3]),p.newHSVA(t[0],t[1],t[2],t[3])},hsl:function(){var t=e("hsl");return t.push(1),n.hsla(t)}};if(void 0!==p.X11[t])return p.X11[t].copy();for(var r in n)if(t.indexOf(r)>-1)return n[r]()},p.newGray=function(t){return p.newGrayAlpha(t,1)},p.newGrayAlpha=function(t,e){var i=new p;return i.setRGB([t,t,t]),i.setAlpha(e),i},p.newHex=function(t){var e=new p;return e.setRGB(p.hexToRGB(t)),e.setAlpha(1),e},p.newHSV=function(t,e,i){return p.newHSVA(t,e,i,1)},p.newHSVA=function(t,e,i,n){var r=new p;return r.setHSV(t,e,i),r.setAlpha(a.clip(n,0,1)),r},p.newRandom=function(){return p.newRGBA(Math.random(),Math.random(),Math.random(),1)},p.newRGB=function(t,e,i){return p.newRGBA(t,e,i,1)},p.newRGBA=function(t,e,i,n){var r=new p;return r.setRGB(t,e,i),r.setAlpha(a.clip(n,0,1)),r},p.rgbToCMYK=function(t,e,i,n){return void 0===n&&(n=[]),n[0]=1-t,n[1]=1-e,n[2]=1-i,n[3]=a.min(n[0],n[1],n[2]),n[0]=a.clip(n[0]-n[3],0,1),n[1]=a.clip(n[1]-n[3],0,1),n[2]=a.clip(n[2]-n[3],0,1),n[3]=a.clip(n[3],0,1),n},p.rgbToHex=function(t,e,i){var n=f(255*a.clip(t,0,1))+f(255*a.clip(e,0,1))+f(255*a.clip(i,0,1));return n},p.rgbToHSV=function(t,e,i,n){void 0===n&&(n=[]);var r=0,o=0,h=a.max(t,e,i),u=h-a.min(t,e,i);return 0!==h&&(o=u/h),0!==o&&(r=0===s(t,h)?(e-i)/u:0===s(e,h)?2+(i-t)/u:4+(t-e)/u),r*=p.INV60DEGREES,0>r&&(r+=1),n[0]=r,n[1]=o,n[2]=h,n},p.RED=p.newRGB(1,0,0),p.RYB_WHEEL=[new u(0,0),new u(15,8),new u(30,17),new u(45,26),new u(60,34),new u(75,41),new u(90,48),new u(105,54),new u(120,60),new u(135,81),new u(150,103),new u(165,123),new u(180,138),new u(195,155),new u(210,171),new u(225,187),new u(240,204),new u(255,219),new u(270,234),new u(285,251),new u(300,267),new u(315,282),new u(330,298),new u(345,329),new u(360,0)],p.GREEN=p.newRGB(0,1,0),p.BLUE=p.newRGB(0,0,1),p.CYAN=p.newRGB(0,1,1),p.MAGENTA=p.newRGB(1,0,1),p.YELLOW=p.newRGB(1,1,0),p.BLACK=p.newRGB(0,0,0),p.WHITE=p.newRGB(1,1,1),p.X11={},function(){var t,e,i={indianred:[205,92,92],lightcoral:[240,128,128],salmon:[250,128,114],darksalmon:[233,150,122],lightsalmon:[255,160,122],red:[255,0,0],crimson:[220,20,60],fireBrick:[178,34,34],darkred:[139,0,0],pink:[255,192,203],lightpink:[255,182,193],hotpink:[255,105,180],deeppink:[255,20,147],mediumvioletred:[199,21,133],palevioletred:[219,112,147],coral:[255,127,80],tomato:[255,99,71],orangered:[255,69,0],darkorange:[255,140,0],orange:[255,165,0],gold:[255,215,0],yellow:[255,255,0],lightyellow:[255,255,224],lemonchiffon:[255,250,205],lightgoldenrodyellow:[250,250,210],papayawhip:[255,239,213],moccasin:[255,228,181],peachpuff:[255,218,185],palegoldenrod:[238,232,170],khaki:[240,230,140],darkkhaki:[189,183,107],lavender:[230,230,250],thistle:[216,191,216],plum:[221,160,221],violet:[238,130,238],orchid:[218,112,214],fuchsia:[255,0,255],Magenta:[255,0,255],mediumorchid:[186,85,211],mediumpurple:[147,112,219],blueviolet:[138,43,226],darkviolet:[148,0,211],darkorchid:[153,50,204],darkmagenta:[139,0,139],purple:[128,0,128],indigo:[75,0,130],darkslateblue:[72,61,139],slateblue:[106,90,205],mediumslateblue:[123,104,238],greenyellow:[173,255,47],chartreuse:[127,255,0],lawngreen:[124,252,0],lime:[0,255,0],limegreen:[50,205,50],palegreen:[152,251,152],lightgreen:[144,238,144],mediumspringgreen:[0,250,154],springgreen:[0,255,127],mediumseagreen:[60,179,113],seagreen:[46,139,87],forestgreen:[34,139,34],green:[0,128,0],darkgreen:[0,100,0],yellowgreen:[154,205,50],olivedrab:[107,142,35],olive:[128,128,0],darkolivegreen:[85,107,47],mediumaquamarine:[102,205,170],darkseagreen:[143,188,143],lightseagreen:[32,178,170],darkcyan:[0,139,139],teal:[0,128,128],aqua:[0,255,255],cyan:[0,255,255],lightcyan:[224,255,255],paleturquoise:[175,238,238],aquamarine:[127,255,212],turquoise:[64,224,208],mediumturquoise:[72,209,204],darkturquoise:[0,206,209],cadetblue:[95,158,160],steelblue:[70,130,180],lightsteelblue:[176,196,222],powderblue:[176,224,230],lightblue:[173,216,230],skyblue:[135,206,235],lightskyblue:[135,206,250],deepskyblue:[0,191,255],dodgerblue:[30,144,255],cornflowerblue:[100,149,237],royalblue:[65,105,225],blue:[0,0,255],mediumblue:[0,0,205],darkblue:[0,0,139],navy:[0,0,128],midnightblue:[25,25,112],cornsilk:[255,248,220],blanchedalmond:[255,235,205],bisque:[255,228,196],navajowhite:[255,222,173],wheat:[245,222,179],burlywood:[222,184,135],tan:[210,180,140],rosybrown:[188,143,143],sandybrown:[244,164,96],goldenrod:[218,165,32],darkgoldenrod:[184,134,11],Peru:[205,133,63],chocolate:[210,105,30],saddlebrown:[139,69,19],sienna:[160,82,45],brown:[165,42,42],maroon:[128,0,0],white:[255,255,255],snow:[255,250,250],honeydew:[240,255,240],mintcream:[245,255,250],azure:[240,255,255],aliceblue:[240,248,255],ghostwhite:[248,248,255],whitesmoke:[245,245,245],seashell:[255,245,238],beige:[245,245,220],oldlace:[253,245,230],floralwhite:[255,250,240],ivory:[255,255,240],antiquewhite:[250,235,215],linen:[250,240,230],lavenderblush:[255,240,245],mistyrose:[255,228,225],gainsboro:[220,220,220],lightgray:[211,211,211],silver:[192,192,192],darkgray:[169,169,169],gray:[128,128,128],dimgray:[105,105,105],lightslategray:[119,136,153],slategray:[112,128,144],darkslategray:[47,79,79],black:[0,0,0],bark:[64,48,33]};for(t in i)i.hasOwnProperty(t)&&(e=i[t],p.X11[t]=p.newRGB(e[0]/255,e[1]/255,e[2]/255),t.indexOf("gray")>=0&&(p.X11[t.replace("gray","grey")]=p.X11[t]));p.X11.transparent=p.newRGBA(0,0,0,0)}(),i.exports=p}),i("toxi/color/HSVDistanceProxy",["require","./distanceProxies"],function(t){return t("./distanceProxies").HSVDistanceProxy}),i("toxi/color/RGBDistanceProxy",["require","./distanceProxies"],function(t){return t("./distanceProxies").RGBDistanceProxy}),i("toxi/color/ProximityComparator",["require"],function(){var t=function(t,e){this.col=t,this.proxy=e};return t.prototype.compare=function(t,e){var i=this.proxy.distanceBetween(this.col,t),n=this.proxy.distanceBetween(this.col,e);return n>i?-1:i>n?1:0},t}),i("toxi/color/ColorList",["require","exports","module","../internals/is","../internals/each","../internals/Iterator","../math/mathUtils","./TColor","./HSVDistanceProxy","./RGBDistanceProxy","./ProximityComparator","./accessCriteria"],function(t,e,i){var n=t("../internals/is"),r=t("../internals/each"),s=t("../internals/Iterator"),o=t("../math/mathUtils"),a=t("./TColor"),h=t("./HSVDistanceProxy"),u=t("./RGBDistanceProxy"),c=t("./ProximityComparator"),f=t("./accessCriteria"),p=function(t){if(arguments.length>1)return p.call(this,arguments);this.colors=[];var e=0;if(n.Array(t)&&t.length)if("number"==typeof t[0])for(e=0,l=t.length;l>e;e++)this.colors.push(a.newARGB(t[e]));else this.addAll(t);else if(n.ColorList(t))for(e=0,l=t.size();l>e;e++)this.add(t.get(e));else n.TColor(t)&&this.add(t)};p.prototype={constructor:p,add:function(t){return this.colors.push(t.copy()),this},addAll:function(t){var e=this;return n.Array(t)?r(t,function(t){e.colors.push(t)}):this.colors.push(t),this},adjustBrightness:function(t){return r(this.colors,function(e){e.lighten(t)}),this},adjustSaturation:function(t){return r(this.colors,function(e){e.saturate(t)}),this},clusterSort:function(t,e,i,n){var r,s=this.colors.slice(0),o=[],a=1,h=0,u=s.length;s.sort(t.compare).reverse();for(var c=0;u>c;c++){var l=s[c];l.getComponentValue(t)<a&&(r=s.slice(h,c),r.sort(e.compare),o.push.apply(o,r),a-=1/i,h=c)}return r=[],Array.prototype.push.apply(r,s.slice(h,s.length)),r.sort(e.compare),o.push.apply(o,r),n&&o.reverse(),this.colors=o,this},complement:function(){return this.each(function(t){t.complement()}),this},contains:function(t){for(var e=0,i=this.colors.length;i>e;e++)if(this.colors[e].equals(t))return!0;return!1},each:function(t){return r(this.colors,t),this},get:function(t){return 0>t&&(t+=this.colors.length),this.colors[t]},getAverage:function(){var t=0,e=0,i=0,n=0;this.each(function(r){t+=r.rgb[0],e+=r.rgb[1],i+=r.rgb[2],n+=r.alpha()});var r=this.colors.length;return r>0?a.newRGBA(t/r,e/r,i/r,n/r):void 0},getBlended:function(t){for(var e=[],i=this.colors.length,n=0;i>n;n++){var r=n>0?n-1:e.length-1,s=this.colors[r];e.push(this.colors[n].getBlended(s,t))}return new p(e)},getDarkest:function(){var t,e=Number.MAX_VALUE;return this.each(function(i){var n=i.luminance();e>n&&(t=i,e=n)}),t},getLightest:function(){var t,e=Number.MIN_VALUE;return this.each(function(i){var n=i.luminance();n>e&&(t=i,e=n)}),t},getRandom:function(){var t=Math.floor(o.random(this.colors.length));return this.colors[t]},getReverse:function(){return new p(this.colors).reverse()},invert:function(){return this.each(function(t){t.invert()}),this},iterator:function(){return new s(this.colors)},reverse:function(){return this.colors.reverse(),this},rotateRYB:function(t,e){var i;return i=t!==Math.floor(t)||e?o.degrees(t):t,this.each(function(t){t.rotateRYB(i)}),this},size:function(){return this.colors.length},sort:function(){return this.sortByCriteria(f.HUE,!1)},sortByComparator:function(t,e){return"function"==typeof t&&"undefined"==typeof t.compare&&(t={compare:t}),this.colors.sort(t.compare),e&&this.colors.reverse(),this},sortByCriteria:function(t,e){return this.sortByComparator(t,e)},sortByDistance:function(t,e){if(1===arguments.length&&(e=arguments[0],t=new h),0===this.colors.length)return this;var i=this.getDarkest(),n=this.colors.slice(0),r=[];n.splice(n.indexOf(i),1),r.push(i);for(var s=0;n.length>1;){for(var o=n[0],a=r[s],u=t.distanceBetween(o,a),c=n.length-1;c>=0;c--){var l=n[c],f=t.distanceBetween(l,a);u>f&&(o=l,u=f)}n.splice(n.indexOf(o),1),r.push(o),s++}return r.push(n[0]),e&&r.reverse(),this.colors=r,this},sortByProximityTo:function(t,e,i){return 2==arguments.length&&(t=arguments[0],e=new u,i=arguments[1]),this.sortByComparator(new c(t,e),i)},toARGBArray:function(){var t=[];return this.each(function(e){t.push(e.toARGB())}),t}},p.createFromARGBArray=function(t,e,i,n){if(n=n||100,e=o.min(e,t.length),!i&&e==t.length)return new p(t);var r,s=[],h=a.BLACK.copy(),u=0,c=!0,l=0;for(u=0;e>u;u++)if(i){c=!0,l=0;do r=o.random(t.length),h.setARGB(t[r]),c=!(s.indexOf(h)>=0);while(!c&&++l<n);if(!(n>l))break;s.push(h.copy())}else r=o.random(t.length),s.push(a.newARGB(t[r]));return new p(s)},p.createUsingStrategy=function(){throw new Error("Not allowed, use toxi/color/createListUsingStrategy instead")},i.exports=p}),i("toxi/color/ColorGradient",["require","exports","module","../internals","../internals","../math/mathUtils","../math/LinearInterpolation","./ColorList"],function(t,e,i){var n=t("../internals").filter,r=t("../internals").numberComparator,s=t("../math/mathUtils"),o=t("../math/LinearInterpolation"),a=t("./ColorList"),h=function(t,e){this.pos=t,this.color=e};h.prototype={compareTo:function(t){return 0===r(t.pos,this.pos)?0:this.pos<t.pos?-1:1},getColor:function(){return this.color},getPosition:function(){return this.pos}};var u=function(){this.gradient=[],this.interpolator=new o,this.maxDither=0};u.prototype={addColorAt:function(t,e){this.gradient.push(new h(t,e))},calcGradient:function(t,e){if(0===arguments.length){t=this.gradient[0].getPosition();var i=this.gradient[this.gradient.length-1].getPosition();e=Math.floor(i-t)}var r=new a;if(0===this.gradient.length)return r;var o,h,u=0,c=t+e,l=0,f=this.gradient.length;for(l=0;f>l;l++)this.gradient[l].pos<t&&(o=this.gradient[l]);var p,d=void 0===o;d?(p=this.gradient,o=this.gradient[0]):p=n(this.gradient,function(t){return t.pos>=o.pos});var g=0;if(l=0,f=p.length,o!==p[f-1])if(h=p[l],d){var m=o.pos-t;g=s.abs(m)>0?1/m:1}else h.pos-o.pos>0&&(g=1/(h.pos-o.pos));for(;c>t;){if(u=d?1-(o.pos-t)*g:(t-o.pos)*g,u>1&&(o=h,d=!1,l++,l<p.length&&(h=p[l],g=o!==p[f-1]?1/(h.pos-o.pos):0,u=(t-o.pos)*g)),o!==p[f-1]){var y=s.clip(u+s.normalizedRandom()*this.maxDither,0,1);y=this.interpolator.interpolate(0,1,y),r.add(o.color.getBlended(h.color,y))}else r.add(o.color.copy());t++}return r},getGradientPoints:function(){return this.gradient},getInterpolator:function(){return this.interpolator},getMaxDither:function(){return this.maxDither},setInterpolator:function(t){this.interpolator=t},setMaxDither:function(t){this.maxDither=s.clip(t,0,1)}},i.exports=u}),i("toxi/util/datatypes/FloatRange",["require","exports","module","../../math/mathUtils"],function(t,e,i){var n=t("../../math/mathUtils"),r=function(t,e){if(t=t||0,e="number"==typeof e?e:1,t>e){var i=e;e=t,t=i}this.min=t,this.max=e,this.currValue=t};r.prototype={adjustCurrentBy:function(t){return this.setCurrent(this.currValue+t)},copy:function(){var t=new r(this.min,this.max);return t.currValue=this.currValue,t},getAt:function(t){return this.min+(this.max-this.min-n.EPS)*t},getCurrent:function(){return this.currValue},getMedian:function(){return.5*(this.min+this.max)},getRange:function(){return this.max-this.min},isValueInRange:function(t){return t>=this.min&&t<=this.max},pickRandom:function(){return this.currValue=n.random(this.min,this.max),this.currValue},setCurrent:function(t){return this.currValue=n.clip(t,this.min,this.max),this.currValue},toArray:function(t){for(var e=[],i=this.min;i<this.max;)e.push(i),i+=t;return e},toString:function(){return"FloatRange: "+this.min+" -> "+this.max}},i.exports=r}),i("toxi/color/ColorRange",["./TColor","./ColorList","../util/datatypes/FloatRange","../internals/is","../internals/each","../math/mathUtils"],function(t,e,i,n,r,s){var o,a,h,u,c=1;return h=function(t,e){t.push.apply(t,e)},a=function(t){return function(e,r){return this[t.toLowerCase()+"Constraint"].push(n.FloatRange(e)?e:new i(e,r)),this}},u=function(t){return t[Math.floor(Math.random()*t.length)]},o=function(t,e,r,s,o,a){var h,u=this;if(0===arguments.length)return this;n.ColorList(t)&&(h=t,t=h.get(0)),n.Hue(t)&&(t=new i(t.getHue(),t.getHue())),n.TColor(t)&&(t=new i(t.hue(),t.hue())),this.hueConstraint=[n.FloatRange(t)?t:new i(0,1)],this.saturationConstraint=[n.FloatRange(e)?e:new i(0,1)],this.brightnessConstraint=[n.FloatRange(r)?r:new i(0,1)],this.alphaConstraint=[n.FloatRange(s)?s:new i(1,1)],this.black=n.FloatRange(o)?o:new i(0,1),this.white=n.FloatRange(a)?a:new i(0,1),h&&(this.hueConstraint=[],h.each(function(t){u.add(t)}));for(var l=arguments.length-1;l>=0;l--)if("string"==typeof arguments[l]){this.name=arguments[l];break}this.name||(this.name="untitled"+c++)},o.prototype={constructor:o,add:function(t){return n.ColorRange(t)?(h(this.hueConstraint,t.hueConstraint),h(this.saturationConstraint,t.saturationConstraint),h(this.brightnessConstraint,t.brightnessConstraint),h(this.alphaConstraint,t.alphaConstraint),this.black.min=Math.min(this.black.min,t.black.min),this.black.max=Math.max(this.black.max,t.black.max),this.white.min=Math.min(this.white.min,t.white.min),this.white.max=Math.max(this.white.max,t.white.max)):(this.hueConstraint.push(new i(t.hue(),t.hue())),this.saturationConstraint.push(new i(t.saturation(),t.saturation())),this.brightnessConstraint.push(new i(t.brightness(),t.brightness())),this.alphaConstraint.push(new i(t.alpha(),t.alpha()))),this},addAlphaRange:a("alpha"),addBrightnessRange:a("brightness"),addHue:function(t){return this.hueConstraint.push(new i(t.getHue(),t.getHue())),this},addHueRange:a("hue"),addSaturationRange:a("saturation"),contains:function(t){var e=this.isValueInConstraint(t.hue(),this.hueConstraint);return e&=this.isValueInConstraint(t.saturation(),this.saturationConstraint),e&=this.isValueInConstraint(t.brightness(),this.brightnessConstraint),e&=this.isValueInConstraint(t.alpha(),this.alphaConstraint),e||!1},copy:function(t,e){e="number"==typeof e?e:0;var n=new o;if(n.name=this.name,t){var r=t.hue()+e*s.normalizedRandom();n.hueConstraint=[new i(r,r)],n.alphaConstraint=[new i(t.alpha(),t.alpha())]}else n.hueConstraint=[].concat(this.hueConstraint),n.alphaConstraint=[].concat(this.alphaConstraint);return n.saturationConstraint=[].concat(this.saturationConstraint),n.brightnessConstraint=[].concat(this.brightnessConstraint),n.black=this.black.copy(),n.white=this.white.copy(),n},getColor:function(e,i){if(n.Hue(e))return t.newHSVA(e.getHue(),u(this.saturationConstraint).pickRandom(),u(this.brightnessConstraint).pickRandom(),u(this.alphaConstraint).pickRandom());var r,o,a,h,c=e;if(c){if(c.isBlack())return t.newHSVA(c.hue(),0,this.black.pickRandom(),c.alpha());if(c.isWhite())return t.newHSVA(c.hue(),0,this.white.pickRandom(),c.alpha());if(c.isGrey())return t.newHSVA(c.hue(),0,s.flipCoin()?this.black.pickRandom():this.white.pickRandom(),c.alpha());r=c.hue()+i*s.normalizedRandom(),h=c.alpha()}else r=u(this.hueConstraint).pickRandom(),h=u(this.alphaConstraint).pickRandom();return o=u(this.saturationConstraint).pickRandom(),a=u(this.brightnessConstraint).pickRandom(),t.newHSVA(r,o,a,h)},getColors:function(t,i,n){arguments.length<3&&(n=o.DEFAULT_VARIANCE),1===arguments.length&&(i=t,t=void 0);for(var r=new e,s=0;i>s;s++)r.add(this.getColor(t,n));return r},getGrayscale:function(e,i){return this.getColor(t.newGray(e),i)},getName:function(){return this.name},getSum:function(t){return this.copy().add(t)},isValueInConstraint:function(t,e){var i=!1;return r(e,function(e){i|=e.isValueInRange(t)}),i}},o.DEFAULT_VARIANCE=.035,function(t,e){o.PRESETS={},r({light:[e,new t(.3,.7),new t(.9,1),e,new t(.15,.3),e],dark:[e,new t(.7,1),new t(.15,.4),e,e,new t(.5,.75)],bright:[e,new t(.8,1),new t(.8,1)],weak:[e,new t(.15,.3),new t(.7,1),e,new t(.2,.2),e],neutral:[e,new t(.25,.35),new t(.3,.7),e,new t(.15,.15),new t(.9,1)],fresh:[e,new t(.4,.8),new t(.8,1),e,new t(.05,.3),new t(.8,1)],soft:[e,new t(.2,.3),new t(.6,.9),e,new t(.05,.15),new t(.6,.9)],hard:[e,new t(.9,1),new t(.4,1)],warm:[e,new t(.6,.9),new t(.4,.9),e,new t(.2,.2),new t(.8,1)],cool:[e,new t(.05,.2),new t(.9,1),e,e,new t(.95,1)],intense:[e,new t(.9,1),new t(.2,.35)]},function(t,e){t.push(e);var i=e.toUpperCase();o[i]=new o,o.apply(o[i],t),o.PRESETS[i]=o[i]}),o.INTENSE.addBrightnessRange(new t(.8,1))}(i,void 0),o.getPresetForName=function(t){return o.PRESETS[t.toUpperCase()]},o}),i("toxi/color/namedColor",["./TColor","../internals","exports"],function(t,e,i){var n=e.each,r=[],s={};n(t.X11,function(t,e){var n=e.toUpperCase();r.push(n),s[n]=t,s[e]=t,i[n]=t}),i.getForName=function(t){return s[t]||s[t.toLowerCase()]},i.getNames=function(){return r.slice(0)}}),i("toxi/color/ColorTheme",["../internals/each","../math/mathUtils","./ColorRange","./namedColor","./ColorList"],function(t,e,i,n,r){var s,o;return o=function(t,e,i){this.range=t,this.color=e,this.weight=i},o.prototype.getColor=function(){return this.range.getColor(this.color,i.DEFAULT_VARIANCE)},s=function(t){this.name=t,this.parts=[],this._weightedSum=0},s.prototype={constructor:s,addRange:function(e,r,s){var a,h,u=this;return 3===arguments.length?(this.parts.push(new o(e,r,s)),this._weightedSum+=s):(t(e.split(" "),function(t){i.getPresetForName(t)?a=i.getPresetForName(t):n.getForName(t)&&(h=n.getForName(t))}),a&&u.addRange(a,h,r)),this},getColor:function(){for(var t,e,i=Math.random(),n=0,r=this.parts.length;r>n;n++){if(t=this.parts[n],e=t.weight/this._weightedSum,e>=i)return t.getColor();i-=e}return null},getColors:function(t){for(var e=new r,i=0;t>i;i++)e.add(this.getColor());return e},getName:function(){return this.name}},s}),i("toxi/color/theory/strategies",["../../internals/has","../../internals/is","exports"],function(t,e,i){var t=t.all,n=e.TColor;i.create=function(t,e,i){2===arguments.length&&(i=e,e=function(){});var r=t.charAt(0).toLowerCase()+t.slice(1,t.length);e.prototype.constructor=e,e.prototype.getName=function(){return r},e.prototype.toString=e.prototype.getName;for(var s in i)e.prototype[s]=i[s];return function(t){e.prototype.createListFromColor=function(e){if(!n(e))throw new Error("src color was not a valid TColor");return t.call(this,e)}}(e.prototype.createListFromColor),e},i.wrap=function(t,e,i,n){return i>t-e?t+n:t-e}}),i("toxi/color/theory/SingleComplementStrategy",["./strategies","../ColorList"],function(t,e){var i=function(){return"complement"};return t.create("SingleComplement",{createListFromColor:function(t){var i=new e(t);return i.add(t.getComplement()),i},getName:i,toString:i})}),i("toxi/color/theory/ComplementaryStrategy",["./strategies","../ColorList"],function(t,e){var i=function(t,e){var i=t.brightness();return t.setBrightness(i>e?.1+.25*i:1-.25*i),t};return t.create("Complementary",{createListFromColor:function(t){var n,r=new e(t);return r.add(i(t.copy(),.4)),n=t.copy(),n.lighten(.3),n.setSaturation(.1+.3*n.saturation()),r.add(n),r.add(i(t.getComplement(),.3)),r.add(t.getComplement()),n=t.getComplement(),n.lighten(.3),n.setSaturation(.1+.25*n.saturation()),r.add(n),r}})}),i("toxi/color/theory/SplitComplementaryStrategy",["./strategies","../ColorList"],function(t,e){return t.create("SplitComplementary",{createListFromColor:function(t){var i=new e(t);return i.add(t.getRotatedRYB(150).lighten(.1)),i.add(t.getRotatedRYB(210).lighten(.1)),i}})}),i("toxi/color/theory/LeftSplitComplementaryStrategy",["./strategies","../ColorList","./ComplementaryStrategy"],function(t,e,i){var n;return t.create("LeftSplitComplementary",{createListFromColor:function(t){n=n||new i;for(var e,r=t.getComplement().rotateRYB(-30).lighten(.1),s=n.createListFromColor(t),o=3;6>o;o++)e=s.get(o),e.setHue(r.hue());return s}})}),i("toxi/color/theory/RightSplitComplementaryStrategy",["./strategies","../ColorList","./ComplementaryStrategy"],function(t,e,i){var n;return t.create("RightSplitComplementary",{createListFromColor:function(t){n=n||new i;for(var e,r=t.getComplement().rotateRYB(30).lighten(.1),s=n.createListFromColor(t),o=3;6>o;o++)e=s.get(o),e.setHue(r.hue());return s}})}),i("toxi/color/theory/AnalagousStrategy",["./strategies","../../geom/vectors","../../math/mathUtils","../../internals","../ColorList"],function(t,e,i,n,r){var s=n.each,o=e.Vec2D,a=[new o(1,2.2),new o(2,1),new o(-1,-.5),new o(-2,1)];return t.create("Analagous",function(t,e){this.contrast="number"==typeof e?e:.25,this.theta=i.radians("number"==typeof t?t:10)},{createListFromColor:function(t){var e=this;this.contrast=i.clipNormalized(this.contrast);var n=new r(t);return s(a,function(i){var r=t.getRotatedRYB(e.theta*i.x),s=.44-.1*i.y;r.setBrightness(t.brightness()-e.contras*i.y<s?s:t.brightness()-e.contrast*i.y),r.desaturate(.05),n.add(r)}),n},toString:function(){return"analagous contrast: "+this.contrast+" theta: "+i.degrees(this.theta)}})}),i("toxi/color/theory/MonochromeTheoryStrategy",["./strategies","../ColorList"],function(t,e){var i=t.wrap;return t.create("Monochrome",{createListFromColor:function(t){var n=new e(t),r=t.copy();
return r.setBrightness(i(r.brightness(),.5,.2,.3)),r.setSaturation(i(r.saturation(),.3,.1,.3)),n.add(r),r=t.copy(),r.setBrightness(i(r.brightness(),.2,.2,.6)),n.add(r),r=t.copy(),r.setBrightness(Math.max(.2,r.brightness()+.2*(1-r.brightness()))),r.setSaturation(i(r.saturation(),.3,.1,.3)),n.add(r),r=t.copy(),r.setBrightness(i(r.brightness(),.5,.2,.3)),n.add(r),n}})}),i("toxi/color/theory/TriadTheoryStrategy",["./strategies","../ColorList"],function(t,e){var i=function(){return"triad"};return t.create("TriadTheory",{createListFromColor:function(t){var i=new e(t);return i.add(t.getRotatedRYB(120).lighten(.1)),i.add(t.getRotatedRYB(-120).lighten(.1)),i},getName:i,toString:toString})}),i("toxi/color/theory/TetradTheoryStrategy",["./strategies","../ColorList"],function(t,e){var i=function(){return"tetrad"},n=function(t){return t[t.brightness()<.5?"lighten":"darken"](.2)};return t.create("TetradTheory",function(t){this.theta="number"==typeof t?t:90},{createListFromColor:function(t){var i=new e(t);return i.add(n(t.getRotatedRYB(this.theta))),i.add(n(t.getRotatedRYB(2*this.theta))),i.add(t.getRotatedRYB(3*this.theta).lighten(.1)),i},getName:i,toString:i})}),i("toxi/color/theory/CompoundTheoryStrategy",["./strategies","../ColorList"],function(t,e){var i=t.wrap;return t.create("Compound",function(t){this._isFlipped=t===!0},{createListFromColor:function(t){var n,r=new e(t),s=this._isFlipped?-1:1;return n=t.getRotatedRYB(30*s),n.setBrightness(i(n.brightness(),.25,.6,.25)),r.add(n),n=t.getRotatedRYB(30*s),n.setSaturation(i(n.saturation(),.4,.1,.4)),n.setBrightness(i(n.brightness(),.4,.2,.4)),r.add(n),n=t.getRotatedRYB(160*s),n.setSaturation(i(n.saturation(),.25,.1,.25)),n.setBrightness(Math.max(.2,n.brightness())),r.add(n),n=t.getRotatedRYB(150*s),n.setSaturation(i(n.saturation(),.1,.8,.1)),n.setBrightness(i(n.brightness(),.3,.6,.3)),r.add(n),r},isFlipped:function(){return this._isFlipped},setFlipped:function(t){this._isFlipped=t},toString:function(){return"Compound"+(this.isFlipped()?"_flipped":"")}})}),i("toxi/color/theory/colorTheoryRegistry",["require","exports","module","../../internals","./SingleComplementStrategy","./ComplementaryStrategy","./SplitComplementaryStrategy","./LeftSplitComplementaryStrategy","./RightSplitComplementaryStrategy","./AnalagousStrategy","./MonochromeTheoryStrategy","./TriadTheoryStrategy","./TetradTheoryStrategy","./CompoundTheoryStrategy"],function(t,e){var i=t("../../internals"),n=i.each,r=i.keys,s=i.values,o={},a={SINGLE_COMPLEMENT:t("./SingleComplementStrategy"),COMPLEMENTARY:t("./ComplementaryStrategy"),SPLIT_COMPLEMENTARY:t("./SplitComplementaryStrategy"),LEFT_SPLIT_COMPLEMENTARY:t("./LeftSplitComplementaryStrategy"),RIGHT_SPLIT_COMPLEMENTARY:t("./RightSplitComplementaryStrategy"),ANALAGOUS:t("./AnalagousStrategy"),MONOCHROME:t("./MonochromeTheoryStrategy"),TRIAD:t("./TriadTheoryStrategy"),TETRAD:t("./TetradTheoryStrategy"),COMPOUND:t("./CompoundTheoryStrategy")};e.getRegisteredNames=function(){return r(o)},e.getRegisteredStrategies=function(){return s(o)},e.getStrategyForName=function(t){return o[t]},e.registerImplementation=function(t){o[t.getName()]=t},n(a,function(t,i){e[i]=new a[i],e.registerImplementation(e[i])})}),i("toxi/color/createListUsingStrategy",["./theory/colorTheoryRegistry"],function(t){return function(e,i){"string"==typeof e&&(e=t.getStrategyForName(e));var n;return void 0!==e&&(n=e.createListFromColor(i)),n}}),i("toxi/color/HistEntry",["require"],function(){var t=function(t){this.col=t,this.freq=1};return t.prototype={constructor:t,compareTo:function(t){return parseInt(t.freq-this.freq,10)},getColor:function(){return this.col},getFrequency:function(){return this.freq}},t}),i("toxi/color/Histogram",["require","../internals","../internals","./HistEntry","./ColorList"],function(t){var e=t("../internals").each,i=t("../internals").Iterator,n=t("./HistEntry"),r=t("./ColorList"),s=function(t){this.palette=t};return s.prototype={constructor:s,compute:function(t,i){var r=this;this.entries=[];var s=1;return this.palette.each(function(e){var o,a,h=0,u=r.entries.length;for(h=0;u>h;h++)if(a=r.entries[h],a.col.distanceToRGB(e)<t){i&&a.col.blend(e,1/(a.freq+1)),o=a;break}void 0!==o?(o.freq++,o.freq>s&&(s=o.freq)):r.entries.push(new n(e))}),this.entries.sort(),s=1/this.palette.size(),e(this.entries,function(t){t.freq*=s}),this.entries},getEntries:function(){return this.entries},getPalette:function(){return this.palette},iterator:function(){return new i(this.entries)},setPalette:function(t){this.palette=t}},s.newFromARGBArray=function(t,e,i,n){var o=new s(r.createFromARGBArray(t,e,!1));return o.compute(i,n),o},s}),i("toxi/color/theory",["require","exports","module","./theory/AnalagousStrategy","./theory/colorTheoryRegistry","./theory/ComplementaryStrategy","./theory/CompoundTheoryStrategy","./theory/LeftSplitComplementaryStrategy","./theory/MonochromeTheoryStrategy","./theory/RightSplitComplementaryStrategy","./theory/SingleComplementStrategy","./theory/SplitComplementaryStrategy","./theory/TetradTheoryStrategy","./theory/TriadTheoryStrategy","./theory/strategies"],function(t,e){e.AnalagousStrategy=t("./theory/AnalagousStrategy"),e.colorTheoryRegistry=t("./theory/colorTheoryRegistry"),e.ColorTheoryRegistry=e.colorTheoryRegistry,e.ComplementartyStrategy=t("./theory/ComplementaryStrategy"),e.CompoundTheoryStrategy=t("./theory/CompoundTheoryStrategy"),e.LeftSplitComplementaryStrategy=t("./theory/LeftSplitComplementaryStrategy"),e.MonochromeTheoryStrategy=t("./theory/MonochromeTheoryStrategy"),e.RightSplitComplementaryStrategy=t("./theory/RightSplitComplementaryStrategy"),e.SingleComplementStrategy=t("./theory/SingleComplementStrategy"),e.SplitComplementaryStrategy=t("./theory/SplitComplementaryStrategy"),e.TetradTheoryStrategy=t("./theory/TetradTheoryStrategy"),e.TriadTheoryStrategy=t("./theory/TriadTheoryStrategy"),e.strategies=t("./theory/strategies")}),i("toxi/math/ScaleMap",["require","exports","module","./mathUtils","./LinearInterpolation"],function(t,e,i){var n=t("./mathUtils"),r=t("./LinearInterpolation"),s=function(t,e){this.min=t,this.max=e};s.prototype.toString=function(){return"{ min: "+this.min+", max: "+this.max+"}"};var o=function(t,e,i,n){if(1==arguments.length&&void 0!==arguments[0].input&&void 0!==arguments[0].output){var s=arguments[0];i=s.output.min,n=s.output.max,e=s.input.max,t=s.input.min}this.mapFunction=new r,this.setInputRange(t,e),this.setOutputRange(i,n)};o.prototype={getClippedValueFor:function(t){var e=n.clipNormalized((t-this._in.min)/this._interval);return this.mapFunction.interpolate(0,this.mapRange,e)+this._out.min},getInputMedian:function(){return.5*(this._in.min+this._in.max)},getInputRange:function(){return this._in},getMappedMedian:function(){return this.getMappedValueFor(.5)},getMappedValueFor:function(t){var e=(t-this._in.min)/this._interval;return this.mapFunction.interpolate(0,this.mapRange,e)+this._out.min},getOutputMedian:function(){return.5*(this._out.min+this._out.max)},getOutputRange:function(){return this._out},setInputRange:function(t,e){this._in=new s(t,e),this._interval=e-t},setMapFunction:function(t){this.mapFunction=t},setOutputRange:function(t,e){this._out=new s(t,e),this.mapRange=e-t},toString:function(){return"ScaleMap, inputRange: "+this._in.toString()+" outputRange: "+this._out.toString()}},i.exports=o}),i("toxi/color/ToneMap",["toxi/internals/is","toxi/math/ScaleMap","./ColorList","./ColorGradient"],function(t,e,i,n){var r;return r=function(r,s,o,a,h){var u=arguments.length;if(u>3)if(4===u)o=new i(o,a);else{var c=o;o=new n,o.addColorAt(0,c),o.addColorAt(h-1,a),o=o.calcGradient(0,h)}t.ColorGradient(o)&&(o=o.calcGradient()),this.map=new e(r,s,0,o.size()-1),this.colors=o},r.prototype={constructor:r,getARGBToneFor:function(t){return this.getToneFor(t).toARGB()},getToneFor:function(t){var e;return e=this.colors.size()>2?Math.floor(this.map.getClippedValueFor(t)+.5):t>=this.map.getInputMedian()?1:0,this.colors.get(e)},getToneMappedArray:function(t,e,i){if("number"!=typeof i)i=0;else if(0>i)throw new Error("offset into target pixel array is negative");e=e||new Array(t.length);for(var n=0,r=t.length;r>n;n++)e[i++]=this.getToneFor(t[n]).toARGB();return e},setMapFunction:function(t){this.map.setMapFunction(t)}},r}),i("toxi/color",["require","exports","module","./color/accessCriteria","./color/AlphaAccessor","./color/CMYKAccessor","./color/CMYKDistanceProxy","./color/ColorGradient","./color/ColorList","./color/ColorRange","./color/ColorTheme","./color/createListUsingStrategy","./color/HistEntry","./color/Histogram","./color/HSVAccessor","./color/HSVDistanceProxy","./color/Hue","./color/LuminanceAccessor","./color/namedColor","./color/ProximityComparator","./color/RGBAccessor","./color/RGBDistanceProxy","./color/TColor","./color/theory","./color/ToneMap"],function(t,e){e.accessCriteria=t("./color/accessCriteria"),e.AccessCriteria=e.accessCriteria,e.AlphaAccessor=t("./color/AlphaAccessor"),e.CMYKAccessor=t("./color/CMYKAccessor"),e.CMYKDDistanceProxy=t("./color/CMYKDistanceProxy"),e.ColorGradient=t("./color/ColorGradient"),e.ColorList=t("./color/ColorList"),e.ColorRange=t("./color/ColorRange"),e.ColorTheme=t("./color/ColorTheme"),e.createListUsingStrategy=t("./color/createListUsingStrategy"),e.HistEntry=t("./color/HistEntry"),e.Histogram=t("./color/Histogram"),e.HSVAccessor=t("./color/HSVAccessor"),e.HSVDistanceProxy=t("./color/HSVDistanceProxy"),e.Hue=t("./color/Hue"),e.LuminanceAccessor=t("./color/LuminanceAccessor"),e.namedColor=t("./color/namedColor"),e.NamedColor=e.namedColor,e.ProximityComparator=t("./color/ProximityComparator"),e.RGBAccessor=t("./color/RGBAccessor"),e.RGBDistanceProxy=t("./color/RGBDistanceProxy"),e.TColor=t("./color/TColor"),e.theory=t("./color/theory"),e.ToneMap=t("./color/ToneMap")}),i("toxi/geom/Vec3D",["require","exports","module","./vectors"],function(t,e,i){i.exports=t("./vectors").Vec3D}),i("toxi/geom/Ray3D",["require","exports","module","../internals","./Vec3D","./Line3D"],function(t,e,i){var n=t("../internals").extend,r=t("./Vec3D"),s=t("./Line3D"),o=function(t,e,i,n){var s,o;4==arguments.length?(s=new r(t,e,i),o=n):2==arguments.length?(s=t,o=e):(s=new r,o=r.Y_AXIS.copy()),r.apply(this,[s]),this.dir=o};n(o,r),o.prototype.getDirection=function(){return this.dir.copy()},o.prototype.getDistanceToPoint=function(t){var e=t.sub(this);return e.distanceTo(this.dir.scale(e.dot(this.dir)))},o.prototype.getPointAtDistance=function(t){return this.add(this.dir.scale(t))},o.prototype.setDirection=function(t){return this.dir.set(t).normalize(),this},o.prototype.toLine3DWithPointAtDistance=function(t){return new s(this,this.getPointAtDistance(t))},o.prototype.toString=function(){return"origin: "+this.parent.toString.call(this)+" dir: "+this.dir},i.exports=o}),i("toxi/geom/Line3D",["require","exports","module","../math/mathUtils","./Ray3D"],function(t,e,i){var n=t("../math/mathUtils"),r=t("./Ray3D"),s=function(t,e){this.a=t,this.b=e};s.prototype={constructor:s,closestLineTo:function(t){var e=t.a.sub(t.b);if(e.isZeroVector())return new s.LineIntersection(s.LineIntersection.Type.NON_INTERSECTING);var i=this.b.sub(this.a);if(i.isZeroVector())return new s.LineIntersection(s.LineIntersection.Type.NON_INTERSECTING);var r=this.a.sub(t.a),o=r.x*e.x+r.y*e.y+r.z*e.z,a=e.x*i.x+e.y*i.y+e.z*i.z,h=r.x*i.x+r.y*i.y+r.z*i.z,u=e.x*e.x+e.y*e.y+e.z*e.z,c=i.x*i.x+i.y*i.y+i.z*i.z,l=c*u-a*a;if(Math.abs(l)<n.EPS)return new s.LineIntersection(s.LineIntersection.Type.NON_INTERSECTING);var f=o*a-h*u,p=f/l,d=(o+a*p)/u,g=this.a.add(i.scaleSelf(p)),m=t.a.add(e.scaleSelf(d));return new s.LineIntersection(s.LineIntersection.Type.INTERSECTING,new s(g,m),p,d)},closestPointTo:function(t){var e=this.b.sub(this.a),i=t.sub(this.a).dot(e)/e.magSquared();return 0>i?this.a.copy():i>1?this.b.copy():this.a.add(e.scaleSelf(i))},copy:function(){return new s(this.a.copy(),this.b.copy())},equals:function(t){return this==t?!0:typeof t!=s?!1:(this.a.equals(t.a)||this.a.equals(l.b))&&(this.b.equals(l.b)||this.b.equals(l.a))},getDirection:function(){return this.b.sub(this.a).normalize()},getLength:function(){return this.a.distanceTo(this.b)},getLengthSquared:function(){return this.a.distanceToSquared(this.b)},getMidPoint:function(){return this.a.add(this.b).scaleSelf(.5)},getNormal:function(){return this.b.cross(this.a)},hasEndPoint:function(t){return this.a.equals(t)||this.b.equals(t)},offsetAndGrowBy:function(t,e,i){var n=this.getMidPoint(),r=this.getDirection(),s=this.a.cross(r).normalize();return void 0!==i&&n.sub(i).dot(s)<0&&s.invert(),s.normalizeTo(t),this.a.addSelf(s),this.b.addSelf(s),r.scaleSelf(e),this.a.subSelf(r),this.b.addSelf(r),this},set:function(t,e){return this.a=t,this.b=e,this},splitIntoSegments:function(t,e,i){return s.splitIntoSegments(this.a,this.b,e,t,i)},toRay3D:function(){return new r(this.a.copy(),this.getDirection())},toString:function(){return this.a.toString()+" -> "+this.b.toString()}},s.splitIntoSegments=function(t,e,i,n,r){void 0===n&&(n=[]),r&&n.push(t.copy());var s=t.distanceTo(e);if(s>i)for(var o=t.copy(),a=e.sub(t).limit(i);s>i;)o.addSelf(a),n.push(o.copy()),s-=i;return n.push(e.copy()),n},s.LineIntersection=function(t,e,i,n){this.type=t,void 0===i&&(i=0),void 0===n&&(n=0),this.line=e,this.coeff=[i,n]},s.LineIntersection.prototype={getCoefficient:function(){return this.coeff},getLength:function(){return void 0===this.line?void 0:this.line.getLength()},getLine:function(){return void 0===this.line?void 0:this.line.copy()},getType:function(){return this.type},isIntersectionInside:function(){return this.type==s.LineIntersection.Type.INTERSECTING&&this.coeff[0]>=0&&this.coeff[0]<=1&&this.coeff[1]>=0&&this.coeff[1]<=1},toString:function(){return"type: "+this.type+" line: "+this.line}},s.LineIntersection.Type={NON_INTERSECTING:0,INTERSECTING:1},i.exports=s}),i("toxi/geom/Matrix4x4",["require","exports","module","../math/mathUtils","./Vec3D","../internals"],function(t,e,i){var n=t("../math/mathUtils"),r=t("../internals"),s=t("./Vec3D"),o=function(t,e,i,n,s,o,a,h,u,c,l,f,p,d,g,m){this.temp=[],this.matrix=[];var y=this;if(0===arguments.length)this.matrix[0]=[1,0,0,0],this.matrix[1]=[0,1,0,0],this.matrix[2]=[0,0,1,0],this.matrix[3]=[0,0,0,1];else if("number"==typeof t){var x=[t,e,i,n],v=[s,o,a,h],b=[u,c,l,f],w=[p,d,g,m];this.matrix=[x,v,b,w]}else if(r.is.Array(t)){var S=t;if(9!=S.length&&16!=S.length)throw new Error("Matrix4x4: Array length must == 9 or 16");16==S.length?(this.matrix=[],this.matrix[0]=S.slice(0,4),this.matrix[1]=S.slice(4,8),this.matrix[2]=S.slice(8,12),this.matrix[3]=S.slice(12)):(this.matrix[0]=S.slice(0,3),this.matrix[0][3]=0/0,this.matrix[1]=S.slice(3,6),this.matrix[1][3]=0/0,this.matrix[2]=S.slice(6,9),this.matrix[2][3]=0/0,this.matrix[3]=[0/0,0/0,0/0,0/0])}else if(r.is.Matrix4x4(t)){var A,C,T=t,M=0,z=0;if(16==T.matrix.length)for(M=0;4>M;M++)this.matrix[M]=[T.matrix[M][0],T.matrix[M][1],T.matrix[M][2],T.matrix[M][3]];else if(4==T.matrix.length)for(A=T.matrix.length,M=0;A>M;M++)for(C=T.matrix[M].length,y.matrix[M]=[],z=0;C>z;z++)y.matrix[M][z]=T.matrix[M][z]}else console.error("Matrix4x4: incorrect parameters used to construct new instance")};o.prototype={add:function(t){var e=new o(this);return e.addSelf(t)},addSelf:function(t){for(var e=0;4>e;e++){var i=this.matrix[e],n=t.matrix[e];i[0]+=n[0],i[1]+=n[1],i[2]+=n[2],i[3]+=n[3]}return this},applyTo:function(t){return this.applyToSelf(new s(t))},applyToSelf:function(t){for(var e=0;4>e;e++){var i=this.matrix[e];this.temp[e]=t.x*i[0]+t.y*i[1]+t.z*i[2]+i[3]}return t.set(this.temp[0],this.temp[1],this.temp[2]).scaleSelf(1/this.temp[3]),t},copy:function(){return new o(this)},getInverted:function(){return new o(this).invert()},getRotatedAroundAxis:function(t,e){return new o(this).rotateAroundAxis(t,e)},getRotatedX:function(t){return new o(this).rotateX(t)},getRotatedY:function(t){return new o(this).rotateY(t)},getRotatedZ:function(t){return new o(this).rotateZ(t)},getTransposed:function(){return new o(this).transpose()},identity:function(){var t=this.matrix[0];return t[1]=t[2]=t[3]=0,t=this.matrix[1],t[0]=t[2]=t[3]=0,t=this.matrix[2],t[0]=t[1]=t[3]=0,t=this.matrix[3],t[0]=t[1]=t[2]=0,this.matrix[0][0]=1,this.matrix[1][1]=1,this.matrix[2][2]=1,this.matrix[3][3]=1,this},invert:function(){var t=[],e=[],i=[],n=this.toArray(),r=0;for(r=0;4>r;r++){var s=r<<2;e[r]=n[s],e[r+4]=n[s+1],e[r+8]=n[s+2],e[r+12]=n[s+3]}t[0]=e[10]*e[15],t[1]=e[11]*e[14],t[2]=e[9]*e[15],t[3]=e[11]*e[13],t[4]=e[9]*e[14],t[5]=e[10]*e[13],t[6]=e[8]*e[15],t[7]=e[11]*e[12],t[8]=e[8]*e[14],t[9]=e[10]*e[12],t[10]=e[8]*e[13],t[11]=e[9]*e[12];var o=e[0],a=e[1],h=e[2],u=e[3],c=e[4],l=e[5],f=e[6],p=e[7];i[0]=t[0]*l+t[3]*f+t[4]*p,i[0]-=t[1]*l+t[2]*f+t[5]*p,i[1]=t[1]*c+t[6]*f+t[9]*p,i[1]-=t[0]*c+t[7]*f+t[8]*p,i[2]=t[2]*c+t[7]*l+t[10]*p,i[2]-=t[3]*c+t[6]*l+t[11]*p,i[3]=t[5]*c+t[8]*l+t[11]*f,i[3]-=t[4]*c+t[9]*l+t[10]*f,i[4]=t[1]*a+t[2]*h+t[5]*u,i[4]-=t[0]*a+t[3]*h+t[4]*u,i[5]=t[0]*o+t[7]*h+t[8]*u,i[5]-=t[1]*o+t[6]*h+t[9]*u,i[6]=t[3]*o+t[6]*a+t[11]*u,i[6]-=t[2]*o+t[7]*a+t[10]*u,i[7]=t[4]*o+t[9]*a+t[10]*h,i[7]-=t[5]*o+t[8]*a+t[11]*h,t[0]=h*p,t[1]=u*f,t[2]=a*p,t[3]=u*l,t[4]=a*f,t[5]=h*l,t[6]=o*p,t[7]=u*c,t[8]=o*f,t[9]=h*c,t[10]=o*l,t[11]=a*c,o=e[8],a=e[9],h=e[10],u=e[11],c=e[12],l=e[13],f=e[14],p=e[15],i[8]=t[0]*l+t[3]*f+t[4]*p,i[8]-=t[1]*l+t[2]*f+t[5]*p,i[9]=t[1]*c+t[6]*f+t[9]*p,i[9]-=t[0]*c+t[7]*f+t[8]*p,i[10]=t[2]*c+t[7]*l+t[10]*p,i[10]-=t[3]*c+t[6]*l+t[11]*p,i[11]=t[5]*c+t[8]*l+t[11]*f,i[11]-=t[4]*c+t[9]*l+t[10]*f,i[12]=t[2]*h+t[5]*u+t[1]*a,i[12]-=t[4]*u+t[0]*a+t[3]*h,i[13]=t[8]*u+t[0]*o+t[7]*h,i[13]-=t[6]*h+t[9]*u+t[1]*o,i[14]=t[6]*a+t[11]*u+t[3]*o,i[14]-=t[10]*u+t[2]*o+t[7]*a,i[15]=t[10]*h+t[4]*o+t[9]*a,i[15]-=t[8]*a+t[11]*h+t[5]*o;var d=1/(e[0]*i[0]+e[1]*i[1]+e[2]*i[2]+e[3]*i[3]);for(r=0,k=0;4>r;r++)for(var g=this.matrix[r],m=0;4>m;m++)g[m]=i[k++]*d;return this},multiply:function(t){return"number"==typeof t?new o(this).multiply(t):new o(this).multiplySelf(t)},multiplySelf:function(t){var e,i=0;if("number"==typeof t){for(i=0;4>i;i++)e=this.matrix[i],e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t;return this}var n=t.matrix[0],r=t.matrix[1],s=t.matrix[2],o=t.matrix[3];for(i=0;4>i;i++){e=this.matrix[i];for(var a=0;4>a;a++)this.temp[a]=e[0]*n[a]+e[1]*r[a]+e[2]*s[a]+e[3]*o[a];e[0]=this.temp[0],e[1]=this.temp[1],e[2]=this.temp[2],e[3]=this.temp[3]}return this},rotateAroundAxis:function(t,e){var i,n,r,s,o,h,u,c;return i=t.x,n=t.y,r=t.z,s=Math.sin(e),o=Math.cos(e),h=1-o,u=h*i,c=h*n,a.set(u*i+o,u*n+s*r,u*r-s*n,0,u*n-s*r,c*n+o,c*r+s*i,0,u*r+s*n,c*r-s*i,h*r*r+o,0,0,0,0,1),this.multiplySelf(a)},rotateX:function(t){return a.identity(),a.matrix[1][1]=a.matrix[2][2]=Math.cos(t),a.matrix[2][1]=Math.sin(t),a.matrix[1][2]=-a.matrix[2][1],this.multiplySelf(a)},rotateY:function(t){return a.identity(),a.matrix[0][0]=a.matrix[2][2]=Math.cos(t),a.matrix[0][2]=Math.sin(t),a.matrix[2][0]=-a.matrix[0][2],this.multiplySelf(a)},rotateZ:function(t){return a.identity(),a.matrix[0][0]=a.matrix[1][1]=Math.cos(t),a.matrix[1][0]=Math.sin(t),a.matrix[0][1]=-a.matrix[1][0],this.multiplySelf(a)},scale:function(t,e,i){return new o(this).scaleSelf(t,e,i)},scaleSelf:function(t,e,i){return r.has.XYZ(t)?(e=t.y,i=t.z,t=t.x):(void 0===e||void 0===i)&&(e=t,i=t),a.identity(),a.matrix[0][0]=t,a.matrix[1][1]=e,a.matrix[2][2]=i,this.multiplySelf(a)},set:function(t,e,i,n,r,s,o,a,h,u,c,l,f,p,d,g){var m;if("number"==typeof t)m=this.matrix[0],m[0]=t,m[1]=e,m[2]=i,m[3]=n,m=this.matrix[1],m[0]=r,m[1]=s,m[2]=o,m[3]=a,m=this.matrix[2],m[0]=h,m[1]=u,m[2]=c,m[3]=l,m=this.matrix[3],m[0]=f,m[1]=p,m[2]=d,m[3]=g;else for(var y=0;4>y;y++){m=this.matrix[y];var x=m.matrix[y];m[0]=x[0],m[1]=x[1],m[2]=x[2],m[3]=x[3]}return this},setFrustrum:function(t,e,i,n,r,s){var o=e-t,a=i-n,h=s-r;return this.set(2*r/o,0,(t+e)/o,0,0,2*r/a,(i+n)/a,0,0,0,-(r+s)/h,-2*r*s/h,0,0,-1,0)},setOrtho:function(t,e,i,n,r,s){var o=[2/(e-t),0,0,(t+e)/(e-t),0,2/(i-n),0,(i+n)/(i-n),0,0,-2/(s-r),(s+r)/(s-r),0,0,0,1];return this.set.apply(this,o)},setPerspective:function(t,e,i,r){var s=i*Math.tan(.5*n.radians(t)),o=e*s;return this.setFrustrum(-o,o,s,-s,i,r)},setPosition:function(t,e,i){return this.matrix[0][3]=t,this.matrix[1][3]=e,this.matrix[2][3]=i,this},setScale:function(t,e,i){return this.matrix[0][0]=t,this.matrix[1][1]=e,this.matrix[2][2]=i,this},sub:function(t){return new o(this).subSelf(t)},subSelf:function(t){for(var e=0;4>e;e++){var i=this.matrix[e],n=t.matrix[e];i[0]-=n[0],i[1]-=n[1],i[2]-=n[2],i[3]-=n[3]}return this},toArray:function(t){void 0===t&&(t=[]);for(var e=0,i=0;4>e;e++)for(var n=this.matrix[e],r=0;4>r;r++)t[i++]=n[r];return t},toFloatArray:function(t){return new Float32Array(this.toArray(t))},toString:function(){return"| "+this.matrix[0][0]+" "+this.matrix[0][1]+" "+this.matrix[0][2]+" "+this.matrix[0][3]+" |\n| "+this.matrix[1][0]+" "+this.matrix[1][1]+" "+this.matrix[1][2]+" "+this.matrix[1][3]+" |\n| "+this.matrix[2][0]+" "+this.matrix[2][1]+" "+this.matrix[2][2]+" "+this.matrix[2][3]+" |\n| "+this.matrix[3][0]+" "+this.matrix[3][1]+" "+this.matrix[3][2]+" "+this.matrix[3][3]+" |"},toTransposedFloatArray:function(t){void 0===t&&(t=[]);for(var e=0,i=0;4>e;e++)for(var n=0;4>n;n++)t[i++]=this.matrix[n][e];return t},translate:function(t,e,i){return new o(this).translateSelf(t,e,i)},translateSelf:function(t,e,i){return r.has.XYZ(t)&&(e=t.y,i=t.z,t=t.x),a.identity(),a.setPosition(t,e,i),this.multiplySelf(a)},transpose:function(){return this.set(this.matrix[0][0],this.matrix[1][0],this.matrix[2][0],this.matrix[3][0],this.matrix[0][1],this.matrix[1][1],this.matrix[2][1],this.matrix[3][1],this.matrix[0][2],this.matrix[1][2],this.matrix[2][2],this.matrix[3][2],this.matrix[0][3],this.matrix[1][3],this.matrix[2][3],this.matrix[3][3])}};var a=new o;i.exports=o}),i("toxi/geom/Vec2D",["require","exports","module","./vectors"],function(t,e,i){i.exports=t("./vectors").Vec2D}),i("toxi/geom/AABB",["require","exports","module","../internals","../math/mathUtils","./Vec2D","./Vec3D","./mesh/meshCommon"],function(t,e,i){var n=t("../internals"),r=t("./Vec3D"),s=t("./Vec2D"),o=t("../math/mathUtils"),a=function(t,e){void 0===t?(r.call(this),this.setExtent(new r)):"number"==typeof t?(r.call(this,new r),this.setExtent(t)):n.has.XYZ(t)&&(r.call(this,t),this.setExtent(void 0===e&&n.is.AABB(t)?t.getExtent():"number"==typeof e?new r(e,e,e):e))};n.extend(a,r),a.fromMinMax=function(t,e){var i=r.min(t,e),n=r.max(t,e);return new a(i.interpolateTo(n,.5),n.sub(i).scaleSelf(.5))},a.prototype.containsPoint=function(t){return t.isInAABB(this)},a.prototype.copy=function(){return new a(this)},a.prototype.getExtent=function(){return this.extent.copy()},a.prototype.getMax=function(){return this.max.copy()},a.prototype.getMin=function(){return this.min.copy()},a.prototype.getNormalForPoint=function(t){t=t.sub(this);var e=this.extent.sub(t.getAbs()),i=t.getSignum(),n=r.X_AXIS.scale(i.x),s=e.x;return e.y<s&&(s=e.y,n=r.Y_AXIS.scale(i.y)),e.z<s&&(n=r.Z_AXIS.scale(i.z)),n},a.prototype.includePoint=function(t){return this.min.minSelf(t),this.max.maxSelf(t),this.set(this.min.interpolateTo(this.max,.5)),this.extent.set(this.max.sub(this.min).scaleSelf(.5)),this},a.prototype.intersectsBox=function(t){var e=t.sub(this);return Math.abs(e.x)<=this.extent.x+t.extent.x&&Math.abs(e.y)<=this.extent.y+t.extent.y&&Math.abs(e.z)<=this.extent.z+t.extent.z},a.prototype.intersectsRay=function(t,e,i){var n=t.getDirection().reciprocal(),r=n.x<0,s=n.y<0,o=n.z<0,a=r?this.max:this.min,h=(a.x-t.x)*n.x;a=r?this.min:this.max;var u=(a.x-t.x)*n.x;a=s?this.max:this.min;var c=(a.y-t.y)*n.y;a=s?this.min:this.max;var l=(a.y-t.y)*n.y;if(h>l||c>u)return null;c>h&&(h=c),u>l&&(u=l),a=o?this.max:this.min;var f=(a.z-t.z)*n.z;a=o?this.min:this.max;var p=(a.z-t.z)*n.z;return h>p||f>u?null:(f>h&&(h=f),u>p&&(u=p),i>h&&u>e?t.getPointAtDistance(h):void 0)},a.prototype.intersectsSphere=function(t,e){1==arguments.length&&(e=t.radius);var i,n=0;return t.x<this.min.x?(i=t.x-this.min.x,n=i*i):t.x>this.max.x&&(i=t.x-this.max.x,n+=i*i),t.y<this.min.y?(i=t.y-this.min.y,n+=i*i):t.y>this.max.y&&(i=t.y-this.max.y,n+=i*i),t.z<this.min.z?(i=t.z-this.min.z,n+=i*i):t.z>this.max.z&&(i=t.z-this.max.z,n+=i*i),e*e>=n},a.prototype.intersectsTriangle=function(t){var e,i,n,r,s,a,h,u;if(e=t.a.sub(this),i=t.b.sub(this),n=t.c.sub(this),s=i.sub(e),a=n.sub(i),h=e.sub(n),u=s.getAbs(),this.testAxis(s.z,-s.y,u.z,u.y,e.y,e.z,n.y,n.z,this.extent.y,this.extent.z))return!1;if(this.testAxis(-s.z,s.x,u.z,u.x,e.x,e.z,n.x,n.z,this.extent.x,this.extent.z))return!1;if(this.testAxis(s.y,-s.x,u.y,u.x,i.x,i.y,n.x,n.y,this.extent.x,this.extent.y))return!1;if(u=a.getAbs(),this.testAxis(a.z,-a.y,u.z,u.y,e.y,e.z,n.y,n.z,this.extent.y,this.extent.z))return!1;if(this.testAxis(-a.z,a.x,u.z,u.x,e.x,e.z,n.x,n.z,this.extent.x,this.extent.z))return!1;if(this.testAxis(a.y,-a.x,u.y,u.x,e.x,e.y,i.x,i.y,this.extent.x,this.extent.y))return!1;if(u=h.getAbs(),this.testAxis(h.z,-h.y,u.z,u.y,e.y,e.z,i.y,i.z,this.extent.y,this.extent.z))return!1;if(this.testAxis(-h.z,h.x,u.z,u.x,e.x,e.z,i.x,i.z,this.extent.x,this.extent.z))return!1;if(this.testAxis(h.y,-h.x,u.y,u.x,i.x,i.y,n.x,n.y,this.extent.x,this.extent.y))return!1;if(o.min(e.x,i.x,n.x)>this.extent.x||o.max(e.x,i.x,n.x)<-this.extent.x)return!1;if(o.min(e.y,i.y,n.y)>this.extent.y||o.max(e.y,i.y,n.y)<-this.extent.y)return!1;if(o.min(e.z,i.z,n.z)>this.extent.z||o.max(e.z,i.z,n.z)<-this.extent.z)return!1;r=s.cross(a);var c=-r.dot(e);return this.planeBoxOverlap(r,c,this.extent)?!0:!1},a.prototype.planeBoxOverlap=function(t,e,i){var n=new r,s=new r;return t.x>0?(n.x=-i.x,s.x=i.x):(n.x=i.x,s.x=-i.x),t.y>0?(n.y=-i.y,s.y=i.y):(n.y=i.y,s.y=-i.y),t.z>0?(n.z=-i.z,s.z=i.z):(n.z=i.z,s.z=-i.z),t.dot(n)+e>0?!1:t.dot(s)+e>=0?!0:!1},a.prototype.set=function(t,e,i){return n.is.AABB(t)?(this.extent.set(t.extent),r.set.apply(this,[t])):(n.has.XYZ(t)&&(e=t.y,i=t.z,t=t.a),this.x=t,this.y=e,this.z=i,this.updateBounds(),this)},a.prototype.setExtent=function(t){return this.extent=t.copy(),this.updateBounds()},a.prototype.testAxis=function(t,e,i,n,r,s,o,a,h,u){var c,l,f=t*r+e*s,p=t*o+e*a;p>f?(c=f,l=p):(c=p,l=f);var d=i*h+n*u;return c>d||-d>l},a.prototype.toMesh=function(e){if(void 0===e){var i=t("./mesh/meshCommon").TriangleMesh;e=new i("aabb",8,12)}var n=this.min,o=this.max,a=new r(n.x,n.y,o.z),h=new r(o.x,n.y,o.z),u=new r(o.x,n.y,n.z),c=new r(n.x,o.y,n.z),l=new r(n.x,o.y,o.z),f=new r(o.x,o.y,n.z),p=new s(0,0),d=new s(1,0),g=new s(1,1),m=new s(0,1);return e.addFace(n,a,l,m,g,d),e.addFace(n,l,c,m,d,p),e.addFace(a,h,o,m,g,d),e.addFace(a,o,l,m,d,p),e.addFace(h,u,f,m,g,d),e.addFace(h,f,o,m,d,p),e.addFace(u,n,c,m,g,d),e.addFace(u,c,f,m,d,p),e.addFace(c,l,f,p,m,d),e.addFace(l,o,f,m,g,d),e.addFace(n,u,a,m,g,p),e.addFace(a,u,h,p,g,d),e},a.prototype.toString=function(){return"<aabb> pos: "+r.prototype.toString.call(this)+" ext: "+this.extent.toString()},a.prototype.updateBounds=function(){return void 0!==this.extent&&(this.min=this.sub(this.extent),this.max=this.add(this.extent)),this},i.exports=a}),i("toxi/geom/Triangle3D",["require","exports","module","../math/mathUtils","./Vec3D","./Line3D","./AABB"],function(t,e,i){var n=t("../math/mathUtils"),r=t("./Vec3D"),s=t("./Line3D"),o=t("./AABB"),h=function(t,e,i){this.a=t,this.b=e,this.c=i};h.createEquilateralFrom=function(t,e){var i=t.interpolateTo(e,.5),r=e.sub(t),s=t.cross(r.normalize());return i.addSelf(s.normalizeTo(r.magnitude()*n.SQRT3/2)),new h(t,e,i)},h.isClockwiseInXY=function(t,e,i){var n=(e.x-t.x)*(i.y-t.y)-(i.x-t.x)*(e.y-t.y);return 0>n},h.isClockwiseInXZ=function(t,e,i){var n=(e.x-t.x)*(i.z-t.z)-(i.x-t.x)*(e.z-t.z);return 0>n},h.isClockwiseInYZ=function(t,e,i){var n=(e.y-t.y)*(i.z-t.z)-(i.y-t.y)*(e.z-t.z);return 0>n},h.prototype={closestPointOnSurface:function(t){var e=this.b.sub(this.a),i=this.c.sub(this.a),n=this.c.sub(this.b),r=t.sub(this.a),s=t.sub(this.b),o=t.sub(this.c),h=a.sub(this.p),u=b.sub(this.p),l=c.sub(this.p),f=r.dot(e),p=r.dot(i);if(0>=f&&0>=p)return this.a;var d=s.dot(this.a.sub(this.b)),g=o.dot(this.a.sub(this.c)),m=s.dot(n),y=o.dot(this.b.sub(this.c));if(0>=d&&0>=m)return this.b;if(0>=g&&0>=y)return this.c;var x=e.cross(i),v=x.dot(h.crossSelf(u));if(0>=v&&f>=0&&d>=0)return this.a.add(e.scaleSelf(f/(f+d)));var w=x.dot(u.crossSelf(l));if(0>=w&&m>=0&&y>=0)return this.b.add(n.scaleSelf(m/(m+y)));var S=x.dot(l.crossSelf(h));if(0>=S&&p>=0&&g>=0)return this.a.add(i.scaleSelf(p/(p+g)));var A=w/(w+S+v),C=S/(w+S+v),T=1-A-C;return this.a.scale(A).addSelf(this.b.scale(C)).addSelf(this.c.scale(T))},computeCentroid:function(){return this.centroid=this.a.add(this.b).addSelf(this.c).scaleSelf(1/3),this.centroid},computeNormal:function(){return this.normal=this.a.sub(this.c).crossSelf(this.a.sub(this.b)).normalize(),this.normal},containsPoint:function(t){if(t.equals(this.a)||t.equals(this.b)||t.equals(this.c))return!0;var e=t.sub(this.a).normalize(),i=t.sub(this.b).normalize(),r=t.sub(this.c).normalize(),s=Math.acos(e.dot(i));return s+=Math.acos(i.dot(r)),s+=Math.acos(r.dot(e)),n.abs(s-n.TWO_PI)<=.005},flipVertexOrder:function(){this.a;return this.a=this.c,this.c=this.t,this},fromBarycentric:function(t){return new r(this.a.x*t.x+this.b.x*t.y+this.c.x*t.z,this.a.y*t.x+this.b.y*t.y+this.c.y*t.z,this.a.z*t.x+this.b.z*t.y+this.c.z*t.z)},getBoundingBox:function(){var t=r.min(r.min(this.a,this.b),this.c),e=r.max(r.max(this.a,this.b),this.c);return o.fromMinMax(t,e)},getClosestPointTo:function(t){var e=new s(this.a,this.b),i=e.closestPointTo(t),n=e.set(this.b,this.c).closestPointTo(t),r=e.set(this.c,this.a).closestPointTo(t),o=t.sub(i).magSquared(),a=t.sub(n).magSquared(),h=t.sub(r).magSquared(),u=o,c=i;return u>a&&(u=a,c=n),u>h&&(c=r),c},isClockwiseInXY:function(){return h.isClockwiseInXY(this.a,this.b,this.c)},isClockwiseInXZ:function(){return h.isClockwiseInXY(this.a,this.b,this.c)},isClockwiseInYZ:function(){return h.isClockwiseInXY(this.a,this.b,this.c)},set:function(t,e,i){this.a=t,this.b=e,this.c=i},toBarycentric:function(t){var e=b.sub(this.a).cross(this.c.sub(this.a)),i=e.getNormalized(),n=i.dot(e),s=i.dot(this.b.sub(t).cross(this.c.sub(t))),o=s/n,a=i.dot(this.c.sub(t).cross(this.a.sub(t))),h=a/n,u=1-o-h;return new r(o,h,u)},toString:function(){return"Triangle: "+this.a+","+this.b+","+this.c}},i.exports=h}),i("toxi/geom/mesh/Face",["require","exports","module","../Triangle3D","../../internals"],function(t,e,i){var n,r;!function(){var e=t("../Triangle3D");n=function(t,e,i,n,r,s){this.a=t,this.b=e,this.c=i;var o=this.a.sub(this.c),a=this.a.sub(this.b),h=o.crossSelf(a);this.normal=h.normalize(),this.a.addFaceNormal(this.normal),this.b.addFaceNormal(this.normal),this.c.addFaceNormal(this.normal),void 0!==n&&(this.uvA=n,this.uvB=r,this.uvC=s)},n.prototype={computeNormal:function(){this.normal=this.a.sub(this.c).crossSelf(this.a.sub(this.b)).normalize()},flipVertexOrder:function(){var t=this.a;this.a=this.b,this.b=t,this.normal.invert()},getCentroid:function(){return this.a.add(this.b).addSelf(this.c).scale(1/3)},getClass:function(){return"Face"},getVertices:function(t){return void 0!==t?(t[0]=this.a,t[1]=this.b,t[2]=this.c):t=[this.a,this.b,this.c],t},toString:function(){return this.getClass()+" "+this.a+", "+this.b+", "+this.c},toTriangle:function(){return new e(this.a.copy(),this.b.copy(),this.c.copy())}}}(),function(){var e,i=t("../../internals");r=function(t,e,i,r,s,o){n.call(this,t,e,i,r,s,o),this.edges=[]},i.extend(r,n),e=r.prototype,e.addEdge=function(t){this.edges.push(t)},e.getEdges=function(){return this.edges},e.getVertices=function(t){return void 0!==t?(t[0]=this.a,t[1]=this.b,t[2]=this.c):t=[this.a,this.b,this.c],t}}(),n.WEFace=r,i.exports=n}),i("toxi/geom/Quaternion",["require","exports","module","../math/mathUtils","./Matrix4x4"],function(t,e,i){var n=t("../math/mathUtils"),r=t("./Matrix4x4"),s=function(t,e,i,n){4==arguments.length?(this.w=t,this.x=e,this.y=i,this.z=n):2==arguments.length?(this.x=e.x,this.y=e.y,this.z=e.z,this.w=t):1==arguments.length&&(this.w=q.w,this.x=q.x,this.y=q.y,this.z=q.z)};s.prototype={add:function(t){return new s(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},addSelf:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},copy:function(){return new s(this.w,this.x,this.y,this.z)
},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},getConjugate:function(){var t=new s;return t.x=-this.x,t.y=-this.y,t.z=-this.z,t.w=w,t},identity:function(){return this.w=1,this.x=0,this.y=0,this.z=0,this},interpolateTo:function(t,e,i){return 3==arguments.length?this.copy().interpolateTo(t,i.interpolate(0,1,e)):this.copy().interpolateToSelf(t,e)},interpolateToSelf:function(t,e,i){3==arguments.length&&(e=i.interpolate(0,1,e));var r,s,o=n.clip(this.dot(t),-1,1);if(1-o>=n.EPS){var a=Math.acos(o),h=1/Math.sin(a);r=Math.sin(a*(1-e))*h,s=Math.sin(a*e)*h}else r=1-e,s=e;return 0>o?(this.w=r*this.w-s*t.w,this.x=r*this.x-s*t.x,this.y=r*this.y-s*t.y,this.z=r*this.z-s*t.z):(this.w=r*w+s*t.w,this.x=r*x+s*t.x,this.y=r*y+s*t.y,this.z=r*z+s*t.z),this},magnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},multiply:function(t){var e=new s;return e.w=this.w*t.w-x*t.x-y*t.y-z*t.z,e.x=this.w*t.x+x*t.w+y*t.z-z*t.y,e.y=this.w*t.y+y*t.w+z*t.x-x*t.z,e.z=this.w*t.z+z*t.w+x*t.y-y*t.x,e},normalize:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return t>n.EPS&&(t=1/t,this.x*=t,this.y*=t,this.z*=t,this.w*=t),this},scale:function(t){return new s(this.x*t,this.y*t,this.z*t,this.w*t)},scaleSelf:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},set:function(t,e,i,n){return 4==arguments.length?(this.w=t,this.x=e,this.y=i,this.z=n):2==arguments.length?(this.w=t,this.x=v.x,this.y=v.y,this.z=v.z):(this.w=q.w,this.x=q.x,this.y=q.y,this.z=q.z),this},sub:function(t){return new s(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},subSelf:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this},toArray:function(){return[this.w,this.x,this.y,this.z]},toAxisAngle:function(){var t=[],e=Math.sqrt(1-this.w*this.w);return e=e<n.EPS?1:1/e,t[0]=2*Math.acos(this.w),t[1]=this.x*e,t[2]=this.y*e,t[3]=this.z*e,t},toMatrix4x4:function(t){void 0===t&&(t=new r);var e=this.x+this.x,i=this.y+this.y,n=this.z+this.z,s=this.x*e,o=this.x*i,a=this.x*n,h=this.y*i,u=this.y*n,c=this.z*n,l=this.w*e,f=this.w*i,p=this.w*n;return t.set(1-(h+c),o-p,a+f,0,o+p,1-(s+c),u-l,0,a-f,u+l,1-(s+h),0,0,0,0,1)},toString:function(){return"{axis: ["+this.x+","+this.y+","+this.z+"], w: "+this.w+"}"}},s.DOT_THRESHOLD=.9995,s.createFromAxisAngle=function(t,e){e*=.5;var i=n.sin(e),r=n.cos(e),o=new s(r,t.getNormalizedTo(i));return o},s.createFromEuler=function(t,e,i){t*=.5,e*=.5,i*=.5;var r=n.sin(t),o=n.cos(t),a=n.sin(e),h=n.cos(e),u=n.sin(i),c=n.cos(i),l=o*h,f=r*a,p=new s;return p.x=u*l-c*f,p.y=c*r*h+u*o*a,p.z=c*o*a-u*r*h,p.w=c*l+u*f,p},s.createFromMatrix=function(t){var e=0,i=[],n=t.matrix[0][0]+t.matrix[1][1]+t.matrix[2][2];if(n>0)e=Math.sqrt(n+1),i[3]=.5*e,e=.5/e,i[0]=t.matrix[1][2]-t.matrix[2][1]*e,i[1]=t.matrix[2][0]-t.matrix[0][2]*e,i[2]=t.matrix[0][1]-t.matrix[1][0]*e;else{var r=[1,2,0],o=0,a=0,h=0;t.matrix[1][1]>t.matrix[0][0]&&(o=1),t.matrix[2][2]>t.matrix[o][o]&&(o=2),a=r[o],h=r[a],e=Math.sqrt(t.matrix[o][o]-(t.matrix[a][a]+t.matrix[h][h])+1),i[o]=.5*e,e=.5/e,i[3]=(t.matrix[a][h]-t.matrix[h][a])*e,i[a]=(t.matrix[o][a]+t.matrix[a][o])*e,i[h]=(t.matrix[o][h]+t.matrix[h][o])*e}return new s(i[3],i[0],i[1],i[2])},s.getAlignmentQuat=function(t,e){var i=t.getNormalized(),n=e.cross(i),r=n.magnitude()+1e-4,s=Math.atan2(r,e.dot(i));return this.createFromAxisAngle(n,s)},i.exports=s}),i("toxi/geom/mesh/Vertex",["require","exports","module","../../internals","../Vec3D"],function(t,e,i){var n,r;!function(){var e,i=t("../../internals").extend,r=t("../Vec3D");n=function(t,e){r.call(this,t),this.id=e,this.normal=new r},i(n,r),e=n.prototype,e.addFaceNormal=function(t){this.normal.addSelf(t)},e.clearNormal=function(){this.normal.clear()},e.computeNormal=function(){this.normal.normalize()},e.toString=function(){return this.id+": p: "+this.parent.toString.call(this)+" n:"+this.normal.toString()}}(),function(){var e,i=t("../../internals").extend;return r=function(t,e){n.call(this,t,e),this.edges=[]},i(r,n),e=r.prototype,e.addEdge=function(t){this.edges.push(t)},e.getNeighborInDirection=function(t,e){for(var i,n,r=1-e,s=this.getNeighbors(),o=0,a=s.length;a>o;o++)n=s[o].sub(this).normalize().dot(t),n>r&&(i=s[o],r=n);return i},e.getNeighbors=function(){for(var t=[],e=0,i=this.edges.length;i>e;e++)t.push(this.edges[e].getOtherEndFor(this));return t},e.removeEdge=function(t){this.edges.splice(this.edges.indexOf(t),1)},e.toString=function(){return this.id+" {"+this.x+","+this.y+","+this.z+"}"},r}(),n.WEVertex=r,i.exports=n}),i("toxi/geom/Sphere",["require","../internals","./mesh/meshCommon","./Vec3D","../math/mathUtils","./Vec3D","../internals"],function(t){var e,i;return function(){var n=t("../internals"),r=t("./mesh/meshCommon"),s=t("./Vec3D");e=function(t,e){void 0===t?(s.apply(this,[new s]),this.radius=1):n.has.XYZ(t)?(s.apply(this,[t]),this.radius=n.is.Sphere(t)?t.radius:e):(s.apply(this,[new s]),this.radius=t)},n.extend(e,s),e.prototype.containsPoint=function(t){var e=this.sub(t).magSquared();return e<=this.radius*this.radius},e.prototype.intersectRay=function(t){var e,i,n,r,s=t.sub(this),o=s.magSquared(),a=-s.dot(t.getDirection()),h=this.radius*this.radius-(o-a*a);return h>=0&&(h=Math.sqrt(h),i=a+h,n=a-h,0>i&&0>n||(i>0&&n>0?i>n&&(r=i,i=n,n=r):n>0&&(r=i,i=n,n=r)),e=[i,n]),e},e.prototype.intersectSphereTriangle=function(t,e){e.set(t.closestPointOnSurface(this));var i=e.sub(this);return i.magSquared()<=this.radius*this.radius},e.prototype.tangentPlaneNormalAt=function(t){return this.sub(t).normalize()},e.prototype.toMesh=function(){var t={mesh:void 0,resolution:0};1===arguments.length?"object"==typeof arguments[0]?(t.mesh=arguments[0].mesh,t.resolution=arguments[0].res||arguments[0].resolution):t.resolution=arguments[0]:(t.mesh=arguments[0],t.resolution=arguments[1]);var e=new r.SurfaceMeshBuilder(new i(this));return e.createMesh(t.mesh,t.resolution,1)}}(),function(e){var n=t("../math/mathUtils"),r=t("./Vec3D"),s=t("../internals");i=function(t){void 0===t&&(this.sphere=new e(new r,1)),this.sphere=s.is.Sphere(t)?t:new e(new r,t),this.phiRange=n.PI,this.thetaRange=n.TWO_PI},i.prototype={computeVertexFor:function(t,e,i){e-=n.HALF_PI;var r=n.cos(e),s=n.cos(i),o=n.sin(e),a=n.sin(i),h=n.sign(r)*n.abs(r);return t.x=h*n.sign(s)*n.abs(s),t.y=n.sign(o)*n.abs(o),t.z=h*n.sign(a)*n.abs(a),t.scaleSelf(this.sphere.radius).addSelf(this.sphere)},getPhiRange:function(){return this.phiRange},getPhiResolutionLimit:function(t){return t},getThetaRange:function(){return this.thetaRange},getThetaResolutionLimit:function(t){return t},setMaxPhi:function(t){this.phiRange=n.min(t/2,n.PI)},setMaxTheta:function(t){this.thetaRange=n.min(t,n.TWO_PI)}}}(e),e.SphereFunction=i,e}),i("toxi/geom/mesh/WingedEdge",["../../internals","../Line3D"],function(t,e){var i,n;return i=function(t,i,n,r){e.call(this,t,i),this.id=r,this.faces=[],this.addFace(n)},t.extend(i,e),n=i.prototype,n.addFace=function(t){return this.faces.push(t),this},n.getFaces=function(){return this.faces},n.getOtherEndFor=function(t){return this.a===t?this.b:this.b===t?this.a:void 0},n.remove=function(){for(var t=this,e=function(e){e.splice(e.indexOf(t),1)},i=0,n=this.faces.length;n>i;i++)e(this.faces[i].edges);e(this.a.edges),e(this.b.edges)},n.toString=function(){return"id: "+this.id+" "+e.prototype.toString.call(this)+" f: "+this.faces.length},i}),i("toxi/geom/mesh/subdiv/EdgeLengthComparator",[],function(){var t=function(){};return t.prototype.compare=function(t,e){return-parseInt(t.getLengthSquared()-e.getLengthSquared(),10)},t}),i("toxi/geom/mesh/subdiv/SubdivisionStrategy",["./EdgeLengthComparator"],function(t){var e,i;return e=function(){this._order=e.DEFAULT_ORDERING},e.DEFAULT_ORDERING=new t,i=e.prototype,i.getEdgeOrdering=function(){return this._order.compare},i.setEdgeOrdering=function(t){this._order=t},e}),i("toxi/geom/mesh/subdiv/MidpointSubdivision",["../../../internals","./SubdivisionStrategy"],function(t,e){var i=function(){e.call(this)};return t.extend(i,e),i.prototype.computeSplitPoints=function(t){var e=[];return e.push(t.getMidPoint()),e},i}),i("toxi/math/Interpolation2D",["../internals"],function(t){var e={};return e.bilinear=function(e,i,n,r,s,o,a,h,u,c){var l,f,p,d,g,m,y,x,v,b;t.has.XY(e)?(l=e.x,f=e.y,p=i.x,d=i.y,g=n.x,m=n.y,y=r,x=s,v=o,b=a):(l=e,f=i,p=n,d=r,g=s,m=o,y=a,x=h,v=u,b=c);var w=1/((g-p)*(m-d)),S=(l-p)*w,A=(g-l)*w,C=f-d,T=m-f;return y*A*T+x*S*T+v*A*C+b*S*C},e}),i("toxi/geom/IsectData3D",["require","exports","module","./Vec3D"],function(t,e,i){var n=t("./Vec3D"),r=function(t){void 0!==t?(this.isIntersection=t.isIntersection,this.dist=t.dist,this.pos=t.pos.copy(),this.dir=t.dir.copy(),this.normal=t.normal.copy()):this.clear()};r.prototype={clear:function(){this.isIntersection=!1,this.dist=0,this.pos=new n,this.dir=new n,this.normal=new n},toString:function(){var t="isec: "+this.isIntersection;return this.isIntersection&&(t+=" at:"+this.pos+" dist:"+this.dist+" normal:"+this.normal),t}},i.exports=r}),i("toxi/geom/TriangleIntersector",["../math/mathUtils","./Triangle3D","./Vec3D","./IsectData3D"],function(t,e,i,n){var r=function(t){this.triangle=t||new e,this.isectData=new n};return r.prototype={getIntersectionData:function(){return this.isectData},getTriangle:function(){return this.triangle},intersectsRay:function(e){this.isectData.isIntersection=!1;var i=this.triangle.computeNormal(),n=i.dot(e.dir);if(0>n){var r=e.sub(this.triangle.a),s=-(i.x*r.x+i.y*r.y+i.z*r.z)/(i.x*e.dir.x+i.y*e.dir.y+i.z*e.dir.z);if(s>=t.EPS){var o=e.getPointAtDistance(s);this.triangle.containsPoint(o)&&(this.isectData.isIntersection=!0,this.isectData.pos=o,this.isectData.normal=i,this.isectData.dist=s,this.isectData.dir=this.isectData.pos.sub(e).normalize())}}return this.isectData.isIntersection},setTriangle:function(t){return this.triangle=t,this}},r}),i("toxi/geom/mesh/meshCommon",["require","exports","module","../Line3D","../../internals","../../math/mathUtils","../Matrix4x4","./Face","../Vec3D","../Triangle3D","../Quaternion","./Vertex","../AABB","../Sphere","../../internals","../Line3D","../Vec3D","./Vertex","./Face","./WingedEdge","./subdiv/MidpointSubdivision","../../internals","../../math/mathUtils","../../math/Interpolation2D","../Ray3D","../TriangleIntersector","../Triangle3D","../IsectData3D","../vectors","../vectors","../Vec3D","../Vec2D"],function(t,e){function i(t){var e=1e6,i=function(t){return Math.floor(t*e)/e};return"[ x: "+i(t.x)+", y: "+i(t.y)+", z: "+i(t.z)+"]"}function n(e){var i=t("../Line3D");return i.prototype.toString.call(e)}var r,s,o,a;!function(){var e=t("../../internals"),n=t("../../math/mathUtils"),o=t("../Matrix4x4"),a=t("./Face"),h=t("../Vec3D"),u=t("../Triangle3D"),c=t("../Quaternion"),l=t("./Vertex");r=function(t){return void 0===t&&(t="untitled"),this.init(t),this},r.__vertexKeyGenerator=i,r.DEFAULT_NUM_VERTICES=1e3,r.DEFAULT_NUM_FACES=3e3,r.DEFAULT_STRIDE=4,r.prototype={addFace:function(t,e,i,n,r,s,o){6==arguments.length&&(o=s,s=r,r=n,n=void 0);var h=this.__checkVertex(t),u=this.__checkVertex(e),c=this.__checkVertex(i);if(h.id===u.id||h.id===c.id||u.id===c.id);else{if(void 0!==n){var l=h.sub(c).crossSelf(h.sub(u));if(n.dot(l)<0){var f=h;h=u,u=f}}var p=new a(h,u,c,r,s,o);this.faces.push(p)}return this},addMesh:function(t){for(var e=t.getFaces().length,i=0;e>i;i++){var n=t.getFaces()[i];this.addFace(n.a,n.b,n.c)}return this},center:function(t){this.computeCentroid();for(var e=void 0!==t?t.sub(this.centroid):this.centroid.getInverted(),i=this.vertices.length,n=0;i>n;n++){var r=this.vertices[n];r.addSelf(e)}return this.getBoundingBox()},__checkVertex:function(t){var e=this.vertexMap.get(t);return void 0===e&&(e=this._createVertex(t,this.uniqueVertexID++),this.vertexMap.put(e,e)),e},clear:function(){return this.vertexMap=new e.LinkedMap(i),this.vertices=this.vertexMap.getArray(),this.faces=[],this.bounds=void 0,this},computeCentroid:function(){this.centroid.clear();for(var t=this.vertices.length,e=0;t>e;e++)this.centroid.addSelf(this.vertices[e]);return this.centroid.scaleSelf(1/this.vertexMap.size()).copy()},computeFaceNormals:function(){for(var t=this.faces.length,e=0;t>e;e++)this.faces[e].computeNormal()},computeVertexNormals:function(){var t=this.vertices.length,e=0;for(e=0;t>e;e++)this.vertices[e].clearNormal();for(t=this.faces.length,e=0;t>e;e++){var i=this.faces[e];i.a.addFaceNormal(i.normal),i.b.addFaceNormal(i.normal),i.c.addFaceNormal(i.normal)}for(t=this.vertices.length,e=0;t>e;e++)this.vertices[e].computeNormal();return this},copy:function(){for(var t=new r(this.name+"-copy",this.vertexMap.size(),this.faces.length),e=this.faces.length,i=0;e>i;i++){var n=this.faces[i];t.addFace(n.a,n.b,n.c,n.normal,n.uvA,n.uvB,n.uvC)}return t},_createVertex:function(t,e){var i=new l(t,e);return i},faceOutwards:function(){this.computeCentroid();for(var t=this.faces.length,e=0;t>e;e++){var i=this.faces[e],n=i.getCentroid().sub(this.centroid),r=n.dot(i.normal);0>r&&i.flipVertexOrder()}return this},flipVertexOrder:function(){for(var t=this.faces.length,e=0;t>e;e++){var i=this.faces[e],n=i.a;i.a=i.b,i.b=n,i.normal.invert()}return this},flipYAxis:function(){return this.transform((new o).scaleSelf(1,-1,1)),this.flipVerteAxOrder(),this},getBoundingBox:function(){for(var e=t("../AABB"),i=this,n=h.MAX_VALUE.copy(),r=h.MIN_VALUE.copy(),s=i.vertices.length,o=0;s>o;o++){var a=i.vertices[o];n.minSelf(a),r.maxSelf(a)}return i.bounds=e.fromMinMax(n,r),i.bounds},getBoundingSphere:function(){var e=t("../Sphere"),i=0;this.computeCentroid();for(var r=this.vertices.length,s=0;r>s;s++){var o=this.vertices[s];i=n.max(i,o.distanceToSquared(this.centroid))}var a=new e(this.centroid,Math.sqrt(i));return a},getClosestVertexToPoint:function(t){for(var e,i=Number.MAX_VALUE,n=this.vertices.length,r=0;n>r;r++){var s=this.vertices[r],o=s.distanceToSquared(t);i>o&&(e=s,i=o)}return e},getFaceNormalsAsArray:function(t,e,i){if(0===arguments.length)t=void 0,e=0,i=r.DEFAULT_STRIDE;else if(1==arguments.length&&"object"==typeof arguments[0]){var s=arguments[0];t=s.normals,e=s.offset,i=s.stride}i=n.max(i,3),void 0===t&&(t=[]);for(var o=e,a=this.faces.length,h=0;a>h;h++){var u=this.faces[h];t[o]=u.normal.x,t[o+1]=u.normal.y,t[o+2]=u.normal.z,o+=i,t[o]=u.normal.x,t[o+1]=u.normal.y,t[o+2]=u.normal.z,o+=i,t[o]=u.normal.x,t[o+1]=u.normal.y,t[o+2]=u.normal.z,o+=i}return t},getFaces:function(){return this.faces},getFacesAsArray:function(){for(var t=[],e=0,i=this.faces.length,n=0;i>n;n++){var r=this.faces[n];t[e++]=r.a.id,t[e++]=r.b.id,t[e++]=r.c.id}return t},getIntersectionData:function(){return this.intersector.getIntersectionData()},getMeshAsVertexArray:function(t,e,i){void 0===t&&(t=void 0),void 0===e&&(e=0),void 0===i&&(i=r.DEFAULT_STRIDE),i=n.max(i,3),void 0===t&&(t=[]);for(var s=0,o=this.faces.length,a=0;o>a;++a){var h=this.faces[a];t[s]=h.a.x,t[s+1]=h.a.y,t[s+2]=h.a.z,s+=i,t[s]=h.b.x,t[s+1]=h.b.y,t[s+2]=h.b.z,s+=i,t[s]=h.c.x,t[s+1]=h.c.y,t[s+2]=h.c.z,s+=i}return t},getNumFaces:function(){return this.faces.length},getNumVertices:function(){return this.vertexMap.size()},getRotatedAroundAxis:function(t,e){return this.copy().rotateAroundAxis(t,e)},getRotatedX:function(t){return this.copy().rotateX(t)},getRotatedY:function(t){return this.copy().rotateY(t)},getRotatedZ:function(t){return this.copy().rotateZ(t)},getScaled:function(t){return this.copy().scale(t)},getTranslated:function(t){return this.copy().translate(t)},getUniqueVerticesAsArray:function(){for(var t=[],e=0,i=this.vertices.length,n=0;i>e;n++){var r=this.vertices[n];t[e++]=r.x,t[e++]=r.y,t[e++]=r.z}return t},getVertexAtPoint:function(t){for(var e,i=0;i<this.vertices.length;i++)this.vertices[i].equals(t)&&(e=i);return this.vertices[e]},getVertexIndex:function(t){for(var e=-1,i=this.vertices.length,n=0;i>n;n++){var r=this.vertices[n];r.equals(t)&&(e=n)}return e},getVertexForID:function(t){for(var e,i=this.vertices.length,n=0;i>n;n++){var r=this.vertices[n];if(r.id==t){e=r;break}}return e},getVertexNormalsAsArray:function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=r.DEFAULT_STRIDE),i=n.max(i,3),void 0===t&&(t=[]);for(var s=e,o=this.faces.length,a=0;o>a;a++){var h=this.faces[a];t[s]=h.a.normal.x,t[s+1]=h.a.normal.y,t[s+2]=h.a.normal.z,s+=i,t[s]=h.b.normal.x,t[s+1]=h.b.normal.y,t[s+2]=h.b.normal.z,s+=i,t[s]=h.c.normal.x,t[s+1]=h.c.normal.y,t[s+2]=h.c.normal.z,s+=i}return t},getVertices:function(){return this.vertices},handleSaveAsSTL:function(){throw Error("TriangleMesh.handleSaveAsSTL() currently not implemented")},init:function(t){this.setName(t),this.matrix=new o,this.centroid=new h,this.vertexMap=new e.LinkedMap(i),this.vertices=this.vertexMap.getArray(),this.faces=[],this.uniqueVertexID=0},intersectsRay:function(){throw Error("intersectsRay not yet implemented")},perforateFace:function(t,e){var i=t.getCentroid(),n=1-e,r=t.a.interpolateTo(i,n),s=t.b.interpolateTo(i,n),o=t.c.interpolateTo(i,n);return this.removeFace(t),this.addFace(t.a,s,r),this.addFace(t.a,t.b,s),this.addFace(t.b,o,s),this.addFace(t.b,t.c,o),this.addFace(t.c,r,o),this.addFace(t.c,t.a,r),new u(r,s,o)},pointTowards:function(t,e){return e=e||h.Z_AXIS,this.transform(c.getAlignmentQuat(t,e).toMatrix4x4(this.matrix),!0)},removeFace:function(t){for(var e=-1,i=this.faces.length,n=0;i>n;n++)if(this.faces[n]==t){e=n;break}e>-1&&this.faces.splice(e,1)},rotateAroundAxis:function(t,e){return this.transform(this.matrix.identity().rotateAroundAxis(t,e))},rotateX:function(t){return this.transform(this.matrix.identity().rotateX(t))},rotateY:function(t){return this.transform(this.matrix.identity().rotateY(t))},rotateZ:function(t){return this.transform(this.matrix.identity().rotateZ(t))},saveAsOBJ:function(t,e){void 0===e&&(e=!0);var i=t.getCurrVertexOffset()+1,n=t.getCurrNormalOffset()+1;t.newObject(this.name);var r,s=0,o=0,a=this.vertices.length,h=this.faces.length;for(s=0;a>s;s++)t.vertex(this.vertices[s]);if(e){for(s=0;a>s;s++)t.normal(this.vertices[s].normal);for(o=0;h>o;o++)r=this.faces[o],t.faceWithNormals(r.b.id+i,r.a.id+i,r.c.id+i,r.b.id+n,r.a.id+n,r.c.id+n)}else for(o=0;h>o;o++)r=this.faces[o],t.face(r.b.id+i,r.a.id+i,r.c.id+i)},saveAsSTL:function(){throw Error("TriangleMesh.saveAsSTL() currently not implemented")},scale:function(t){return this.transform(this.matrix.identity().scaleSelf(t))},setName:function(t){return this.name=t,this},toString:function(){return"TriangleMesh: "+this.name+" vertices: "+this.getNumVertices()+" faces: "+this.getNumFaces()},toWEMesh:function(){return new s(this.name).addMesh(this)},transform:function(t,e){void 0===e&&(e=!0);for(var i=this.vertices.length,n=0;i>n;n++){var r=this.vertices[n];r.set(t.applyTo(r))}return e&&this.computeFaceNormals(),this},translate:function(t,e,i){return 1==arguments.length&&(e=t.y,i=t.z,t=t.x),this.transform(this.matrix.identity().translateSelf(t,e,i))},updateVertex:function(t,e){var i=this.vertexMap.get(t);return void 0!==i&&(this.vertexMap.remove(i),i.set(e),this.vertexMap.put(e,i)),this}}}(),function(e){var r,o=t("../../internals"),a=t("../Line3D"),h=t("../Vec3D"),u=t("./Vertex").WEVertex,c=t("./Face").WEFace,l=t("./WingedEdge"),f=t("./subdiv/MidpointSubdivision");s=function(t){t=t||"untitled",e.call(this,t)},s.DEFAULT_NUM_FACES=e.DEFAULT_NUM_FACES,s.DEFAULT_NUM_VERTICES=e.DEFAULT_NUM_VERTICES,o.extend(s,e),r=s.prototype,r.addFace=function(t,e,i,n,r,s,o){6===arguments.length&&(o=s,s=r,r=n,n=void 0);var a,h,u,l=this.__checkVertex(t),f=this.__checkVertex(e),p=this.__checkVertex(i);return l.id===f.id||l.id===p.id||f.id===p.id?console.log("Ignoring invalid face: "+t+","+e+","+i):(void 0!==n&&null!==n&&(a=l.sub(p).crossSelf(l.sub(f)),n.dot(a)<0&&(h=l,l=f,f=h)),u=new c(l,f,p,r,s,o),this.faces.push(u),this.updateEdge(l,f,u),this.updateEdge(f,p,u),this.updateEdge(p,l,u)),this},r.center=function(t,i){e.prototype.center.call(this,t,i),this.rebuildIndex()},r.clear=function(){return e.prototype.clear.call(this),this.edgeMap=new o.LinkedMap(n),this.edges=this.edgeMap.getArray(),this},r.copy=function(){var t,e,i,n=new s(this.name+"-copy");for(e=this.faces.length,t=0;e>t;t++)i=this.faces[t],n.addFace(i.a,i.b,i.c,i.normal,i.uvA,i.uvB,i.uvC);return n},r._createVertex=function(t,e){var i=new u(t,e);return i},r.getNumEdges=function(){return this.edgeMap.size()},r.init=function(t){e.prototype.init.call(this,t),this.edgeMap=new o.LinkedMap(n),this.edges=this.edgeMap.getArray(),this.__edgeCheck=new a(new h,new h),this.__uniqueEdgeID=0},r.rebuildIndex=function(){var t=new o.LinkedMap(i),e=new o.LinkedMap(n);this.vertexMap.each(function(e){t.put(e,e)}),this.edgeMap.each(function(t){e.put(t,t)}),this.vertexMap=t,this.vertices=t.getArray(),this.edgeMap=e,this.edges=e.getArray()},r.removeEdge=function(t){var e=this;t.remove();var i=t.a;0===i.edges.length&&this.vertexMap.remove(i),i=t.b,0===i.edges.length&&this.vertexMap.remove(i),o.each(t.faces,function(t){e.removeFace(t)});var n=this.edgeMap.remove(this.__edgeCheck.set(t.a,t.b));if(n!==t)throw Error("Can't remove edge")},r.removeFace=function(t){var e=this,i=this.faces.indexOf(t);i>-1&&this.faces.splice(i,1),o.each(t.edges,function(i){i.faces.splice(i.faces.indexOf(t),1),0===i.faces.length&&e.removeEdge(i)})},r.removeUnusedVertices=function(){o.each(this.vertices,function(t,e){var i=!1;o.each(this.faces,function(e){return e.a==t||e.b==t||e.c==t?void(i=!0):void 0}),i||this.vertices.splice(e,1)})},r.removeVertices=function(t){o.each(t,function(t){o.each(t.edges,function(t){o.each(t.faces,function(t){this.removeFace(t)})})})},r.splitEdge=function(t,e,i){var n,r;3===arguments.length?n=this.edgeMap.get(this.__edgeCheck.set(t,e)):2==arguments.length&&(n=t,i=e),r=i.computeSplitPoints(n),this.splitFace(n.faces[0],n,r),n.faces.length>1&&this.splitFace(n.faces[1],n,r),this.removeEdge(n)},r.splitFace=function(t,e,i){var n,r,s,o,a,h;for(r=0;3>r;r++)if(s=t.edges[r],!s.equals(e)){n=s.a.equals(e.a)||s.a.equals(e.b)?s.b:s.a;break}for(a=i.length,r=0;a>r;r++)h=i[r],0===r?this.addFace(n,e.a,h,t.normal):this.addFace(n,o,h,t.normal),r===a-1&&this.addFace(n,h,e.b,t.normal),o=h},r.subdivide=function(t,e){1===arguments.length&&(e=t,t=new f),this.subdivideEdges(this.edges.slice(0),t,e)},r.subdivideEdges=function(t,e,i){t.sort(e.getEdgeOrdering()),i*=i;var n=0,r=t.length;for(n=0;r>n;n++){var s=t[n];this.edges.indexOf(s)>-1&&s.getLengthSquared()>=i&&this.splitEdge(s,e)}},r.subdivideFaceEdges=function(t,e,i){var n,r,s,o,a,h,u=[];for(a=this.faces.length,n=0;a>n;n++)for(s=this.faces[n],h=s.edges.length,r=0;h>r;r++)o=s.edges[r],u.indexOf(o)<0&&u.push(o);this.subdividEdges(u,e,i)},r.toString=function(){return"WETriangleMesh: "+this.name+" vertices: "+this.getNumVertices()+" faces: "+this.getNumFaces()+" edges:"+this.getNumEdges()},r.transform=function(t,e){(void 0===e||null===e)&&(e=!0);for(var i=0,n=this.vertices.length;n>i;i++)t.applyToSelf(this.vertices[i]);return this.rebuildIndex(),e&&this.computeFaceNormals(),this},r.updateEdge=function(t,e,i){this.__edgeCheck.set(t,e);var n=this.edgeMap.get(this.__edgeCheck);void 0!==n?n.addFace(i):(n=new l(t,e,i,this.__uniqueEdgeID++),this.edgeMap.put(n,n),t.addEdge(n),e.addEdge(n)),i.addEdge(n)}}(r),function(e){var i=t("../../internals"),n=t("../../math/mathUtils"),r=t("../../math/Interpolation2D"),s=t("../Ray3D"),a=t("../TriangleIntersector"),h=t("../Triangle3D"),u=t("../IsectData3D"),c=t("../vectors").Vec2D,l=t("../vectors").Vec3D;o=function(t,e,n){this.width=t,this._depth=e,i.has.XY(n)||(n=new c(n,n)),this.setScale(n),this.elevation=[];var r=0,s=t*e;for(r=0;s>r;r++)this.elevation[r]=0;this.__elevationLength=this.width*this._depth,this.vertices=[];var o=new l(parseInt(this.width/2,10),0,parseInt(this._depth/2,10)),a=this.getScale().to3DXZ();r=0;for(var h=0;h<this._depth;h++)for(var u=0;u<this.width;u++)this.vertices[r++]=new l(u,0,h).subSelf(o).scaleSelf(a)},o.prototype={getDepth:function(){return this._depth},getElevation:function(){return this.elevation},getHeightAtCell:function(t,e){return this.elevation[this._getIndex(t,e)]},getHeightAtPoint:function(t,e){var i=t/this._scale.x+.5*this.width,s=e/this._scale.y+.5*this._depth,o=0,a={xx:parseInt(i,10),zz:parseInt(s,10)};if(i>=0&i<this.width&&s>=0&&s<this._depth){var h=parseInt(n.min(i+1,this.width-1),10),u=parseInt(n.min(s+1,this._depth-1),10),c=this.getHeightAtCell(a.xx,a.zz),l=this.getHeightAtCell(h,a.zz),f=this.getHeightAtCell(a.xx,u),p=this.getHeightAtCell(h,u);o=r.bilinear(i,s,a.xx,a.zz,h,u,c,l,f,p)}return o},_getIndex:function(t,e){var i=e*this.width+t;if(0>i||i>this.__elevationLength)throw new Error("the given terrain cell is invalid: "+t+";"+e);return i},getScale:function(){return this._scale},getVertexAtCell:function(t,e){return this.vertices[this._getIndex(t,e)]},getWidth:function(){return this.width},intersectAtPoint:function(t,e){var i=t/this._scale.x+.5*this.width,r=e/this._scale.y+.5*this._depth,o=new u;if(i>=0&&i<this.width&&r>=0&&r<this._depth){var c=parseInt(n.min(i+1,this.width-1),10),f=parseInt(n.min(r+1,this._depth-1),10),p={xx:parseInt(i,10),zz:parseInt(r,10)},d=this.getVertexAtCell(p.xx,p.zz),g=this.getVertexAtCell(c,p.zz),m=this.getVertexAtCell(c,f),y=this.getVertexAtCell(p.xx,f),x=new s(new l(t,1e4,e),new l(0,-1,0)),v=new a(new h(d,g,y));v.intersectsRay(x)?o=v.getIntersectionData():(v.setTriangle(new h(g,m,y)),v.intersectsRay(x),o=v.getIntersectionData())}return o},setElevation:function(t){if(this.__elevationLength!=t.length)throw new Error("the given elevation array size does not match terrain");for(var e=0,i=t.length;i>e;e++)this.vertices[e].y=this.elevation[e]=t[e];return this},setHeightAtCell:function(t,e,i){var n=this._getIndex(t,e);return this.elevation[n]=i,this.vertices[n].y=i,this},setScale:function(t){i.has.XY(t)||(t=new c(t,t)),this._scale=t},toMesh:function(){var t={mesh:void 0,minX:0,minZ:0,maxX:this.width,maxZ:this._depth},i=this.vertices,r=this.width,s=this._depth;if(1==arguments.length&&"object"==typeof arguments[0]){var o=arguments[0];t.mesh=o.mesh||new e("terrain"),t.minX=o.minX||t.minX,t.minZ=o.minZ||t.minZ,t.maxX=o.maxX||t.maxX,t.maxZ=o.maxZ||t.maxZ}else arguments.length>=5&&(t.mesh=arguments[0],t.minX=arguments[1],t.minZ=arguments[2],t.maxX=arguments[3],t.maxZ=arguments[4]);t.mesh=t.mesh||new e("terrain"),t.minX=n.clip(t.minX,0,r-1),t.maxX=n.clip(t.maxX,0,r),t.minZ=n.clip(t.minZ,0,s-1),t.maxZ=n.clip(t.maxZ,0,s),t.minX++,t.minZ++;for(var a=t.minZ,h=t.minX*r;a<t.maxZ;a++,h+=r)for(var u=t.minX;u<t.maxX;u++)t.mesh.addFace(i[h-r+u-1],i[h-r+u],i[h+u-1]),t.mesh.addFace(i[h-r+u],i[h+u],i[h+u-1]);return t.mesh}}}(r),function(e){var i=t("../Vec3D"),n=t("../Vec2D");a=function(t){this.func=t},a.prototype={createMesh:function(){var t={mesh:void 0,resolution:0,size:1,isClosed:!0};if(1==arguments.length)if("object"==typeof arguments[0]){var r=arguments[0];t.mesh=r.mesh,t.resolution=r.res||r.resoultion||0,void 0!==r.size&&(t.size=r.size),void 0!==r.isClosed&&(t.isClosed=r.isClosed)}else t.resolution=arguments[0];else arguments.length>2&&(t.mesh=arguments[0],t.resolution=arguments[1],t.size=arguments[2],4==arguments.length&&(t.isClosed=arguments[3]));var s=t.mesh;(void 0===s||null===s)&&(s=new e);for(var o=new i,a=new i,h=new i,u=new i,c=new i,l=new i,f=this.func.getPhiResolutionLimit(t.resolution),p=this.func.getPhiRange(),d=this.func.getThetaResolutionLimit(t.resolution),g=this.func.getThetaRange(),m=1/f,y=1/d,x=1/t.resolution,v=new n,b=new n,w=new n,S=new n,A=0;f>A;A++)for(var C=A*p*x,T=(A+1)*p*x,M=0;d>=M;M++){var z=M*g*x,I=this.func;o=I.computeVertexFor(o,T,z).scaleSelf(t.size),w.set(M*y,1-(A+1)*m),a=I.computeVertexFor(a,C,z).scaleSelf(t.size),S.set(M*y,1-A*m),a.equalsWithTolerance(o,1e-4)&&a.set(o),M>0?(M==d&&t.isClosed&&(o.set(c),a.set(l)),s.addFace(h,u,o,v.copy(),b.copy(),w.copy()),s.addFace(u,a,o,b.copy(),S.copy(),w.copy())):(c.set(o),l.set(a)),h.set(o),u.set(a),v.set(w),b.set(S)}return s},getFunction:function(){return this.func},setFunction:function(t){this.func=t}}}(r),e.TriangleMesh=r,e.WETriangleMesh=s,e.Terrain=o,e.SurfaceMeshBuilder=a}),i("toxi/geom/mesh/TriangleMesh",["require","./meshCommon"],function(t){return t("./meshCommon").TriangleMesh}),i("toxi/geom/mesh/BezierPatch",["require","exports","module","../Vec3D","./TriangleMesh","../../internals/is"],function(t,e,i){var n=t("../Vec3D"),r=t("./TriangleMesh"),s=t("../../internals/is"),o=function(t){if(s.Array(t))this.points=t;else{this.points=[];for(var e=0;4>e;e++){this.points[e]=this.points[e]||[];for(var i=0;4>i;i++)this.points[e][i]=new n}}};o.prototype={computePointAt:function(t,e){return o.computePointAt(t,e,this.points)},set:function(t,e,i){return this.points[e][t].set(i),this},toMesh:function(t,e){var i,n;void 0===e?(i=new r,n=t):(i=t,n=e);for(var s=new Array(n+1),o=new Array(n+1),a=1/n,h=0;n>=h;h++){for(var u=0;n>=u;u++){var c=this.computePointAt(u*a,h*a,this.points);u>0&&h>0&&(i.addFace(c,s[u-1],o[u-1]),i.addFace(c,o[u-1],o[u])),s[u]=c}var l=o;o=s,s=l}return i}},o.computePointAt=function(t,e,i){var r=1-t,s=r*r*3*t,o=r*r*r,a=t*t,h=1-e,u=e*e*3,c=h*h*3,l=h*h*h,f=e*e*e,p=r*a*3,d=t*a,g=h*u,m=c*e,y=i[0],x=i[1],v=i[2],b=i[3],w=o*(y[0].x*l+y[1].x*m+y[2].x*g+y[3].x*f)+s*(x[0].x*l+x[1].x*m+x[2].x*g+x[3].x*f)+p*(v[0].x*l+v[1].x*m+v[2].x*g+v[3].x*f)+d*(b[0].x*l+b[1].x*m+b[2].x*g+b[3].x*f),S=o*(y[0].y*l+y[1].y*m+y[2].y*g+y[3].y*f)+s*(x[0].y*l+x[1].y*m+x[2].y*g+x[3].y*f)+p*(v[0].y*l+v[1].y*m+v[2].y*g+v[3].y*f)+d*(b[0].y*l+b[1].y*m+b[2].y*g+b[3].y*f),A=o*(y[0].z*l+y[1].z*m+y[2].z*g+y[3].z*f)+s*(x[0].z*l+x[1].z*m+x[2].z*g+x[3].z*f)+p*(v[0].z*l+v[1].z*m+v[2].z*g+v[3].z*f)+d*(b[0].z*l+b[1].z*m+b[2].z*g+b[3].z*f);return new n(w,S,A)},i.exports=o}),i("toxi/geom/mesh/VertexSelector",["require","exports","module"],function(t,e,i){var n=function(t){this.mesh=t,this.selection=[]};n.prototype={addSelection:function(t){return this.checkMeshIdentity(t.getMesh()),this.selection=this.selection.concat(t.getSelection()),this},checkMeshIdentity:function(t){if(t!=this.mesh)throw new Error("The given selector is not using the same mesh instance")},clearSelection:function(){return this.selection=[],this},getMesh:function(){return this.mesh},getSelection:function(){return this.selection},invertSelection:function(){for(var t=[],e=this.mesh.getVertices(),i=e.length,n=0;i>n;n++){var r=e[n];this.selection.indexOf(r)<0&&t.push(r)}return this.selection=t,this},selectSimilar:function(t){for(var e=t.length,i=0;e>i;i++){var n=t[i];this.selection.push(this.mesh.getClosestVertexToPoint(n))}return this},selectVertices:function(){return this},setMesh:function(t){this.mesh=t,this.clearSelection()},size:function(){return this.selection.length},subtractSelection:function(t){this.checkMeshIdentity(t.getMesh());var e,i=t.getSelection(),n=i.length;for(e=0;n>e;e++)this.selection.splice(this.selection.indexOf(i[e]),1);return this}},i.exports=n}),i("toxi/geom/mesh/BoxSelector",["require","exports","module","../../internals","./VertexSelector"],function(t,e,i){var n=t("../../internals").extend,r=t("./VertexSelector"),s=function(t,e){r.apply(this,[t]),this.box=e};n(s,r),s.prototype.selectVertices=function(){this.clearSelection();for(var t=this.mesh.getVertices(),e=t.length,i=0;e>i;i++){var n=t[i];this.box.containsPoint(n)&&this.selection.add(n)}return this},i.exports=s}),i("toxi/geom/mesh/DefaultSelector",["require","exports","module","../../internals","./VertexSelector"],function(t,e,i){var n=t("../../internals").extend,r=t("./VertexSelector"),s=function(t){r.call(this,t)};n(s,r),s.prototype.selectVertices=function(){return this.clearSelection(),this.selection=this.selection.concat(this.mesh.getVertices()),this},i.exports=s}),i("toxi/geom/mesh/OBJWriter",["../../internals"],function(t){var e=function(){this.buffer=[]};e.prototype.append=function(t){return this.buffer.push(t),this},e.prototype.toString=function(){return this.buffer.join("")};var i=function(){this.VERSION="0.3",this.__stringBuffer=new e,this.objStream=void 0,this.__filename="objwriter.obj",this._numVerticesWritten=0,this._numNormalsWritten=0};return i.prototype={beginSave:function(e){"string"==typeof e||t.hasProperties(e,["write","end","writable"]&&e.writable)&&(this.objStream=e),this._handleBeginSave()},endSave:function(){if(void 0!==this.objStream)try{this.objStream.destroy()
}catch(t){}},face:function(t,e,i){this.__stringBuffer.append("f "+t+" "+e+" "+i+"\n")},faceList:function(){this.__stringBuffer.append("s off \n")},faceWithNormals:function(t,e,i,n,r,s){this.__stringBuffer.append("f "+t+"//"+n+" "+e+"//"+r+" "+i+"//"+s+"\n")},getCurrNormalOffset:function(){return this._numNormalsWritten},getCurrVertexOffset:function(){return this._numVerticesWritten},getOutput:function(){return this.__stringBuffer.toString()},_handleBeginSave:function(){this.numVerticesWritten=0,this.numNormalsWrittern=0,this.__stringBuffer.append("# generated by OBJExport (js) v"+this.VERSION+"\n")},newObject:function(t){this.__stringBuffer.append("o "+t+"\n")},normal:function(t){this.__stringBuffer.append("vn "+t.x+" "+t.y+" "+t.z+"\n"),this._numNormalsWritten++},vertex:function(t){this.__stringBuffer.append("v "+t.x+" "+t.y+" "+t.z+"\n"),this._numVerticesWritten++}},i}),i("toxi/geom/mesh/PlaneSelector",["require","exports","module","../../internals","./VertexSelector"],function(t,e,i){var n=t("../../internals").extend,r=t("./VertexSelector"),s=function(t,e,i,n){r.apply(this,[t]),this.plane=e,this.classifier=i,this.tolerances=void 0===n?1e-4:n};n(s,r),s.prototype.selectVertices=function(){this.clearSelection();for(var t=this.mesh.getVertices(),e=t.length,i=0;e>i;i++){var n=t[i];this.plane.classifyPoint(n,this.tolerance)==this.classifier&&this.selection.add(n)}return this},i.exports=s}),i("toxi/geom/mesh/SphereFunction",["require","../Sphere"],function(t){return t("../Sphere").SphereFunction}),i("toxi/geom/mesh/SphericalHarmonics",["require","exports","module","../../math/mathUtils"],function(t,e,i){var n=t("../../math/mathUtils"),r=function(t){this.m=t};r.prototype={computeVertexFor:function(t,e,i){var r=0;r+=Math.pow(n.sin(this.m[0]*i),this.m[1]),r+=Math.pow(n.cos(this.m[2]*i),this.m[3]),r+=Math.pow(n.sin(this.m[4]*e),this.m[5]),r+=Math.pow(n.cos(this.m[6]*e),this.m[7]);var s=n.sin(i);return t.x=r*s*n.cos(e),t.y=r*n.cos(i),t.z=r*s*n.sin(e),t},getPhiRange:function(){return n.TWO_PI},getPhiResolutionLimit:function(t){return t},getThetaRange:function(){return n.PI},getThetaResolutionLimit:function(t){return t}},i.exports=r}),i("toxi/geom/mesh/SurfaceMeshBuilder",["require","./meshCommon"],function(t){return t("./meshCommon").SurfaceMeshBuilder}),i("toxi/geom/mesh/SuperEllipsoid",["require","exports","module","../../math/mathUtils","./TriangleMesh"],function(t,e,i){var n=t("../../math/mathUtils"),r=(t("./TriangleMesh"),function(t,e){this.p1=t,this.p2=e});r.prototype={computeVertexFor:function(t,e,i){e-=n.HALF_PI;var r=n.cos(e),s=n.cos(i),o=n.sin(e),a=n.sin(i),h=n.sign(r)*Math.pow(n.abs(r),this.p1);return t.x=h*n.sign(s)*Math.pow(Math.abs(s),this.p2),t.y=n.sign(o)*Math.pow(Math.abs(o),this.p1),t.z=h*n.sign(a)*Math.pow(n.abs(a),this.p2),t},getPhiRange:function(){return n.TWO_PI},getPhiResolutionLimit:function(t){return t/2},getThetaRange:function(){return n.TWO_PI},getThetaResolutionLimit:function(t){return t}},i.exports=r}),i("toxi/geom/mesh/Terrain",["require","./meshCommon"],function(t){return t("./meshCommon").Terrain}),i("toxi/geom/mesh/WETriangleMesh",["require","./meshCommon"],function(t){return t("./meshCommon").WETriangleMesh}),i("toxi/geom/mesh",["require","exports","module","./mesh/TriangleMesh","./mesh/BezierPatch","./mesh/BoxSelector","./mesh/DefaultSelector","./mesh/Face","./mesh/OBJWriter","./mesh/PlaneSelector","./mesh/SphereFunction","./mesh/SphericalHarmonics","./mesh/SurfaceMeshBuilder","./mesh/SuperEllipsoid","./mesh/Terrain","./mesh/TriangleMesh","./mesh/Vertex","./mesh/VertexSelector","./mesh/WETriangleMesh"],function(t,e){e.TriangleMesh=t("./mesh/TriangleMesh"),e.BezierPatch=t("./mesh/BezierPatch"),e.BoxSelector=t("./mesh/BoxSelector"),e.DefaultSelector=t("./mesh/DefaultSelector"),e.Face=t("./mesh/Face"),e.OBJWriter=t("./mesh/OBJWriter"),e.PlaneSelector=t("./mesh/PlaneSelector"),e.SphereFunction=t("./mesh/SphereFunction"),e.SphericalHarmonics=t("./mesh/SphericalHarmonics"),e.SurfaceMeshBuilder=t("./mesh/SurfaceMeshBuilder"),e.SuperEllipsoid=t("./mesh/SuperEllipsoid"),e.Terrain=t("./mesh/Terrain"),e.TriangleMesh=t("./mesh/TriangleMesh"),e.Vertex=t("./mesh/Vertex"),e.VertexSelector=t("./mesh/VertexSelector"),e.WETriangleMesh=t("./mesh/WETriangleMesh")}),i("toxi/geom/BernsteinPolynomial",["require","exports","module"],function(t,e,i){var n=function(t){this.resolution=t;for(var e=[],i=[],n=[],r=[],s=0,o=1/(t-1),a=0;t>a;a++){var h=1-s,u=h*h,c=s*s;e[a]=h*u,i[a]=3*s*u,n[a]=3*c*h,r[a]=s*c,s+=o}this.b0=e,this.b1=i,this.b2=n,this.b3=r};i.exports=n}),i("toxi/geom/Ray2D",["require","exports","module","../internals","./Vec2D","./Line2D"],function(t,e,i){var n=t("../internals").extend,r=t("./Vec2D"),s=(t("./Line2D"),function(t,e,i){3==arguments.length?(r.apply(this,[t,e]),this.dir=i.getNormalized()):2==arguments.length?(r.apply(this,[t]),this.dir=e.getNormalized()):0===arguments.length&&(r.apply(this),this.dir=r.Y_AXIS.copy())});n(s,r),s.prototype.getDirection=function(){return this.dir.copy()},s.prototype.getDistanceToPoint=function(t){var e=t.sub(this);return e.distanceTo(this.dir.scale(e.dot(this.dir)))},s.prototype.getPointAtDistance=function(t){return this.add(this.dir.scale(t))},s.prototype.setDirection=function(t){return this.dir.set(t).normalize(),this},s.prototype.toLine2DWithPointAtDistance=function(e){var i=t("./Line2D");return new i(this,this.getPointAtDistance(e))},s.prototype.toString=function(){return"origin: "+r.prototype.toString.apply(this)+" dir: "+this.dir},i.exports=s}),i("toxi/geom/Line2D",["require","exports","module","./Ray2D","../internals"],function(t,e,i){var n=(t("./Ray2D"),t("../internals")),r=function(t,e){this.a=t,this.b=e};r.prototype={closestPointTo:function(t){var e=this.b.sub(this.a),i=t.sub(this.a).dot(e)/e.magSquared();return 0>i?this.a.copy():i>1?this.b.copy():this.a.add(e.scaleSelf(i))},copy:function(){return new r(this.a.copy(),this.b.copy())},equals:function(t){if(this==t)return!0;if(!n.is.Line2D(t))return!1;var e=t;return(this.a.equals(e.a)||this.a.equals(e.b))&&(this.b.equals(e.b)||this.b.equals(e.a))},getDirection:function(){return this.b.sub(this.a).normalize()},getLength:function(){return this.a.distanceTo(this.b)},getLengthSquared:function(){return this.a.distanceToSquared(this.b)},getMidPoint:function(){return this.a.add(this.b).scaleSelf(.5)},getNormal:function(){return this.b.sub(this.a).perpendicular()},getTheta:function(){return this.a.angleBetween(this.b,!0)},hasEndPoint:function(t){return this.a.equals(t)||this.b.equals(t)},intersectLine:function(t){var e,i=(t.b.y-t.a.y)*(this.b.x-this.a.x)-(t.b.x-t.a.x)*(this.b.y-this.a.y),n=(t.b.x-t.a.x)*(this.a.y-t.a.y)-(t.b.y-t.a.y)*(this.a.x-t.a.x),s=(this.b.x-this.a.x)*(this.a.y-t.a.y)-(this.b.y-this.a.y)*(this.a.x-t.a.x);if(0!==i){var o=n/i,a=s/i;e=o>=0&&1>=o&&a>=0&&1>=a?new r.LineIntersection(r.LineIntersection.Type.INTERSECTING,this.a.interpolateTo(this.b,o)):new r.LineIntersection(r.LineIntersection.Type.NON_INTERSECTING,void 0)}else e=0===n&&0===s?new r.LineIntersection(r.LineIntersection.Type.COINCIDENT,void 0):new r.LineIntersection(r.LineIntersection.Type.COINCIDENT,void 0);return e},offsetAndGrowBy:function(t,e,i){var n=this.getMidPoint(),r=this.getDirection(),s=r.getPerpendicular();return void 0!==i&&n.sub(i).dot(s)<0&&s.invert(),s.normalizeTo(t),this.a.addSelf(s),this.b.addSelf(s),r.scaleSelf(e),this.a.subSelf(r),this.b.addSelf(r),this},scale:function(t){var e=.5*(1-t),i=this.a.interpolateTo(this.b,e);return this.b.interpolateToSelf(this.a,e),this.a.set(i),this},set:function(t,e){return this.a=t,this.b=e,this},splitIntoSegments:function(t,e,i){return r.splitIntoSegments(this.a,this.b,e,t,i)},toRay2D:function(){var e=t("./Ray2D");return new e(this.a.copy(),this.b.sub(this.a).normalize())}},r.splitIntoSegments=function(t,e,i,n,r){void 0===n&&(n=[]),r&&n.push(t.copy());var s=t.distanceTo(e);if(s>i)for(var o=t.copy(),a=e.sub(t).limit(i);s>i;)o.addSelf(a),n.push(o.copy()),s-=i;return n.push(e.copy()),n},r.LineIntersection=function(t,e){this.type=t,this.pos=e},r.LineIntersection.prototype={getPos:function(){return this.pos.copy()},getType:function(){return this.type},toString:function(){return"type: "+this.type+" pos: "+this.pos}},r.LineIntersection.Type={COINCIDENT:0,PARALLEL:1,NON_INTERSECTING:2,INTERSECTING:3},i.exports=r}),i("toxi/geom/Rect",["require","exports","module","../internals","./Vec2D","./Line2D","./Polygon2D"],function(t,e,i){var n=t("../internals"),r=t("../math/mathUtils"),s=t("./Vec2D"),o=t("./Line2D"),a=(t("./Polygon2D"),function(t,e,i,r){if(2==arguments.length){if(!n.has.XY(t))throw new Error("Rect received incorrect parameters");this.x=t.x,this.y=t.y,this.width=e.x-this.x,this.height=e.y-this.y}else if(4==arguments.length)this.x=t,this.y=e,this.width=i,this.height=r;else if(1==arguments.length){var s=arguments[0];n.has.XYWidthHeight(s)&&(this.x=s.x,this.y=s.y,this.width=s.width,this.height=s.height)}else if(arguments.length>0)throw new Error("Rect received incorrect parameters")});a.fromCenterExtent=function(t,e){return new a(t.sub(e),t.add(e))},a.getBoundingRect=function(t){for(var e=t[0],i=new a(e.x,e.y,0,0),n=1,r=t.length;r>n;n++)i.growToContainPoint(t[n]);return i},a.prototype={containsPoint:function(t){var e=t.x,i=t.y;return e<this.x||e>=this.x+this.width?!1:i<this.y||i>=this.y+this.height?!1:!0},copy:function(){return new a(this.x,this.y,this.width,this.height)},getArea:function(){return this.width*this.height},getAspect:function(){return this.width/this.height},getBottom:function(){return this.y+this.height},getBottomRight:function(){return new s(this.x+this.width,this.y+this.height)},getCentroid:function(){return new s(this.x+.5*this.width,this.y+.5*this.height)},getDimensions:function(){return new s(this.width,this.height)},getEdge:function(t){var e;switch(t){case 0:e=new o(new s(this.x,this.y),new s(this.x+this.width,this.y));break;case 1:e=new o(new s(this.x+this.width,this.y),new s(this.x+this.width,this.y+this.height));break;case 2:e=new o(new s(this.x,this.y+this.height),new s(this.x+this.width,this.y+this.height));break;case 3:e=new o(new s(this.x,this.y),new s(this.x,this.y+this.height));break;default:throw new Error("edge ID needs to be 0...3")}return e},getLeft:function(){return this.x},getRight:function(){return this.x+this.width},getTop:function(){return this.y},getTopLeft:function(){return new s(this.x,this.y)},growToContainPoint:function(t){return this.containsPoint(t)||(t.x<this.x?(this.width=this.getRight()-t.x,this.x=t.x):t.x>this.getRight()&&(this.width=t.x-this.x),t.y<this.y?(this.height=this.getBottom()-t.y,this.y=t.y):t.y>this.getBottom()&&(this.height=t.y-this.y)),this},intersectsRay:function(t,e,i){var n=t.getDirection().reciprocal(),r=n.x<0,s=n.y<0,o=this.getTopLeft(),a=this.getBottomRight(),h=r?a:o,u=(h.x-t.x)*n.x;h=r?o:a;var c=(h.x-t.x)*n.x;h=s?a:o;var l=(h.y-t.y)*n.y;h=s?o:a;var f=(h.y-t.y)*n.y;return u>f||l>c?void 0:(l>u&&(u=l),c>f&&(c=f),i>u&&c>e?t.getPointAtDistance(u):void 0)},intersectsRect:function(t){return!(this.x>t.x+t.width||this.x+this.width<t.x||this.y>t.y+t.height||this.y+this.height<t.y)},scale:function(t){var e=this.getCentroid();return this.width*=t,this.height*=t,this.x=e.x-.5*this.width,this.y=e.y-.5*this.height,this},set:function(t,e,i,n){if(-1==arguments.length)this.y=t.y,this.width=t.width,this.height=t.height,this.x=t.x;else{if(4!==arguments.length)throw new Error("Rect set() received wrong parameters");this.x=t,this.y=e,this.width=i,this.height=n}},setDimensions:function(t){return 2==arguments.length&&(t={x:arguments[0],y:arguments[1]}),this.width=t.x,this.height=t.y,this},setPosition:function(t){return this.x=t.x,this.y=t.y,this},toPolygon2D:function(){var e=t("./Polygon2D"),i=new e;return i.add(new s(this.x,this.y)),i.add(new s(this.x+this.width,this.y)),i.add(new s(this.x+this.width,this.y+this.height)),i.add(new s(this.x,this.y+this.height)),i},toString:function(){return"rect: {x: "+this.x+", y: "+this.y+", width: "+this.width+", height: "+this.height+"}"},union:function(t){var e=r.max(this.x+this.width,t.x+t.width);return this.x=r.min(this.x,t.x),this.width=e-this.x,e=r.max(this.y+this.height,t.y+t.height),this.y=r.min(this.y,t.y),this.height=e-this.y,this}},i.exports=a}),i("toxi/geom/Polygon2D",["require","exports","module","./Vec2D","./Line2D","./Circle","./Rect","../internals"],function(t,e,i){var n=t("../internals"),r=t("../math/mathUtils"),s=t("./Vec2D"),o=t("./Circle"),a=(t("./Rect"),t("./Line2D")),h=function(){this.vertices=[];var t,e;if(arguments.length>1)for(t=0,e=arguments.length;e>t;t++)this.add(arguments[t].copy());else if(1==arguments.length){var i=arguments[0];if(n.is.Array(i))for(t=0,e=i.length;e>t;t++)this.add(i[t].copy())}};h.prototype={constructor:h,add:function(t){this.vertices.indexOf(t)<0&&this.vertices.push(t)},center:function(t){for(var e=this.getCentroid(),i=void 0!==t?t.sub(e):e.invert(),n=0,r=this.vertices.length;r>n;n++)this.vertices[n].addSelf(i);return this},containsPoint:function(t){var e=this.vertices.length,i=0,n=e-1,r=!1,s=t.x,o=t.y;for(i=0;e>i;i++){var a=this.vertices[i],h=this.vertices[n];(a.y<o&&h.y>=o||h.y<o&&a.y>=o)&&a.x+(o-a.y)/(h.y-a.y)*(h.x-a.x)<s&&(r=!r),n=i}return r},containsPolygon:function(t){for(var e=0,i=t.vertices.length;i>e;e++)if(!this.containsPoint(t.vertices[e]))return!1;return!0},copy:function(){return new h(this.vertices)},flipVertexOrder:function(){return this.vertices.reverse(),this},get:function(t){return 0>t&&(t+=this.vertices.length),this.vertices[t]},getApothem:function(){return this.vertices[0].interpolateTo(this.vertices[1],.5).distanceTo(this.getCentroid())},getArea:function(){for(var t=0,e=this.vertices.length,i=0;e>i;i++){var n=this.vertices[i],r=this.vertices[(i+1)%e];t+=n.x*r.y,t-=n.y*r.x}return t*=.5},getBoundingCircle:function(){var e=t("./Circle");return e.newBoundingCircle(this.vertices)},getBounds:function(){var e=t("./Rect");return e.getBoundingRect(this.vertices)},getCentroid:function(){for(var t=new s,e=this.vertices.length,i=0;e>i;i++){var n=this.vertices[i],r=this.vertices[(i+1)%e],o=n.x*r.y-r.x*n.y;t.x+=(n.x+r.x)*o,t.y+=(n.y+r.y)*o}return t.scale(1/(6*this.getArea()))},getCircumference:function(){for(var t=0,e=0,i=this.vertices.length;i>e;e++)t+=this.vertices[e].distanceTo(this.vertices[(e+1)%i]);return t},getClosestPointTo:function(t){for(var e,i,n,r=Number.MAX_VALUE,s=this.getEdges(),o=0,a=s.length;a>o;o++)i=s[o].closestPointTo(t),n=i.distanceToSquared(t),r>n&&(e=i,r=n);return e},getClosestVertexTo:function(t){for(var e,i,n=Number.MAX_VALUE,r=0,s=this.vertices.length;s>r;r++)i=this.vertices[r].distanceToSquared(t),n>i&&(e=this.vertices[r],n=i);return e},getEdges:function(){for(var t=this.vertices.length,e=[],i=0;t>i;i++)e[i]=new a(this.vertices[i],this.vertices[(i+1)%t]);return e},getNumPoints:function(){return this.getNumVertices()},getNumVertices:function(){return this.vertices.length},getRandomPoint:function(){for(var t,e=this.getEdges(),i=e.length,n=e[r.random(i)];void 0===t||t.equals(n);)t=e[r.random(i)];var s=n.a.interpolateTo(n.b,Math.random());return s.interpolateToSelf(t.a.interpolateTo(t.b,Math.random()),Math.random())},increaseVertexCount:function(t){for(var e,i,n=this.vertices.length,r=0,s=0,o=0;t>n;){for(r=0,s=0,o=0;n>o;o++)e=this.vertices[o].distanceToSquared(this.vertices[(o+1)%n]),e>s&&(r=o,s=e);i=this.vertices[r].add(this.vertices[(r+1)%n]).scaleSelf(.5),this.vertices.splice(r+1,0,i),n++}return this},intersectsPolygon:function(t){for(var e,i,n,r=a.LineIntersection.Type,s=this.getEdges(),o=t.getEdges(),h=0,u=s.length,c=0,l=o.length;u>h;h++)for(e=s[h],c=0;l>c;c++)if(i=o[c],n=e.intersectLine(i).getType(),n===r.INTERSECTING||n==r.COINCIDENT)return!0;return!1},isClockwise:function(){var t=function(t,e,i){var n=(e.x-t.x)*(i.y-t.y)-(i.x-t.x)*(e.y-t.y);return 0>n};return this.vertices.length>2?t(this.vertices[0],this.vertices[1],this.vertices[2]):!1},intersectsPoly:function(t){if(this.containsPolygon(t))return!0;for(var e=this.getEdges(),i=t.getEdges(),n=0,r=e.length;r>n;n++)for(var s=0,o=i.length,h=e[n];o>s;s++)if(h.intersectLine(i[s]).getType()==a.LineIntersection.Type.INTERSECTING)return!0;return!1},removeDuplicates:function(t){for(var e,i,n,r=t?"equalsWithTolerance":"equals",s=0,o=this.vertices.length;o>s;s++)e=this.vertices[s],e[r](i,t)?(this.vertices.splice(s,1),s--,o--):i=e;return o=this.vertices.length,o>0&&(n=this.vertices[o-1],n[r](this.vertices[0],t)&&this.vertices.splice(o-1,1)),this},rotate:function(t){for(var e=0,i=this.vertices.length;i>e;e++)this.vertices[e].rotate(t)},scale:function(){var t,e;if(1==arguments.length){var i=arguments[0];n.has.XY(i)?(t=i.x,e=i.y):(t=i,e=i)}else{if(2!=arguments.length)throw"Invalid argument(s) passed.";t=arguments[0],e=arguments[1]}for(var r=0,s=this.vertices.length;s>r;r++)this.vertices[r].scaleSelf(t,e);return this},translate:function(){var t,e;if(1==arguments.length&&n.has.XY(arguments[0]))t=arguments[0].x,e=arguments[0].y;else{if(2!=arguments.length)throw"Invalid argument(s) passed.";t=arguments[0],e=arguments[1]}for(var i=0,r=this.vertices.length;r>i;i++)this.vertices[i].addSelf(t,e);return this},smooth:function(t,e){for(var i=this.getCentroid(),n=this.vertices.length,r=[],s=0,o=n-1,a=1;n>s;s++){var h=this.vertices[s],u=this.vertices[o].sub(h).addSelf(this.vertices[a].sub(h)).addSelf(h.sub(i).scaleSelf(e));r.push(h.add(u.scaleSelf(t))),o++,o==n&&(o=0),a++,a==n&&(a=0)}return this.vertices=r,this},toString:function(){for(var t="",e=0;e<this.vertices.length;e++)t+=this.vertices[e],e<this.vertices.length-1&&(t+=", ");return t}},h.fromBaseEdge=function(t,e,i){for(var n,s=-(r.PI-r.PI*(i-2)/i),o=e.sub(t),a=e,u=new h(t,e),c=0;i-1>c;c++)n=a.add(o.getRotated(s*c)),u.add(n),a=n;return u},h.fromEdgeLength=function(t,e){return new o(h.getRadiusForEdgeLength(t,e)).toPolygon2D(e)},h.getRadiusForEdgeLength=function(t,e){return t/(2*r.sin(r.PI/e))},i.exports=h}),i("toxi/geom/Ellipse",["require","exports","module","../internals/extend","../internals/has","../internals/is","../math/mathUtils","./Vec2D","./Polygon2D"],function(t,e,i){{var n,r,s=t("../internals/extend"),o=t("../internals/has"),a=t("../internals/is"),h=t("../math/mathUtils"),u=t("./Vec2D");t("./Polygon2D")}n=function(t,e,i,n){this.radius=new u,0===arguments.length?(u.apply(this,[0,0]),this.setRadii(1,1)):o.XY(t)?(u.apply(this,[t.x,t.y]),o.XY(e)?this.setRadii(e.x,e.y):this.setRadii(e,i)):void 0===n?void 0===i?(u.call(this,0,0),this.setRadii(t,e)):(u.call(this,t,e),this.setRadii(i,i)):(u.call(this,t,e),this.setRadii(i,n))},s(n,u),n.prototype.containsPoint=function(t){var e=this.getFoci();return t.distanceTo(e[0])+t.distanceTo(e[1])<2*h.max(this.radius.x,this.radius.y)},n.prototype.getArea=function(){return h.PI*this.radius.x*this.radius.y},n.prototype.getCircumference=function(){return Math.sqrt(.5*this.radius.magSquared())*h.TWO_PI},n.prototype.getFoci=function(){var t=[];return this.radius.x>this.radius.y?(t[0]=this.sub(this.focus,0),t[1]=this.add(this.focus,0)):(t[0]=this.sub(0,this.focus),t[1]=this.add(0,this.focus)),t},n.prototype.getRadii=function(){return this.radius.copy()},n.prototype.setRadii=function(t,e){return o.XY(t)&&(e=t.y,t=t.x),this.radius.set(t,e),this.focus=this.radius.magnitude(),this},n.prototype.toPolygon2D=function(e){for(var i=t("./Polygon2D"),n=new i,r=h.TWO_PI/e,s=0;e>s;s++){var o=u.fromTheta(s*r).scaleSelf(this.radius).addSelf(this);n.add(o)}return n},e=i.exports=n,r=function(t,e,i){1==arguments.length?a.Circle(t)?n.apply(this,[t,t.radius.x]):n.apply(this,[0,0,t]):2==arguments.length?n.apply(this,[t,e]):n.apply(this,[t,e,i,i])},s(r,n),r.from2Points=function(t,e){var i=t.interpolateTo(e,.5),n=i.distanceTo(t);return new r(i,n)},r.from3Points=function(t,e,i){var n,s,o,a=e.sub(t),c=i.sub(e);if(h.abs(a.x)<=1e-7&&h.abs(c.y)<=1e-7)s=new u(e.x+i.x,t.y+e.y).scaleSelf(.5),o=s.distanceTo(t),n=new r(s,o);else{var l=a.y/a.x,f=c.y/c.x;if(h.abs(l-f)>1e-7&&0!==l){var p=(l*f*(t.y-i.y)+f*(t.x+e.x)-l*(e.x+i.x))/(2*(f-l)),d=-(p-(t.x+e.x)/2)/l+(t.y+e.y)/2;s=new u(p,d),o=s.distanceTo(t),n=new r(s,o)}}return n},r.newBoundingCircle=function(t){for(var e=new u,i=0,n=0,s=t.length;s>n;n++)e.addSelf(t[n]);for(e.scaleSelf(1/t.length),n=0;s>n;n++){var o=e.distanceToSquared(t[n]);o>i&&(i=o)}return new r(e,Math.sqrt(i))},r.prototype.containsPoint=function(t){return this.distanceToSquared(t)<=this.radius.x*this.radius.x},r.prototype.getCircumference=function(){return h.TWO_PI*this.radius.x},r.prototype.getRadius=function(){return this.radius.x},r.prototype.getTangentPoints=function(t){var e=this.interpolateTo(t,.5);return this.intersectsCircle(new r(e,e.distanceTo(t)))},r.prototype.intersectsCircle=function(t){var e,i=t.sub(this),n=i.magnitude(),r=this.radius.x,s=t.radius.x;if(r+s>=n&&n>=Math.abs(r-s)){var o=(r*r-s*s+n*n)/(2*n);n=1/n;var a=this.add(i.scale(o*n)),h=Math.sqrt(r*r-o*o);i.perpendicular().scaleSelf(h*n);var u=a.add(i),c=a.sub(i);e=[u,c]}return e},r.prototype.setRadius=function(t){return this.setRadii(t,t),this},e.Circle=r}),i("toxi/geom/Circle",["require","exports","module","./Ellipse"],function(t,e,i){i.exports=t("./Ellipse").Circle}),i("toxi/geom/CircleIntersector",["require","exports","module"],function(t,e,i){var n=function(t){this.circle=t,this.isec=void 0};n.prototype={getIntersectionData:function(){return this.isec},intersectsRay:function(t){this.isec.clear();var e=circle.sub(t),i=e.magSquared(),n=e.dot(t.getDirection()),r=circle.getRadius(),s=r*r-(i-n*n);return s>=0&&(this.isec.isIntersection=!0,this.isec.dist=n-Math.sqrt(s),this.isec.pos=t.getPointAtDistance(isec.dist),this.isec.normal=this.isec.pos.sub(this.circle).normalize()),this.isec.isIntersection}},i.exports=n}),i("toxi/geom/Cone",["require","exports","module","../internals","./Vec3D","./mesh/TriangleMesh"],function(t,e,i){function n(t){throw Error("Missing parameter: "+t)}var r=t("../internals").extend,s=t("./Vec3D"),o=t("./mesh/TriangleMesh"),a=function(t,e,i,r,o){function a(t,e,i,n,r){s.apply(h,[t]),h.dir=e.getNormalized(),h.radiusNorth=i,h.radiusSouth=n,h.length=r}var h=this;"object"==typeof t&&1===arguments.length?a(t.pos||t.position||new s,t.dir||t.direction||n("direction"),t.rNorth||t.radiusNorth||n("radiusNorth"),t.rSouth||t.radiusSouth||n("radiusSouth"),t.len||t.length||n("length")):a(t,e,i,r,o)};r(a,s),a.prototype.toMesh=function(){var t={mesh:void 0,steps:0/0,thetaOffset:0,topClosed:!0,bottomClosed:!0};if(1==arguments.length)if("object"==typeof arguments[0]){var e=arguments[0];t.mesh=e.mesh,t.steps=e.steps||e.resolution||e.res,t.thetaOffset=e.thetaOffset||t.thetaOffset,t.topClosed=e.topClosed||t.topClosed,t.bottomClosed=e.bottomClosed||t.bottomClosed}else t.steps=arguments[0];else 2==arguments.length?(t.steps=arguments[0],t.thetaOffset=arguments[1]):5==arguments.length&&(t.mesh=arguments[0],t.steps=arguments[1],t.thetaOffset=arguments[2],t.topClosed=arguments[3],t.bottomClosed=arguments[4]);var i=this.add(.01,.01,.01),n=i.cross(this.dir.getNormalized()).normalize(),r=this.dir.scale(.5*this.length),s=this.sub(r),a=this.add(r),h=[],u=[],c=2*Math.PI/t.steps,l=0,f=1;for(l=0;l<t.steps;l++){var p=l*c+t.thetaOffset,d=n.getRotatedAroundAxis(this.dir,p);h[l]=d.scale(this.radiusSouth).addSelf(s),u[l]=d.scale(this.radiusNorth).addSelf(a)}var g=2*t.steps+2,m=2*t.steps+(t.topClosed?t.steps:0)+(t.bottomClosed?t.steps:0),y=t.mesh||new o("cone",g,m);for(l=0;l<t.steps;l++,f++)f==t.steps&&(f=0),y.addFace(h[l],u[l],h[f],void 0,void 0,void 0,void 0),y.addFace(h[f],u[l],u[f],void 0,void 0,void 0,void 0),t.bottomClosed&&y.addFace(s,h[l],h[f],void 0,void 0,void 0,void 0),t.topClosed&&y.addFace(u[l],a,u[f],void 0,void 0,void 0,void 0);return y},i.exports=a}),i("toxi/geom/IsectData2D",["require","exports","module","./Vec2D"],function(t,e,i){var n=t("./Vec2D"),r=function(t){void 0!==t?(this.isIntersection=t.isIntersection,this.dist=t.dist,this.pos=t.pos.copy(),this.dir=t.dir.copy(),this.normal=t.normal.copy()):this.clear()};r.prototype={clear:function(){this.isIntersection=!1,this.dist=0,this.pos=new n,this.dir=new n,this.normal=new n},toString:function(){var t="isec: "+this.isIntersection;return this.isIntersection&&(t+=" at:"+this.pos+" dist:"+this.dist+" normal:"+this.normal),t}},i.exports=r}),i("toxi/geom/LineStrip3D",["require","exports","module","./vectors","./Line3D","../internals/has","../internals/Iterator"],function(t,e,i){var n=t("./vectors").Vec3D,r=t("./Line3D"),s=t("../internals/has").XYZ,o=t("../internals/Iterator"),a=function(t){this.vertices=t||[]};a.prototype={constructor:a,add:function(t,e,i){return this.vertices.push(s(t)?new n(t):new n(t,e,i)),this},get:function(t){return 0>t&&(t+=this.vertices.length),this.vertices[t]},getDecimatedVertices:function(t,e){e!==!1&&(e=!0);var i=[];if(this.vertices.length<3){if(2!==this.vertices.length)return;new r(this.vertices[0],this.vertices[1]).splitIntoSegments(i,t,!0),e||i.pop()}var n,s,o,a,h,u,c=this.getEstimatedArcLength(),l=t/c,f=0;for(s=0;1>s;s+=l){for(n=s*c;n>=this.arcLenIndex[f];)f++;o=this.get(f-1),a=this.get(f),h=(n-this.arcLenIndex[f-1])/(this.arcLenIndex[f]-this.arcLenIndex[f-1]),u=o.interpolateTo(a,h),i.push(u)}return e&&i.push(this.get(-1).copy()),i},getEstimatedArcLength:function(){(void 0===this.arcLenIndex||this.arcLenIndex.length!==this.vertices.length)&&(this.arcLenIndex=[0]);for(var t,e,i=0,n=1,r=this.vertices.length;r>n;n++)t=this.vertices[n-1],e=this.vertices[n],i+=t.distanceTo(e),this.arcLenIndex[n]=i;return i},getSegments:function(){for(var t=1,e=this.vertices.length,i=[];e>t;t++)i.push(new r(this.get(t-1),this.get(t)));return i},getVertices:function(){return vertices},iterator:function(){return new o(this.vertices)},setVertices:function(t){this.vertices=t}},i.exports=a}),i("toxi/geom/Plane",["require","exports","module","../internals","../math/mathUtils","./Ray3D","./Vec3D","./mesh/TriangleMesh"],function(t,e,i){var n=t("../internals").extend,r=t("../math/mathUtils"),s=t("./Ray3D"),o=t("./Vec3D"),a=t("./mesh/TriangleMesh"),h=function(){var t,e;0===arguments.length?(t=new o,e=o.Y_AXIS.copy()):1==arguments.length?(t=arguments[0].computeCentroid(),e=arguments[0].computeNormal()):(t=arguments[0],e=arguments[1].getNormalized()),o.apply(this,[t]),this.normal=e};n(h,o),h.Classifier={FRONT:"front",BACK:"back",ON_PLANE:"on plane"},h.XY=new h(new o,o.Z_AXIS),h.XZ=new h(new o,o.Y_AXIS),h.YZ=new h(new o,o.X_AXIS),h.prototype.classifyPoint=function(t,e){var i=this.sub(t).normalize().dot(this.normal);return-e>i?h.Classifier.FRONT:i>e?h.Classifier.BACK:h.Classifier.ON_PLANE},h.prototype.containsPoint=function(t){return this.classifyPoint(t,r.EPS)==h.Classifier.ON_PLANE},h.prototype.getDistanceToPoint=function(t){var e=this.normal.dot(t.sub(this)),i=this.normal.magSquared(),n=t.add(this.normal.scale(e/i));return n.distanceTo(t)},h.prototype.getIntersectionWithRay=function(t){var e,i=this.normal.dot(t.getDirection());return i>r.EPS?(e=this.normal.dot(this.sub(t))/i,t.getPointAtDistance(e)):void 0},h.prototype.getProjectedPoint=function(t){var e,i;return e=this.normal.dot(this.sub(t))<0?this.normal.getInverted():this.normal,i=new s(t,e).getPointAtDistance(this.getDistanceToPoint(t))},h.prototype.intersectRayDistance=function(t){var e=this.normal.dot(this),i=this.normal.dot(t)+e,n=this.normal.dot(t.dir);return r.abs(n)<r.EPS?-1:-(i/n)},h.prototype.toMesh=function(t,e){var i,n,t,e;1==arguments.length?(i=t,n=new a("plane",4,2)):(n=t,i=e)},i.exports=h}),i("toxi/geom/Ray3DIntersector",["require","exports","module","./IsectData3D","../math/mathUtils"],function(t,e,i){var n=t("./IsectData3D"),r=t("../math/mathUtils");Ray3DIntersector=function(t){this.ray=t,this.isec=new n},Ray3DIntersector.prototype={getIntersectionData:function(){return this.isec},intersectsRay:function(t){var e,i=this.ray.dir.cross(t.dir),n=this.ray.sub(t),s=r.abs(i.x),o=r.abs(i.y),a=r.abs(i.z);return e=a>s&&a>o?(n.x*t.dir.y-n.y*t.dir.x)/i.z:s>o?(n.y*t.dir.z-n.z*t.dir.y)/i.x:(n.z*t.dir.x-n.x*t.dir.z)/i.y,this.isec.isIntersection=e<=r.EPS&&!isFinite(e),this.isec.pos=this.ray.getPointAtDistance(-e),this.isec.isIntersection}},i.exports=Ray3DIntersector}),i("toxi/geom/Spline2D",["./Vec2D","../internals/is","./BernsteinPolynomial"],function(t,e,i){var n=function(i,r,s){1===arguments.length&&!e.Array(i)&&e.Object(i)&&(r=r||i.bernsteinPoly,s=s||i.tightness,i=i.points);var o,a=0;if(this.pointList=[],"number"!=typeof s&&(s=n.DEFAULT_TIGHTNESS),this.setTightness(s),this.bernstein=r,void 0!==i)for(a=0,o=i.length;o>a;a++)this.add(i[a].copy());for(this.coeffA=[],this.delta=[],this.bi=[],a=0;a<this.numP;a++)this.coeffA[a]=new t,this.delta[a]=new t,this.bi[a]=0;this.bi=[]};return n.prototype={add:function(t){return this.pointList.push(t.copy()),this.numP=this.pointList.length,this},computeVertices:function(e){this.updateCoefficients(),1>e&&(e=1),e++,(void 0===this.bernstein||this.bernstein.resolution!=e)&&(this.bernstein=new i(e));var n=this.bernstein;this.vertices=[],this.findCPoints();var r=new t,s=new t;e--;for(var o=0;o<this.numP-1;o++){var a=this.points[o],h=this.points[o+1];r.set(this.delta[o]).addSelf(a),s.set(h).subSelf(this.delta[o+1]);for(var u=0;e>u;u++){var c=a.x*n.b0[u]+r.x*n.b1[u]+s.x*n.b2[u]+h.x*n.b3[u],l=a.y*n.b0[u]+r.y*n.b1[u]+s.y*n.b2[u]+h.y*n.b3[u];this.vertices.push(new t(c,l))}}return this.vertices.push(this.points[this.points.length-1].copy()),this.vertices},findCPoints:function(){this.bi[1]=-.25;var t,e,i,n;for(e=this.pointList[0],i=this.pointList[2],n=this.delta[0],this.coeffA[1].set((i.x-e.x-n.x)*this.tightness,(i.y-e.y-n.y)*this.tightness),t=2;t<this.numP-1;t++)this.bi[t]=-1/(this.invTightness+this.bi[t-1]),this.coeffA[t].set(-(this.points[t+1].x-this.points[t-1].x-this.coeffA[t-1].x)*this.bi[t],-(this.points[t+1].y-this.points[t-1].y-this.coeffA[t-1].y)*this.bi[t]);for(t=this.numP-2;t>0;t--)this.delta[t].set(this.coeffA[t].x+this.delta[t+1].x*this.bi[t],this.coeffA[t].y+this.delta[t+1].y*this.bi[t])},getDecimatedVertices:function(t,e){void 0===e&&(e=!0),(void 0===this.vertices||this.vertices.length<2)&&this.computeVertices(n.DEFAULT_RES);for(var i=this.getEstimatedArcLength(),r=[],s=t/i,o=0,a=0;1>a;a+=s){for(var h=a*i;h>=this.arcLenIndex[o];)o++;var u=this.vertices[o-1],c=this.vertices[o],l=(h-this.arcLenIndex[o-1])/(this.arcLenIndex[o]-this.arcLenIndex[o-1]),f=u.interpolateTo(c,l);r.push(f)}return e&&r.push(this.vertices[this.vertices.length-1]),r},getEstimatedArcLength:function(){var t,e=0;void 0===this.arcLenIndex||void 0!==this.arcLenIndex&&this.arcLenIndex.length!=this.vertices.length?(this.arcLenIndex=[0],t=this.vertices.length):t=this.arcLenIndex.length;for(var i=1;t>i;i++){var n=this.vertices[i-1],r=this.vertices[i];e+=n.distanceTo(r),this.arcLenIndex[i]=e}return e},getNumPoints:function(){return this.numP},getPointList:function(){return this.pointList},getTightness:function(){return this.tightness},setPointList:function(t){return this.pointList=t.slice(0),this},setTightness:function(t){return this.tightness=t,this.invTightness=1/this.tightness,this},updateCoefficients:function(){if(this.numP=this.pointList.length,void 0===this.points||void 0!==this.points&&this.points.length!=this.numP){this.coeffA=[],this.delta=[],this.bi=[];for(var e=0;e<this.numP;e++)this.coeffA[e]=new t,this.delta[e]=new t;this.setTightness(this.tightness)}this.points=this.pointList.slice(0)}},n.DEFAULT_TIGHTNESS=.25,n.DEFAULT_RES=16,n}),i("toxi/geom/Spline3D",["./Vec3D","../internals/is","./BernsteinPolynomial"],function(t,e,i){var n=function(i,r,s){1===arguments.length&&!e.Array(i)&&e.Object(i)&&(r=r||i.bernsteinPoly,s=s||i.tightness,i=i.points);var o,a=0;if(this.pointList=[],"number"!=typeof s&&(s=n.DEFAULT_TIGHTNESS),this.setTightness(s),this.bernstein=r,void 0!==i)for(a=0,o=i.length;o>a;a++)this.add(i[a].copy());for(this.coeffA=[],this.delta=[],this.bi=[],a=0;a<this.numP;a++)this.coeffA[a]=new t,this.delta[a]=new t,this.bi[a]=0;this.bi=[]};return n.prototype={add:function(t){return this.pointList.push(t.copy()),this.numP=this.pointList.length,this},computeVertices:function(e){this.updateCoefficients(),1>e&&(e=1),e++,(void 0===this.bernstein||this.bernstein.resolution!=e)&&(this.bernstein=new i(e));var n=this.bernstein;this.vertices=[],this.findCPoints();
var r=new t,s=new t;e--;for(var o=0;o<this.numP-1;o++){var a=this.points[o],h=this.points[o+1];r.set(this.delta[o]).addSelf(a),s.set(h).subSelf(this.delta[o+1]);for(var u=0;e>u;u++){var c=a.x*n.b0[u]+r.x*n.b1[u]+s.x*n.b2[u]+h.x*n.b3[u],l=a.y*n.b0[u]+r.y*n.b1[u]+s.y*n.b2[u]+h.y*n.b3[u],f=a.z*n.b0[u]+r.z*n.b1[u]+s.z*n.b2[u]+h.z*n.b3[u];this.vertices.push(new t(c,l,f))}}return this.vertices.push(this.points[this.points.length-1].copy()),this.vertices},findCPoints:function(){this.bi[1]=-.25;var t,e,i,n;for(e=this.pointList[0],i=this.pointList[2],n=this.delta[0],this.coeffA[1].set((i.x-e.x-n.x)*this.tightness,(i.y-e.y-n.y)*this.tightness,(i.z-e.z-n.z)*this.tightness),t=2;t<this.numP-1;t++)this.bi[t]=-1/(this.invTightness+this.bi[t-1]),this.coeffA[t].set(-(this.points[t+1].x-this.points[t-1].x-this.coeffA[t-1].x)*this.bi[t],-(this.points[t+1].y-this.points[t-1].y-this.coeffA[t-1].y)*this.bi[t],-(this.points[t+1].z-this.points[t-1].z-this.coeffA[t-1].z)*this.bi[t]);for(t=this.numP-2;t>0;t--)this.delta[t].set(this.coeffA[t].x+this.delta[t+1].x*this.bi[t],this.coeffA[t].y+this.delta[t+1].y*this.bi[t],this.coeffA[t].z+this.delta[t+1].z*this.bi[t])},getDecimatedVertices:function(t,e){void 0===e&&(e=!0),(void 0===this.vertices||this.vertices.length<2)&&this.computeVertices(n.DEFAULT_RES);for(var i=this.getEstimatedArcLength(),r=[],s=t/i,o=0,a=0;1>a;a+=s){for(var h=a*i;h>=this.arcLenIndex[o];)o++;var u=this.vertices[o-1],c=this.vertices[o],l=(h-this.arcLenIndex[o-1])/(this.arcLenIndex[o]-this.arcLenIndex[o-1]),f=u.interpolateTo(c,l);r.push(f)}return e&&r.push(this.vertices[this.vertices.length-1]),r},getEstimatedArcLength:function(){var t,e=0;void 0===this.arcLenIndex||void 0!==this.arcLenIndex&&this.arcLenIndex.length!=this.vertices.length?(this.arcLenIndex=[0],t=this.vertices.length):t=this.arcLenIndex.length;for(var i=1;t>i;i++){var n=this.vertices[i-1],r=this.vertices[i];e+=n.distanceTo(r),this.arcLenIndex[i]=e}return e},getNumPoints:function(){return this.numP},getPointList:function(){return this.pointList},getTightness:function(){return this.tightness},setPointList:function(t){return this.pointList=t.slice(0),this},setTightness:function(t){return this.tightness=t,this.invTightness=1/this.tightness,this},updateCoefficients:function(){if(this.numP=this.pointList.length,void 0===this.points||void 0!==this.points&&this.points.length!=this.numP){this.coeffA=[],this.delta=[],this.bi=[];for(var e=0;e<this.numP;e++)this.coeffA[e]=new t,this.delta[e]=new t;this.setTightness(this.tightness)}this.points=this.pointList.slice(0)}},n.DEFAULT_TIGHTNESS=.25,n.DEFAULT_RES=16,n}),i("toxi/geom/SutherlandHodgemanClipper",["require","exports","module","./Polygon2D","./vectors"],function(t,e,i){var n=t("./Polygon2D"),r=t("./vectors").Vec2D,s={0:function(t,e,i){var n=e.x+(t.y-e.y)*(i.x-e.x)/(i.y-e.y);return new r(n,t.y)},1:function(t,e,i){var n=t.x+t.width,s=e.y+(n-e.x)*(i.y-e.y)/(i.x-e.x);return new r(n,s)},2:function(t,e,i){var n=t.y+t.height,s=e.x+(n-e.y)*(i.x-e.x)/(i.y-e.y);return new r(s,n)},3:function(t,e,i){var n=e.y+(t.x-e.x)*(i.y-e.y)/(i.x-e.x);return new r(t.x,n)}},o=function(t,e,i,n){return s[e](t,i,n)},a={0:function(t,e){return e.y>=t.y},1:function(t,e){return e.x<t.x+t.width},2:function(t,e){return e.y<t.y+t.height},3:function(t,e){return e.x>=t.x}},h=function(t,e,i){return a[i](t,e)},u=function(t){this.bounds=t};u.prototype={constructor:u,clipPolygon:function(t){var e,i,r,s=t.vertices.slice(0),a=0,u=0,c=s.length-1;for(s.push(s[0]);4>a;a++){for(u=0,c=s.length-1,e=[];c>u;u++)i=s[u],r=s[u+1],h(this.bounds,i,a)?e.push(h(this.bounds,r,a)?r.copy():o(this.bounds,a,i,r)):h(this.bounds,r,a)&&(e.push(o(this.bounds,a,i,r)),e.push(r.copy()));e.length>0&&e[0]!==e[e.length-1]&&e.push(e[0]),s=e}return new n(s).removeDuplicates(.001)},getBounds:function(){return this.bounds},isKnownVertex:function(t,e){for(var i=0,n=t.length;n>i;i++)if(t[i].equalsWithTolerance(e,1e-4))return!0;return!1},setBounds:function(t){this.bounds=t}},i.exports=u}),i("toxi/geom/Triangle2D",["require","exports","module","./Vec2D","./Line2D","./Rect","./Circle","./Polygon2D","../math/mathUtils"],function(t,e,i){var n=t("./Vec2D"),r=t("./Line2D"),s=t("./Rect"),o=t("./Circle"),a=t("./Polygon2D"),h=t("../math/mathUtils"),u=function(t,e,i){3===arguments.length&&(this.a=t.copy(),this.b=e.copy(),this.c=i.copy())};u.createEquilateralFrom=function(t,e){var i=t.interpolateTo(e,.5),n=t.sub(e),r=n.getPerpendicular();return i.addSelf(r.normalizeTo(n.magnitude()*h.SQRT3/2)),new u(t,e,i)},u.isClockwise=function(t,e,i){var n=(e.x-t.x)*(i.y-t.y)-(i.x-t.x)*(e.y-t.y);return 0>n},u.prototype={adjustTriangleSizeBy:function(t,e,i){1==arguments.length&&(e=t,i=t),this.computeCentroid();var n=new r(this.a.copy(),this.b.copy()).offsetAndGrowBy(t,1e5,this.centroid),s=new r(this.b.copy(),this.c.copy()).offsetAndGrowBy(e,1e5,this.centroid),o=new r(this.c.copy(),this.a.copy()).offsetAndGrowBy(i,1e5,this.centroid);return this.a=n.intersectLine(o).getPos(),this.b=n.intersectLine(s).getPos(),this.c=s.intersectLine(o).getPos(),this.computeCentroid(),this},computeCentroid:function(){return this.centroid=this.a.add(this.b).addSelf(this.c).scaleSelf(1/3),this.centroid},containsPoint:function(t){var e=t.sub(this.a).normalize(),i=t.sub(this.b).normalize(),n=t.sub(this.c).normalize(),r=Math.acos(e.dot(i));return r+=Math.acos(i.dot(n)),r+=Math.acos(n.dot(e)),h.abs(r-h.TWO_PI)<=.01},copy:function(){return new u(this.a.copy(),this.b.copy(),this.c.copy())},flipVertexOrder:function(){var t=this.a;return this.a=this.c,this.c=t,this},getArea:function(){return.5*this.b.sub(this.a).cross(this.c.sub(this.a))},getBounds:function(){return new s(n.min(n.min(this.a,this.b),this.c),n.max(n.max(this.a,this.b),this.c))},getCircumCircle:function(){var t=this.a.bisect(this.b).cross(this.b.bisect(this.c)),e=new n(t.x/t.z,t.y/t.z),i=this.a.distanceTo(this.b),r=this.b.distanceTo(this.c),s=this.c.distanceTo(this.a),a=i*r*s/Math.sqrt((i+r+s)*(-i+r+s)*(i-r+s)*(i+r-s));return new o(e,a)},getCircumference:function(){return this.a.distanceTo(this.b)+this.b.distanceTo(this.c)+this.c.distanceTo(this.a)},getClosestPointTo:function(t){var e=new r(this.a,this.b),i=e.closestPointTo(t),n=e.set(this.b,this.c).closestPointTo(t),s=e.set(this.c,this.a).closestPointTo(t),o=t.sub(i).magSquared(),a=t.sub(n).magSquared(),h=t.sub(s).magSquared(),u=o,c=i;return u>a&&(u=a,c=n),u>h&&(c=s),c},intersectsTriangle:function(t){if(this.containsPoint(t.a)||this.containsPoint(t.b)||this.containsPoint(t.c))return!0;if(t.containsPoint(this.a)||t.containsPoint(this.b)||t.containsPoint(this.c))return!0;for(var e=[new r(this.a,this.b),new r(this.b,this.c),new r(this.c,this.a)],i=[new r(t.a,t.b),new r(t.b,t.c),new r(t.c,t.a)],n=0,s=e.length;s>n;n++)for(var o=e[n],a=0,h=i.length;h>a;a++){var u=i[a],c=o.intersectLine(u).getType();if(c!=r.LineIntersection.Type.NON_INTERSECTING&&c!=r.LineIntersection.Type.PARALLEL)return!0}return!1},isClockwise:function(){return u.isClockwise(this.a,this.b,this.c)},set:function(t,e,i){this.a=t,this.b=e,this.c=i},toPolygon2D:function(){var t=new a;return t.add(this.a.copy()),t.add(this.b.copy()),t.add(this.c.copy()),t},toString:function(){return"Triangle2D: "+this.a+","+this.b+","+this.c}},i.exports=u}),i("toxi/geom/AxisAlignedCylinder",["require","exports","module","./Cone"],function(t,e,i){var n=t("./Cone"),r=function(t,e,i){this.pos=void 0===t?void 0:t.copy(),this.setRadius(e),this.setLength(i)};r.prototype={containsPoint:function(){throw Error("AxisAlignedCylinder.containsPoint(): not implmented")},getLength:function(){return this.length},getMajorAxis:function(){throw Error("AxisAlignedCylinder.getMajorAxis(): not implemented")},getPosition:function(){return this.pos.copy()},getRadius:function(){return this.radius},setLength:function(t){this.length=t},setPosition:function(t){this.pos.set(t)},setRadius:function(t){this.radius=t,this.radiusSquared=t*t},toMesh:function(){var t={mesh:void 0,steps:12,thetaOffset:0};if(1==arguments.length&&"object"==typeof arguments[0])for(var e in arguments[0])t[e]=arguments[0][e];else 2==arguments.length&&(t.steps=arguments[0],t.thetaOffset=arguments[1]);var i=new n(this.pos,this.getMajorAxis().getVector(),this.radius,this.radius,this.length);return i.toMesh(t.mesh,t.steps,t.thetaOffset,!0,!0)}},i.exports=r}),i("toxi/geom/XAxisCylinder",["require","exports","module","../internals","../math/mathUtils","./Vec3D","./AxisAlignedCylinder"],function(t,e,i){var n=t("../internals").extend,r=t("../math/mathUtils"),s=t("./Vec3D"),o=t("./AxisAlignedCylinder"),a=function(t,e,i){o.apply(this,[t,e,i])};n(a,o),a.prototype.containsPoint=function(t){if(r.abs(t.x-this.pos.x)<.5*this.length){var e=t.y-this.pos.y,i=t.z-this.pos.z;if(Math.abs(i*i+e*e)<this.radiusSquared)return!0}return!1},a.prototype.getMajorAxis=function(){return s.Axis.X},i.exports=a}),i("toxi/geom/YAxisCylinder",["require","exports","module","../internals","../math/mathUtils","./Vec3D","./AxisAlignedCylinder"],function(t,e,i){var n=t("../internals").extend,r=t("../math/mathUtils"),s=t("./Vec3D"),o=t("./AxisAlignedCylinder"),a=function(t,e,i){o.apply(this,[t,e,i])};n(a,o),a.prototype.containsPoint=function(t){if(r.abs(t.y-this.pos.y)<.5*this.length){var e=t.x-this.pos.x,i=t.z-this.pos.z;if(Math.abs(i*i+e*e)<this.radiusSquared)return!0}return!1},a.prototype.getMajorAxis=function(){return s.Axis.Y},i.exports=a}),i("toxi/geom/ZAxisCylinder",["require","exports","module","../internals","../math/mathUtils","./Vec3D","./AxisAlignedCylinder"],function(t,e,i){var n=t("../internals").extend,r=t("../math/mathUtils"),s=t("./Vec3D"),o=t("./AxisAlignedCylinder"),a=function(t,e,i){o.apply(this,[t,e,i])};n(a,o),a.prototype.containsPoint=function(t){if(r.abs(t.z-this.pos.z)<.5*this.length){var e=t.x-this.pos.x,i=t.y-this.pos.y;if(Math.abs(e*e+i*i)<this.radiusSquared)return!0}return!1},a.prototype.getMajorAxis=function(){return s.Axis.Z},i.exports=a}),i("toxi/geom",["require","exports","./geom/mesh","./geom/AABB","./geom/BernsteinPolynomial","./geom/Circle","./geom/CircleIntersector","./geom/Cone","./geom/Ellipse","./geom/IsectData2D","./geom/IsectData3D","./geom/Line2D","./geom/Line3D","./geom/LineStrip3D","./geom/Matrix4x4","./geom/Plane","./geom/Polygon2D","./geom/Quaternion","./geom/Ray2D","./geom/Ray3D","./geom/Ray3DIntersector","./geom/Rect","./geom/Sphere","./geom/Spline2D","./geom/Spline3D","./geom/SutherlandHodgemanClipper","./geom/Triangle2D","./geom/Triangle3D","./geom/Vec2D","./geom/Vec3D","./geom/XAxisCylinder","./geom/YAxisCylinder","./geom/ZAxisCylinder"],function(t,e){e.AABB=t("./geom/AABB"),e.mesh=t("./geom/mesh"),e.BernsteinPolynomial=t("./geom/BernsteinPolynomial"),e.Circle=t("./geom/Circle"),e.CircleIntersector=t("./geom/CircleIntersector"),e.Cone=t("./geom/Cone"),e.Ellipse=t("./geom/Ellipse"),e.IsectData2D=t("./geom/IsectData2D"),e.IsectData3D=t("./geom/IsectData3D"),e.Line2D=t("./geom/Line2D"),e.Line3D=t("./geom/Line3D"),e.LineStrip3D=t("./geom/LineStrip3D"),e.Matrix4x4=t("./geom/Matrix4x4"),e.Plane=t("./geom/Plane"),e.Polygon2D=t("./geom/Polygon2D"),e.Quaternion=t("./geom/Quaternion"),e.Ray2D=t("./geom/Ray2D"),e.Ray3D=t("./geom/Ray3D"),e.Ray3DIntersector=t("./geom/Ray3DIntersector"),e.Rect=t("./geom/Rect"),e.Sphere=t("./geom/Sphere"),e.Spline2D=t("./geom/Spline2D"),e.Spline3D=t("./geom/Spline3D"),e.SutherlandHodgemanClipper=t("./geom/SutherlandHodgemanClipper"),e.Triangle2D=t("./geom/Triangle2D"),e.Triangle3D=t("./geom/Triangle3D"),e.Vec2D=t("./geom/Vec2D"),e.Vec3D=t("./geom/Vec3D"),e.XAxisCylinder=t("./geom/XAxisCylinder"),e.YAxisCylinder=t("./geom/YAxisCylinder"),e.ZAxisCylinder=t("./geom/ZAxisCylinder")}),i("toxi/math/BezierInterpolation",[],function(){var t=function(t,e){this.c1=t,this.c2=e};return t.interpolate=function(t,e,i,n,r){var s=i*i,o=1-i,a=o*o;return t*a*o+3*(n*(e-t)+t)*i*a+3*(r*(e-t)+e)*s*o+e*s*i},t.prototype={interpolate:function(t,e,i){var n=i*i,r=1-i,s=r*r;return t*s*r+3*(this.c1*(e-t)+t)*i*s+3*(this.c2*(e-t)+e)*n*r+e*n*i},setCoefficients:function(t,e){this.c1=t,this.c2=e}},t}),i("toxi/math/CircularInterpolation",[],function(){var t=function(t){void 0===t&&(this.isFlipped=!1)};return t.interpolate=function(t,e,i,n){return n?t-(e-t)*(Math.sqrt(1-i*i)-1):(i=1-i,t+(e-t)*Math.sqrt(1-i*i))},t.prototype.interpolate=function(t,e,i){return this.isFlipped?t-(e-t)*(Math.sqrt(1-i*i)-1):(i=1-i,t+(e-t)*Math.sqrt(1-i*i))},t.prototype.setFlipped=function(t){this.isFlipped=t},t}),i("toxi/math/CosineInterpolation",[],function(){var t=function(){};return t.interpolate=function(t,e,i){return e+(t-e)*(.5+.5*Math.cos(i*Math.PI))},t.prototype.interpolate=t.interpolate,t}),i("toxi/math/DecimatedInterpolation",["./LinearInterpolation"],function(t){var e=function(e,i){if(void 0===e)throw new Error("steps was not passed to constructor");this.numSteps=e,this.strategy=i||new t};return e.prototype={interpolate:function(t,e,i){var n=Math.floor(i*this.numSteps)/this.numSteps;return this.strategy.interpolate(t,e,n)}},e}),i("toxi/math/ExponentialInterpolation",[],function(){var t=function(t){this.exponent=void 0===t?2:t};return t.interpolate=function(t,e,i,n){return t+(e-t)*Math.pow(i,n)},t.prototype.interpolate=function(t,e,i){return t+(e-t)*Math.pow(i,this.exponent)},t}),i("toxi/math/SigmoidInterpolation",[],function(){var t=function(t){void 0===t&&(t=2),this.setSharpness(t)},e=function(t,e,i,n){return i=(2*i-1)*n,i=1/(1+Math.exp(-i)),t+(e-t)*i};return t.prototype={getSharpness:function(){return this.sharpness},interpolate:function(t,i,n){return e(t,i,n,this.sharpPremult)},setSharpness:function(t){this.sharpness=t,this.sharpPremult=5*t}},t.interpolate=e,t}),i("toxi/math/SinCosLUT",["./mathUtils"],function(t){var e=function(t){t||(t=e.DEFAULT_PRECISION),this.precision=t,this.period=360/this.precision,this.quadrant=this.period>>2,this.deg2rad=Math.PI/180*this.precision,this.rad2deg=180/Math.PI/this.precision,this.sinLUT=[];for(var i=0;i<this.period;i++)this.sinLUT[i]=Math.sin(i*this.deg2rad)};return e.prototype={cos:function(e){for(;0>e;)e+=t.TWO_PI;return this.sinLUT[(e*this.rad2deg+this.quadrant)%this.period]},getPeriod:function(){return this.period},getPrecision:function(){return this.precision},getSinLUT:function(){return this.sinLUT},sin:function(e){for(;0>e;)e+=t.TWO_PI;return this.sinLUT[e*this.rad2deg%this.period]}},e.DEFAULT_PRECISION=.25,e.DEFAULT_INSTANCE=void 0,e.getDefaultInstance=function(){return void 0===e.DEFAULT_INSTANCE&&(e.DEFAULT_INSTANCE=new e),e.DEFAULT_INSTANCE},e}),i("toxi/math/ThresholdInterpolation",[],function(){var t=function(t){this.threshold=t},e=function(t,e,i,n){return n>i?t:e};return t.prototype={interpolate:function(t,e,i){return i<this.threshold?t:e}},t.interpolate=e,t}),i("toxi/math/ZoomLensInterpolation",["./mathUtils","./CircularInterpolation"],function(t,e){var i=function(t,i){this.leftImpl=new e,this.rightImpl=new e,this.lensPos=t||.5,this.lensStrength=i||1,this.absStrength=Math.abs(this.lensStrength),this.leftImpl.setFlipped(this.lensStrength>0),this.rightImpl.setFlipped(this.lensStrength<0)};return i.prototype={interpolate:function(t,e,i){var n=t+(e-t)*i;return n+=i<this.lensPos?(this.leftImpl.interpolate(t,t+(e-t)*this.lensPos,i/this.lensPos)-n)*this.absStrength:(this.rightImpl.interpolate(t+(e-t)*this.lensPos,e,(i-this.lensPos)/(1-this.lensPos))-n)*this.absStrength},setLensPos:function(e,i){this.lensPos+=(t.clipNormalized(e)-this.lensPos)*i},setLensStrength:function(e,i){this.lensStrength+=(t.clip(e,-1,1)-this.lensStrength)*i,this.absStrength=t.abs(this.lensStrength),this.leftImpl.setFlipped(this.lensStrength>0),this.rightImpl.setFlipped(this.lensStrength<0)}},i}),i("toxi/math/noise/PerlinNoise",["require","../SinCosLUT","../../internals/has"],function(t){var e=t("../SinCosLUT"),i=t("../../internals/has").typedArrays(),n={};n.pow=Math.pow,n.random=Math.random,function(t,e,i,n,r,s,o){function a(t){var e,n,r=this,s=t.length,o=0,a=r.i=r.j=r.m=0;for(r.S=[],r.c=[],s||(t=[s++]);i>o;)r.S[o]=o++;for(o=0;i>o;o++)e=r.S[o],a=c(a+e+t[o%s]),n=r.S[a],r.S[o]=n,r.S[a]=e;r.g=function(t){var e=r.S,n=c(r.i+1),s=e[n],o=c(r.j+s),a=e[o];e[n]=a,e[o]=s;for(var h=e[c(s+a)];--t;)n=c(n+1),s=e[n],o=c(o+s),a=e[o],e[n]=a,e[o]=s,h=h*i+e[c(s+a)];return r.i=n,r.j=o,h},r.g(i)}function h(t,e,i,n,r){if(i=[],r=typeof t,e&&"object"==r)for(n in t)if(n.indexOf("S")<5)try{i.push(h(t[n],e-1))}catch(s){}return i.length?i:t+("string"!=r?"\x00":"")}function u(t,e,i,n){for(t+="",i=0,n=0;n<t.length;n++)e[c(n)]=c((i^=19*e[c(n)])+t.charCodeAt(n));t="";for(n in e)t+=String.fromCharCode(e[n]);return t}function c(t){return t&i-1}e.seedrandom=function(c,l){var f,p=[];return c=u(h(l?[c,t]:arguments.length?c:[(new Date).getTime(),t,window],3),p),f=new a(p),u(f.S,t),e.random=function(){for(var t=f.g(n),e=o,a=0;r>t;)t=(t+a)*i,e*=i,a=f.g(1);for(;t>=s;)t/=2,e/=2,a>>>=1;return(t+a)/e},c},o=e.pow(i,n),r=e.pow(2,r),s=2*r,u(e.random(),t)}([],n,256,6,52);var r=4,s=1<<r,o=8,a=1<<o,h=4095,u=.001,c=function(t,e){var i=(e+.5)*t._perlin_PI%t._perlin_TWOPI;return.5*(1-t._perlin_cosTable[i])},l=function(){this._perlin_octaves=4,this._perlin_amp_falloff=.5,this._sinCosLUT=e.getDefaultInstance()};return l.prototype={noise:function(t,e,l){var f=0;if(t=t||0,e=e||0,l=l||0,!this._perlin){this._perlin=i?new Float32Array(h):[];for(f=0;h+1>f;f++)this._perlin[f]=n.random()}this._perlin_cosTable=this._sinCosLUT.getSinLUT(),this._perlin_TWOPI=this._perlin_PI=this._sinCosLUT.getPeriod(),this._perlin_PI>>=1,0>t&&(t=-t),0>e&&(e=-e),0>l&&(l=-l);var p,d,g,m,y,x,v=t,b=e,w=l,S=t-v,A=e-b,C=l-w,T=0,M=.5;for(f=0;f<this._perlin_octaves&&(x=v+(b<<r)+(w<<o),p=c(this,S),d=c(this,A),g=this._perlin[x&h],g+=p*(this._perlin[x+1&h]-g),m=this._perlin[x+s&h],m+=p*(this._perlin[x+s+1&h]-m),g+=d*(m-g),x+=a,m=this._perlin[x&h],m+=p*(this._perlin[x+1&h]-m),y=this._perlin[x+s&h],y+=p*(this._perlin[x+s+1&h]-y),m+=d*(y-m),g+=c(this,C)*(m-g),T+=g*M,M*=this._perlin_amp_falloff,!(u>M));f++)v<<=1,S*=2,b<<=1,A*=2,w<<=1,C*=2,S>=1&&(v++,S--),A>=1&&(b++,A--),C>=1&&(w++,C--);return T},noiseDetail:function(t,e){t>0&&(this._perlin_octaves=t),e&&e>0&&(this._perlin_amp_falloff=e)},noiseSeed:function(t){n.seedrandom(t)}},l}),i("toxi/math/noise/simplexNoise",["require","exports","module","../../internals"],function(t,e,i){var n=t("../../internals/each"),r=t("../../internals/has"),s=Math.sqrt(3),o=Math.sqrt(5),a=.5*(s-1),h=(3-s)/6,u=2*h-1,c=1/3,l=1/6,f=(o-1)/4,p=(5-o)/20,d=2*p,g=3*p,m=4*p-1,y=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],x=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],v=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],b=function(){for(var t=r.typedArrays()?new Int32Array(512):[],e=0;512>e;e++)t[e]=v[255&e];return t}(),w=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]];if(r.typedArrays()){var S=function(t){var e=[];return n(t,function(t){e.push(new Int32Array(t))}),e};y=S(y),x=S(x),v=new Int32Array(v),w=S(w),this.testObjs={_grad3:y,_grad4:x,_p:v,_simplex:w}}var A=function(t,e,i,n,r){var s=t[0]*e+t[1]*i;return n&&(s+=t[2]*n,r&&(s+=t[3]*r)),s},C=function(t){return Math.floor(t>=0?t:t-1)},T={noise:function(t,e,i,n){var r=arguments.length,s=0,o=0,v=0,S=0,T=0,M=function(){switch(r){case 2:return(t+e)*a;case 3:return(t+e+i)*c;case 4:return(t+e+i+n)*f;default:throw new Error("Wrong arguments supplied to SimplexNoise.noise()")}}(),z=C(t+M),I=C(e+M),R=void 0!==i?C(i+M):void 0,D=void 0!==n?C(n+M):void 0,P=function(){switch(r){case 2:return(z+I)*h;case 3:return(z+I+R)*l;case 4:return(z+I+R+D)*p}}(),E=t-(z-P),L=e-(I-P),_=void 0!==i?i-(R-P):void 0,V=void 0!==n?n-(D-P):void 0;return 2==r?function(){var t,e,i,n,r,a,c,l,f,p,d,g,m;E>L?(t=1,e=0):(t=0,e=1),i=E-t+h,n=L-e+h,r=E+u,a=L+u,c=255&z,l=255&I,f=.5-E*E-L*L,f>0&&(f*=f,p=b[c+b[l]]%12,s=f*f*A(y[p],E,L));var x=.5-i*i-n*n;return x>0&&(x*=x,d=b[c+t+b[l+e]]%12,o=x*x*A(y[d],i,n)),m=.5-r*r-a*a,m>0&&(m*=m,g=b[c+1+b[l+1]]%12,v=m*m*A(y[g],r,a)),70*(s+o+v)}():3==r?function(){var t,e,i,n,r,a,h,u,f,p,d,g,m,x,w,C,T,M,D,P,V,B,N,F,q,k;return E>=L?L>=_?(t=1,e=0,i=0,n=1,r=1,a=0):E>=_?(t=1,e=0,i=0,n=1,r=0,a=1):(t=0,e=0,i=1,n=1,r=0,a=1):_>L?(t=0,e=0,i=1,n=0,r=1,a=1):_>E?(t=0,e=1,i=0,n=0,r=1,a=1):(t=0,e=1,i=0,n=1,r=1,a=0),h=E-t+l,u=L-e+l,f=_-i+l,p=E-n+c,d=L-r+c,g=_-a+c,m=E-.5,x=L-.5,w=_-.5,C=255&z,T=255&I,M=255&R,D=.6-E*E-L*L-_*_,D>0&&(D*=D,P=b[C+b[T+b[M]]]%12,s=D*D*A(y[P],E,L,_)),V=.6-h*h-u*u-f*f,V>0&&(V*=V,B=b[C+t+b[T+e+b[M+i]]]%12,o=V*V*A(y[B],h,u,f)),N=.6-p*p-d*d-g*g,N>0&&(N*=N,F=b[C+n+b[T+r+b[M+a]]]%12,v=N*N*A(y[F],p,d,g)),q=.6-m*m-x*x-w*w,q>0&&(q*=q,k=b[C+1+b[T+1+b[M+1]]]%12,S=q*q*A(y[k],m,x,w)),32*(s+o+v+S)}():function(){var t,e,i,n,r,a,h,u,c,l,f,y,C,M,P,B,N,F,q,k,O,H,G,U,W,Y,X,Z,j,K,Q,J,$,te,ee,ie,ne,re,se,oe,ae,he,ue=w[function(){var t=0;return E>L&&(t=32),E>_&&(t|=16),L>_&&(t|=8),E>V&&(t|=4),L>V&&(t|=2),_>V&&(t|=1),t}()];return t=ue[0]>=3?1:0,e=ue[1]>=3?1:0,i=ue[2]>=3?1:0,n=ue[3]>=3?1:0,r=ue[0]>=2?1:0,a=ue[1]>=2?1:0,h=ue[2]>=2?1:0,u=ue[3]>=2?1:0,c=ue[0]>=1?1:0,l=ue[1]>=1?1:0,f=ue[2]>=1?1:0,y=ue[3]>=1?1:0,C=E-t+p,M=L-e+p,P=_-i+p,B=V-n+p,N=E-r+d,F=L-a+d,q=_-h+d,k=V-u+d,O=E-c+g,H=L-l+g,G=_-f+g,U=V-y+g,W=E+m,Y=L+m,X=_+m,Z=V+m,j=255&z,K=255&I,Q=255&R,J=255&D,$=.6-E*E-L*L-_*_-V*V,$>0&&($*=$,te=b[j+b[K+b[Q+b[J]]]]%32,s=$*$*A(x[te],E,L,_,V)),ee=.6-C*C-M*M-P*P-B*B,ee>0&&(ee*=ee,ie=b[j+t+b[K+e+b[Q+i+b[J+n]]]]%32,o=ee*ee*A(x[ie],C,M,P,B)),ne=.6-N*N-F*F-q*q-k*k,ne>0&&(ne*=ne,re=b[j+r+b[K+a+b[Q+h+b[J+u]]]]%32,v=ne*ne*A(x[re],N,F,q,k)),se=.6-O*O-H*H-G*G-U*U,se>0&&(se*=se,oe=b[j+c+b[K+l+b[Q+f+b[J+y]]]]%32,S=se*se*A(x[oe],O,H,G,U)),ae=.6-W*W-Y*Y-X*X-Z*Z,ae>0&&(ae*=ae,he=b[j+1+b[K+1+b[Q+1+b[J+1]]]]%32,T=ae*ae*A(x[he],W,Y,X,Z)),27*(s+o+v+S+T)}()}};i.exports=T}),i("toxi/math/noise",["require","exports","module","./noise/PerlinNoise","./noise/simplexNoise"],function(t,e,i){i.exports={PerlinNoise:t("./noise/PerlinNoise"),simplexNoise:t("./noise/simplexNoise")}}),i("toxi/math/waves/WaveState",["require","exports","module"],function(t,e,i){var n=function(t,e,i,n){this.phase=t,this.frequency=e,this.amp=i,this.offset=n};i.exports=n}),i("toxi/math/waves/AbstractWave",["require","exports","module","./WaveState"],function(t,e,i){var n=t("./WaveState"),r=function(t,e){return"number"==typeof t?t:e},s=function(t,e,i,n){1===arguments.length&&"object"==typeof arguments[0]&&(n=t.offset,i=t.amp,e=t.freq,t=t.phase),this.setPhase(r(t,0)),this.frequency=r(e,0),this.amp=r(i,1),this.offset=r(n,0)};s.prototype={cyclePhase:function(t){return void 0===t&&(t=0),this.phase=(this.phase+t)%s.TWO_PI,this.phase<0&&(this.phase+=s.TWO_PI),this.phase},getClass:function(){return"AbstractWave"},pop:function(){if(void 0===this.stateStack||void 0!==this.stateStack&&this.stateStack.length<=0)return console.log(this.toString()),void console.log("no wave states on stack");var t=this.stateStack.pop();this.phase=t.phase,this.frequency=t.frequency,this.amp=t.amp,this.offset=t.offset},push:function(){void 0===this.stateStack&&(this.stateStack=[]),this.stateStack.push(new n(this.phase,this.frequency,this.amp,this.offset))},reset:function(){this.phase=this.origPhase},setPhase:function(t){this.phase=t,this.cyclePhase(),this.origPhase=t},toString:function(){return this.getClass()+" phase:"+this.phase+" frequency: "+this.frequency+" amp: "+this.amp+" offset: "+this.offset},update:function(){console.log(this.getClass()+" this should be overridden")}},s.PI=3.141592653589793,s.TWO_PI=2*s.PI,s.hertzToRadians=function(t,e){return t/e*s.TWO_PI},s.radiansToHertz=function(t,e){return t/s.TWO_PI*e},i.exports=s}),i("toxi/math/waves/AMFMSineWave",["require","exports","module","../../internals","./AbstractWave"],function(t,e,i){var n=t("../../internals").extend,r=t("./AbstractWave"),s=function(t,e,i,n,s){"number"==typeof i?(r.call(this,t,e,1,i),this.amod=n,this.fmod=s):(r.call(this,t,e),this.amod=i,this.fmod=n)};n(s,r),s.prototype.getClass=function(){return"AMFMSineWave"},s.prototype.pop=function(){this.parent.pop.call(this),this.amod.pop(),this.fmod.pop()},s.prototype.push=function(){this.parent.push.call(this),this.amod.push(),this.fmod.push()},s.prototype.reset=function(){this.parent.reset.call(this),this.fmod.reset(),this.amod.reset()},s.prototype.update=function(){return this.amp=this.amod.update(),this.value=this.amp*Math.sin(this.phase)+this.offset,this.cyclePhase(this.frequency+this.fmod.update()),this.value},i.exports=s}),i("toxi/math/waves/ConstantWave",["require","exports","module","../../internals","./AbstractWave"],function(t,e,i){var n=t("../../internals").extend,r=t("./AbstractWave"),s=function(t){r.apply(this),this.value=t};n(s,r),s.prototype.getClass=function(){return"ConstantWave"},s.prototype.update=function(){return this.value},i.exports=s}),i("toxi/math/waves/FMHarmonicSquareWave",["require","exports","module","../../internals","./AbstractWave"],function(t,e,i){var n=t("../../internals").extend,r=t("./AbstractWave"),s=function(t,e,i,n,s){this.maxHarmonics=3,"number"==typeof i?(void 0===s&&(s=new ConstantWave(0)),r.call(this,t,e,i,n),this.fmod=s):(r.call(this,t,e),this.fmod=i)};n(s,r),s.prototype.getClass=function(){return"FMHarmonicSquareWave"},s.prototype.pop=function(){this.parent.pop.call(this),this.fmod.pop()},s.prototype.push=function(){this.parent.push.call(this),this.fmod.push()},s.prototype.reset=function(){this.parent.reset.call(this),this.fmod.reset()},s.prototype.update=function(){this.value=0;for(var t=1;t<=this.maxHarmonics;t+=2)this.value+=1/t*Math.sin(t*this.phase);return this.value*=this.amp,this.value+=this.offset,this.cyclePhase(this.frequency+this.fmod.update()),this.value},i.exports=s}),i("toxi/math/waves/FMSawtoothWave",["require","exports","module","../../internals","./AbstractWave"],function(t,e,i){var n=t("../../internals").extend,r=t("./AbstractWave"),s=function(t,e,i,n,s){"number"==typeof i?(r.call(this,t,e,i,n),this.fmod=s):(r.call(this,t,e),this.fmod=i)};n(s,r),s.prototype.getClass=function(){return"FMSawtoothWave"},s.prototype.pop=function(){this.parent.pop.call(this),this.fmod.pop()},s.prototype.push=function(){this.parent.push.call(this),this.fmod.push()},s.prototype.reset=function(){this.parent.reset.call(this),this.fmod.reset()},s.prototype.update=function(){return this.value=(this.phase/r.TWO_PI*2-1)*this.amp+this.offset,this.cyclePhase(this.frequency+this.fmod.update()),this.value},i.exports=s}),i("toxi/math/waves/FMSineWave",["require","exports","module","../../internals","./AbstractWave"],function(t,e,i){var n=t("../../internals").extend,r=t("./AbstractWave"),s=function(t,e,i,n,s){"number"==typeof i?(r.call(this,t,e,i,n),this.fmod=s):(r.call(this,t,e),this.fmod=i)};n(s,r),s.prototype.getClass=function(){return"FMSineWave"},s.prototype.pop=function(){this.parent.pop.call(this),this.fmod.pop()},s.prototype.push=function(){this.parent.push.call(this),this.fmod.push()},s.prototype.reset=function(){this.parent.reset.call(this),this.fmod.reset()},s.prototype.update=function(){return this.value=Math.sin(this.phase)*this.amp+this.offset,this.cyclePhase(this.frequency+this.fmod.update()),this.value},i.exports=s}),i("toxi/math/waves/FMSquareWave",["require","exports","module","../../internals","./AbstractWave","./ConstantWave"],function(t,e,i){var n=t("../../internals").extend,r=t("./AbstractWave"),s=t("./ConstantWave"),o=function(t,e,i,n,o){"number"==typeof i?void 0===o?r.call(this,t,e,i,n,new s(0)):(r.call(this,t,e,i,n),this.fmod=o):(r.call(this,t,e),this.fmod=i)};n(o,r),o.prototype.getClass=function(){return"FMSquareWave"},o.prototype.pop=function(){this.parent.pop.call(this),this.fmod.pop()},o.prototype.push=function(){this.parent.push.call(this),this.fmod.push()},o.prototype.reset=function(){this.parent.reset.call(this),this.fmod.reset()},o.prototype.update=function(){return this.value=(this.phase/r.TWO_PI<.5?1:-1)*this.amp+this.offset,this.cyclePhase(this.frequency+this.fmod.update()),this.value},i.exports=o}),i("toxi/math/waves/FMTriangleWave",["require","exports","module","../../internals","../mathUtils","./AbstractWave","./ConstantWave"],function(t,e,i){var n=t("../../internals").extend,r=t("../mathUtils"),s=t("./AbstractWave"),o=t("./ConstantWave"),a=function(t,e,i,n,r){"number"==typeof i?void 0!==r?(s.call(this,t,e,i,n),this.fmod=r):s.call(this,t,e,i,n,new o(0)):s.call(this,t,e,1,0)};n(a,s),a.prototype.getClass=function(){return"FMTriangleWave"},a.prototype.pop=function(){this.parent.pop.call(this),this.fmod.pop()},a.prototype.push=function(){this.parent.push.call(this),this.fmod.push()},a.prototype.reset=function(){this.parent.reset.call(this),this.fmod.reset()},a.prototype.update=function(){return this.value=2*this.amp*(Math.abs(s.PI-this.phase)*r.INV_PI-.5)+this.offset,this.cyclePhase(this.frequency+this.fmod.update()),this.value},i.exports=a}),i("toxi/math/waves/SineWave",["require","exports","module","../../internals","./AbstractWave"],function(t,e,i){var n=t("../../internals").extend,r=t("./AbstractWave"),s=function(t,e,i,n){r.call(this,t,e,i,n)};n(s,r),s.prototype.getClass=function(){return"SineWave"},s.prototype.update=function(){return this.value=Math.sin(this.phase)*this.amp+this.offset,this.cyclePhase(this.frequency),this.value},i.exports=s}),i("toxi/math/waves",["require","exports","module","./waves/AbstractWave","./waves/AMFMSineWave","./waves/ConstantWave","./waves/FMHarmonicSquareWave","./waves/FMSawtoothWave","./waves/FMSineWave","./waves/FMSquareWave","./waves/FMTriangleWave","./waves/SineWave","./waves/WaveState"],function(t,e,i){i.exports={AbstractWave:t("./waves/AbstractWave"),AMFMSineWave:t("./waves/AMFMSineWave"),ConstantWave:t("./waves/ConstantWave"),FMHarmonicSquareWave:t("./waves/FMHarmonicSquareWave"),FMSawtoothWave:t("./waves/FMSawtoothWave"),FMSineWave:t("./waves/FMSineWave"),FMSquareWave:t("./waves/FMSquareWave"),FMTriangleWave:t("./waves/FMTriangleWave"),SineWave:t("./waves/SineWave"),WaveState:t("./waves/WaveState")}}),i("toxi/math",["require","exports","module","./math/BezierInterpolation","./math/CircularInterpolation","./math/CosineInterpolation","./math/DecimatedInterpolation","./math/ExponentialInterpolation","./math/Interpolation2D","./math/LinearInterpolation","./math/mathUtils","./math/mathUtils","./math/ScaleMap","./math/SigmoidInterpolation","./math/SinCosLUT","./math/ThresholdInterpolation","./math/ZoomLensInterpolation","./math/noise","./math/waves"],function(t,e,i){i.exports={BezierInterpolation:t("./math/BezierInterpolation"),CircularInterpolation:t("./math/CircularInterpolation"),CosineInterpolation:t("./math/CosineInterpolation"),DecimatedInterpolation:t("./math/DecimatedInterpolation"),ExponentialInterpolation:t("./math/ExponentialInterpolation"),Interpolation2D:t("./math/Interpolation2D"),LinearInterpolation:t("./math/LinearInterpolation"),mathUtils:t("./math/mathUtils"),MathUtils:t("./math/mathUtils"),ScaleMap:t("./math/ScaleMap"),SigmoidInterpolation:t("./math/SigmoidInterpolation"),SinCosLUT:t("./math/SinCosLUT"),ThresholdInterpolation:t("./math/ThresholdInterpolation"),ZoomLensInterpolation:t("./math/ZoomLensInterpolation")},i.exports.noise=t("./math/noise"),i.exports.waves=t("./math/waves")
}),i("toxi/physics2d/VerletParticle2D",["require","exports","module","../internals","../geom/Vec2D"],function(t,e,i){var n=t("../internals"),r=t("../geom/Vec2D"),s=function(t,e,i){this.force=new r,n.has.XY(t)&&(n.is.VerletParticle2D(t)?(e=t.y,i=t.weight,t=t.x,this.isLocked=t.isLocked):void 0===e?(e=t.y,i=1,t=t.x):(i=e,e=t.y,t=t.x)),r.call(this,t,e),this.isLocked=!1,this.prev=new r(this),this.temp=new r,i=i||1,this.setWeight(i)};n.extend(s,r),s.prototype.addBehavior=function(t,e){if(void 0===this.behaviors&&(this.behaviors=[]),void 0===t)throw new Error("behavior was undefined");return e=void 0===e?1:e,t.configure(e),this.behaviors.push(t),this},s.prototype.addConstraint=function(t){return void 0===this.constraints&&(this.constraints=[]),this.constraints.push(t),this},s.prototype.addForce=function(t){return this.force.addSelf(t),this},s.prototype.addVelocity=function(t){return this.prev.subSelf(t),this},s.prototype.applyBehaviors=function(){if(void 0!==this.behaviors){var t=0,e=this.behaviors.length;for(t=0;e>t;t++)this.behaviors[t].applyBehavior(this)}},s.prototype.applyConstraints=function(){if(void 0!==this.constraints){var t=0,e=this.constraints.length;for(t=0;e>t;t++)this.constraints[t].applyConstraint(this)}},s.prototype.clearForce=function(){return this.force.clear(),this},s.prototype.clearVelocity=function(){return this.prev.set(this),this},s.prototype.getInvWeight=function(){return this.invWeight},s.prototype.getPreviousPosition=function(){return this.prev},s.prototype.getVelocity=function(){return this.sub(this.prev)},s.prototype.getWeight=function(){return this.weight},s.prototype.lock=function(){return this.isLocked=!0,this},s.prototype.removeAllBehaviors=function(){return this.behaviors=[],this},s.prototype.removeAllConstraints=function(){return this.constraints=[],this},s.prototype.removeBehavior=function(t){return n.removeItemFrom(t,this.behaviors)},s.prototype.removeConstraint=function(t){return n.removeItemFrom(t,this.constraints)},s.prototype.scaleVelocity=function(t){return this.prev.interpolateToSelf(this,1-t),this},s.prototype.setPreviousPosition=function(t){return this.prev.set(t),this},s.prototype.setWeight=function(t){this.weight=t,this.invWeight=0!==t?1/t:0},s.prototype.unlock=function(){return this.clearVelocity(),this.isLocked=!1,this},s.prototype.update=function(){this.isLocked||(this.applyBehaviors(),this.temp.set(this),this.addSelf(this.sub(this.prev).addSelf(this.force.scale(this.weight))),this.prev.set(this.temp),this.force.clear(),this.applyConstraints())},i.exports=s}),i("toxi/physics2d/ParticlePath2D",["require","exports","module","../internals","../geom/Spline2D","./VerletParticle2D"],function(t,e,i){var n=t("../internals"),r=t("../geom/Spline2D"),s=t("./VerletParticle2D"),o=function(t){r.call(this,t),this.particles=[]};n.extend(o,r),o.prototype.createParticles=function(t,e,i,n){this.particles=[],this.computeVertices(e);var r=0,o=this.getDecimatedVertices(i,!0);for(r=0;r<o.length;r++){var a=o[r],h=new s(a,n);this.particles.push(h),t.addParticle(h)}return this.particles},i.exports=o}),i("toxi/physics2d/VerletSpring2D",["require","exports","module"],function(t,e,i){var n=function(t,e,i,n){this.a=t,this.b=e,this.restLength=i,this.strength=n};n.EPS=1e-6,n.prototype={getRestLength:function(){return this.restLength},getStrength:function(){return this.strength},lockA:function(t){return this.isALocked=t,this},lockB:function(t){return this.isBLocked=t,this},setRestLength:function(t){return this.restLength=t,this.restLengthSquared=t*t,this},setStrength:function(t){return this.strength=t,this},update:function(t){var e=this.b.sub(this.a),i=e.magnitude()+n.EPS,r=(i-this.restLength)/(i*(this.a.invWeight+this.b.invWeight))*this.strength;this.a.isLocked||this.isALocked||(this.a.addSelf(e.scale(r*this.a.invWeight)),t&&this.a.applyConstraints()),this.b.isLocked||this.isBLocked||(this.b.addSelf(e.scale(-r*this.b.invWeight)),t&&this.b.applyConstraints())}},i.exports=n}),i("toxi/physics2d/ParticleString2D",["require","exports","module","./VerletParticle2D","./VerletSpring2D"],function(t,e,i){var n=t("./VerletParticle2D"),r=t("./VerletSpring2D"),s=function(){var t={physics:void 0,plist:void 0,pos:void 0,step:void 0,num:void 0,mass:void 0,strength:void 0},e=!1;if(0===arguments.length)throw new Error("Incorrect Parameters");if(1==arguments.length){var i=arguments[0];for(var r in i)t[r]=i[r]}else t.physics=arguments[0],6==arguments.length?(t.pos=arguments[1],t.step=arguments[2],t.num=arguments[3],t.mass=arguments[4],t.strength=arguments[5]):(t.plist=arguments[1],t.strength=arguments[2]);if(void 0!==t.num&&void 0!==t.pos&&void 0!==t.step&&void 0!==t.mass&&(e=!0),!e&&void 0===t.plist)throw new Error("Incorrect Parameters, please supply plist or num, pos, step & mass");this.physics=t.physics,this.links=[];var s,o,a,h,u=0;if(e){var c=t.pos.copy(),l=t.step,f=t.mass,p=l.magnitude();for(this.particles=[],h=t.strength,u=0;u<t.num;u++)o=new n(c.copy(),f),this.particles.push(o),this.physics.particles.push(o),void 0!==s&&(a=this.createSpring(s,o,p,h),this.links.push(a),this.physics.addSpring(a)),s=o,c.addSelf(l)}else for(h=t.strength,this.particles=t.plist||[],u=0;u<this.particles.length;u++)o=this.particles[u],this.physics.addParticle(o),void 0!==s&&(a=this.createSpring(s,o,s.distanceTo(o),h),this.links.push(a),this.physics.addSpring(a)),s=o};s.prototype={clear:function(){for(var t=0,e=this.links.length;e>t;t++)this.physics.removeSpringElements(this.links[t]);this.particles=[],this.links=[]},createSpring:function(t,e,i,n){return new r(t,e,i,n)},getHead:function(){return this.particles[0]},getNumParticles:function(){return this.particles.length},getTail:function(){return this.particles[this.particles.length-1]}},i.exports=s}),i("toxi/physics2d/PullBackString2D",["require","exports","module","../internals","./VerletSpring2D"],function(t,e,i){var n=t("../internals"),r=t("./VerletSpring2D"),s=function(t,e,i){r.apply(this,[t,e,0,i]),t.lock(),this.setRestLength(.5)};n.extend(s,r),s.prototype.update=function(t){this.b.distanceToSquared(this.a)>this.restLengthSquared&&this.parent.update.call(this,t)},i.exports=s}),i("toxi/physics2d/VerletConstrainedSpring2D",["require","exports","module","../internals","./VerletSpring2D"],function(t,e,i){var n=t("../internals"),r=t("./VerletSpring2D"),s=function(t,e,i,n,s){r.call(this,t,e,i,n),this.limit=void 0===s?Number.MAX_VALUE:s};n.extend(s,r),s.update=function(t){var e=this.b.sub(this.a),i=e.magnitude()+r.EPS,n=(i-this.restLength)/(i*(this.a.invWeight+this.b.invWeight))*this.strength;this.a.isLocked||this.isALocked||(this.a.addSelf(e.scale(n*this.a.invWeight).limit(this.limit)),t&&this.a.applyConstraints()),this.b.isLocked||this.isBLocked||(this.b.subSelf(e.scale(n*this.b.invWeight).limit(this.limit)),t&&this.b.applyConstraints())},i.exports=s}),i("toxi/physics2d/VerletMinDistanceSpring2D",["require","exports","module","../internals","./VerletSpring2D"],function(t,e,i){var n=t("../internals"),r=t("./VerletSpring2D"),s=function(t,e,i,n){r.call(this,t,e,i,n),this.setRestLength(i)};n.extend(s,r),s.prototype.update=function(t){this.b.distanceToSquared(this.a)<this.restLengthSquared&&this.parent.update.call(this,t)},i.exports=s}),i("toxi/physics2d/behaviors/ConstantForceBehavior",["require","exports","module","../../geom/Vec2D"],function(t,e,i){var n=t("../../geom/Vec2D"),r=function(t){this.force=t,this.scaledForce=new n,this.timeStep=0};r.prototype={applyBehavior:function(t){t.addForce(this.scaledForce)},configure:function(t){this.timeStep=t,this.setForce(this.force)},getForce:function(){return this.force},setForce:function(t){this.force=t,this.scaledForce=this.force.scale(this.timeStep)},toString:function(){return"behavior force: "+this.force+" scaledForce: "+this.scaledForce+" timeStep: "+this.timeStep}},i.exports=r}),i("toxi/physics2d/behaviors/GravityBehavior",["require","exports","module","../../internals","./ConstantForceBehavior"],function(t,e,i){var n=t("../../internals"),r=t("./ConstantForceBehavior"),s=function(t){r.call(this,t)};n.extend(s,r),s.prototype.configure=function(t){this.timeStep=t,this.scaledForce=this.force.scale(t*t)},i.exports=s}),i("toxi/physics2d/VerletPhysics2D",["require","exports","module","../internals","./behaviors/GravityBehavior","../geom/Rect","../geom/Vec2D"],function(t,e,i){var n=t("../internals"),r=t("./behaviors/GravityBehavior"),s=t("../geom/Rect"),o=t("../geom/Vec2D"),a=0,h=function(t,e,i,s){var h,u={numIterations:50,drag:0,timeStep:1};1==arguments.length&&(arguments[0].gravity||arguments[0].numIterations||arguments[0].timeStep||arguments[0].drag)?(h=arguments[0],u.gravity=h.gravity,u.numIterations=h.numIterations||u.numIterations,u.drag=h.drag||u.drag,u.timeStep=h.timeStep||u.timeStep):1==arguments.length?u.gravity=t:4==arguments.length&&(u.gravity=t,u.numIterations=e,u.drag=i,u.timeStep=s),this.behaviors=[],this.particles=[],this.springs=[],this.numIterations=u.numIterations,this.timeStep=u.timeStep,this.setDrag(u.drag),u.gravity&&(n.has.XY(u.gravity)&&(u.gravity=new r(new o(u.gravity))),this.addBehavior(u.gravity)),this.id=a++};h.addConstraintToAll=function(t,e){for(var i=0;i<e.length;i++)e[i].addConstraint(t)},h.removeConstraintFromAll=function(t,e){for(var i=0;i<e.length;i++)e[i].removeConstraint(t)},h.prototype={addBehavior:function(t){t.configure(this.timeStep),this.behaviors.push(t)},addParticle:function(t){return this.particles.push(t),this},addSpring:function(t){return void 0===this.getSpring(t.a,t.b)&&this.springs.push(t),this},clear:function(){return this.particles=[],this.springs=[],this},constrainToBounds:function(){var t,e=0,i=this.particles.length;for(e=0;i>e;e++)t=this.particles[e],void 0!==t.bounds&&t.constrain(t.bounds);if(void 0!==this.worldBounds)for(e=0;i>e;e++)t=this.particles[e],t.constrain(this.worldBounds)},getCurrentBounds:function(){for(var t,e=new o(Number.MAX_VALUE,Number.MAX_VALUE),i=new o(Number.MIN_VALUE,Number.MIN_VALUE),n=0,r=this.particles.length;r>n;n++)t=this.particles[n],e.minSelf(t),i.maxSelf(t);return new s(e,i)},getDrag:function(){return 1-this.drag},getNumIterations:function(){return this.numIterations},getSpring:function(t,e){for(var i=0,n=this.springs.length;n>i;i++){var r=this.springs[i];if(r.a===t&&r.b===e||r.a===e&&r.b===e)return r}return void 0},getTimeStep:function(){return this.timeStep},getWorldBounds:function(){return this.worldBounds},removeBehavior:function(t){return n.removeItemFrom(t,this.behaviors)},removeParticle:function(t){return n.removeItemFrom(t,this.particles)},removeSpring:function(t){return n.removeItemFrom(t,this.springs)},removeSpringElements:function(t){return void 0!==this.removeSpring(t)?this.removeParticle(t.a)&&this.removeParticle(t.b):!1},setDrag:function(t){this.drag=1-t},setNumIterations:function(t){this.numIterations=t},setTimeStep:function(t){this.timeStep=t;for(var e=0,i=this.behaviors.length;i>e;e++)this.behaviors[e].configure(t)},setWorldBounds:function(t){return this.worldBounds=t,this},update:function(){return this.updateParticles(),this.updateSprings(),this.constrainToBounds(),this},updateParticles:function(){for(var t,e,i=0,n=0,r=this.behaviors.length,s=this.particles.length;r>i;i++)for(t=this.behaviors[i],n=0;s>n;n++)t.applyBehavior(this.particles[n]);for(n=0;s>n;n++)e=this.particles[n],e.scaleVelocity(this.drag),e.update()},updateSprings:function(){for(var t=this.numIterations,e=this.springs.length,i=0;t>0;t--)for(i=0;e>i;i++)this.springs[i].update(1===t)}},i.exports=h}),i("toxi/physics2d/behaviors/AttractionBehavior",["require","exports","module"],function(t,e,i){var n=function(t,e,i,n){if(arguments.length<3)throw new Error("Constructor received incorrect Parameters");this.jitter=n||0,this.attractor=t,this.strength=i,this.setRadius(e)};n.prototype={applyBehavior:function(t){var e=this.attractor.sub(t),i=e.magSquared();if(i<this.radiusSquared){var n=e.normalizeTo(1-i/this.radiusSquared).jitter(this.jitter).scaleSelf(this.attrStrength);t.addForce(n)}},configure:function(t){this.timeStep=t,this.setStrength(this.strength)},getAttractor:function(){return this.attractor},getJitter:function(){return this.jitter},getRadius:function(){return this.radius},getStrength:function(){return this.strength},setAttractor:function(t){this.attractor=t},setJitter:function(t){this.jitter=t},setRadius:function(t){this.radius=t,this.radiusSquared=t*t},setStrength:function(t){this.strength=t,this.attrStrength=t*this.timeStep}},i.exports=n}),i("toxi/physics2d/behaviors",["exports","./behaviors/AttractionBehavior","./behaviors/ConstantForceBehavior","./behaviors/GravityBehavior"],function(t,e,i,n){t.AttractionBehavior=e,t.ConstantForceBehavior=i,t.GravityBehavior=n}),i("toxi/physics2d/constraints/AngularConstraint",["require","exports","module","../../geom/Vec2D"],function(t,e,i){var n=t("../../geom/Vec2D"),r=function(t,e){arguments.length>1?(this.theta=e,this.rootPos=new n(t)):(this.rootPos=new n,this.theta=t)};r.prototype.applyConstraint=function(t){var e=t.sub(this.rootPos),i=Math.floor(e.heading()/this.theta)*this.theta;t.set(this.rootPos.add(n.fromTheta(i).scaleSelf(e.magnitude())))},i.exports=r}),i("toxi/physics2d/constraints/AxisConstraint",["require","exports","module"],function(t,e,i){var n=function(t,e){this.axis=t,this.constraint=e};n.prototype.applyConstraint=function(t){t.setComponent(this.axis,this.constraint)},i.exports=n}),i("toxi/physics2d/constraints/CircularConstraint",["require","exports","module","../../geom/Circle"],function(t,e,i){var n=t("../../geom/Circle"),r=function(t,e){this.circle=1==arguments.length?t:new n(t,e)};r.prototype.applyConstraint=function(t){this.circle.containsPoint(t)&&t.set(this.circle.add(t.sub(this.circle).normalizeTo(this.circle.getRadius())))},i.exports=r}),i("toxi/physics2d/constraints/MaxConstraint",["require","exports","module"],function(t,e,i){var n=function(t,e){this.axis=t,this.threshold=e};n.prototype.applyConstraint=function(t){t.getComponent(this.axis)>this.threshold&&t.setComponent(this.axis,this.threshold)},i.exports=n}),i("toxi/physics2d/constraints/MinConstraint",["require","exports","module"],function(t,e,i){var n=function(t,e){this.axis=t,this.threshold=e};n.prototype.applyConstraint=function(t){t.getComponent(this.axis)<this.threshold&&t.setComponent(this.axis,this.threshold)},i.exports=n}),i("toxi/physics2d/constraints/RectConstraint",["require","exports","module","../../geom/Vec2D","../../internals/has","../../geom/Ray2D","../../geom/Rect"],function(t,e,i){var n=t("../../geom/Vec2D"),r=t("../../internals/has"),s=t("../../geom/Ray2D"),o=t("../../geom/Rect"),a=function(t,e){if(1==arguments.length?"function"==typeof t.copy?this.rect=t.copy():r.XYWidthHeight(t)&&(this.rect=new o(t)):arguments.length>1&&(this.rect=new o(t,e)),!this.rect)throw new Error("Received Incorrect arguments");this.intersectRay=new s(this.rect.getCentroid(),new n)};a.prototype={applyConstraint:function(t){this.rect.containsPoint(t)&&t.set(this.rect.intersectsRay(this.intersectRay.setDirection(this.intersectRay.sub(t)),0,Number.MAX_VALUE))},getBox:function(){return this.rect.copy()},setBox:function(t){this.rect=t.copy(),this.intersectRay.set(this.rect.getCentroid())}},i.exports=a}),i("toxi/physics2d/constraints",["exports","./constraints/AngularConstraint","./constraints/AxisConstraint","./constraints/CircularConstraint","./constraints/MaxConstraint","./constraints/MinConstraint","./constraints/RectConstraint"],function(t,e,i,n,r,s,o){t.AngularConstraint=e,t.AxisConstraint=i,t.CircularConstraint=n,t.MaxConstraint=r,t.MinConstraint=s,t.RectConstraint=o}),i("toxi/physics2d",["require","exports","module","./physics2d/ParticlePath2D","./physics2d/ParticleString2D","./physics2d/PullBackString2D","./physics2d/VerletConstrainedSpring2D","./physics2d/VerletMinDistanceSpring2D","./physics2d/VerletParticle2D","./physics2d/VerletPhysics2D","./physics2d/VerletSpring2D","./physics2d/behaviors","./physics2d/constraints"],function(t,e,i){i.exports={ParticlePath2D:t("./physics2d/ParticlePath2D"),ParticleString2D:t("./physics2d/ParticleString2D"),PullBackString2D:t("./physics2d/PullBackString2D"),VerletConstrainedSpring2D:t("./physics2d/VerletConstrainedSpring2D"),VerletMinDistanceSpring2D:t("./physics2d/VerletMinDistanceSpring2D"),VerletParticle2D:t("./physics2d/VerletParticle2D"),VerletPhysics2D:t("./physics2d/VerletPhysics2D"),VerletSpring2D:t("./physics2d/VerletSpring2D")},i.exports.behaviors=t("./physics2d/behaviors"),i.exports.constraints=t("./physics2d/constraints")}),i("toxi/processing/ToxiclibsSupport",["require","exports","module","../geom/Matrix4x4","../geom/Vec3D","../geom/mesh/TriangleMesh"],function(t,e,i){var n=t("../geom/Matrix4x4"),r=t("../geom/Vec3D"),s=t("../geom/mesh/TriangleMesh"),o=function(t,e){if("undefined"==typeof Processing)throw new Error("Processing.js has not been loaded");this.sketch=t,this.app=t,this.gfx=void 0!==e?t:this.app,this._normalMap=(new n).translateSelf(128,128,128).scaleSelf(127)};o.prototype={box:function(t,e){var i=t.toMesh();void 0===e&&(e=!1),e&&i.computeVertexNormals(),this.mesh(i,e,0)},circle:function(t,e){this.gfx.ellipse(t.x,t.y,e,e)},cone:function(){var t=arguments[0],e=6,i=0,n=!0,r=!0,o=!1;5==arguments.length?(e=arguments[1],n=arguments[2],r=arguments[3],o=arguments[4]):3==arguments.length&&(e=arguments[1],o=arguments[2]);var a=t.toMesh({mesh:new s,steps:e,thetaOffset:i,topClosed:n,bottomClosed:r});o&&a.computeVertexNormals(),window.mesh=a,this.mesh(a,o,0)},cylinder:function(t,e,i){if(1==arguments.length)this.mesh(t.toMesh(),!1,0);else{var n=t.toMesh(e,0);void 0===i&&(i=!1),i&&n.computeVertexNormals(),this.mesh(n,i,0)}},ellipse:function(t,e){var i=t.getRadii();void 0===e&&(e=this.app.CENTER),e===this.app.CENTER?this.gfx.ellipse(t.x,t.y,2*i.x,2*i.y):e===this.app.RADIUS?this.gfx.ellipse(t.x,t.y,2*i.x,2*i.y):(e===this.app.CORNER||this.gfx.ellipseMode===this.app.CORNERS)&&this.gfx.ellipse(t.x-i.x,t.y-i.y,2*i.x,2*i.y)},getGraphics:function(){return this.gfx},line:function(){var t,e;if(1==arguments.length){var i=arguments[0];t=i.a,e=i.b}else t=arguments[0],e=arguments[1];void 0===t.z?this.gfx.line(t.x,t.y,e.x,e.y):this.gfx.line(t.x,t.y,t.z,e.x,e.y,e.z)},lineStrip2D:function(t){this.processVertices2D(t,this.app.POLYGON,!1)},lineStrip3D:function(t){this.processVertices3D(t,this.app.POLYGON,!1)},mesh:function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=0),this.gfx.beginShape(this.app.TRIANGLES);var n=0,r=t.faces.length;if(e)for(n=0;r>n;n++){var s=t.faces[n];this.gfx.normal(s.a.normal.x,s.a.normal.y,s.a.normal.z),this.gfx.vertex(s.a.x,s.a.y,s.a.z),this.gfx.normal(s.b.normal.x,s.b.normal.y,s.b.normal.z),this.gfx.vertex(s.b.x,s.b.y,s.b.z),this.gfx.normal(s.c.normal.x,s.c.normal.y,s.c.normal.z),this.gfx.vertex(s.c.x,s.c.y,s.c.z)}else for(var n=0;r>n;n++){var s=t.faces[n];this.gfx.normal(s.normal.x,s.normal.y,s.normal.z),this.gfx.vertex(s.a.x,s.a.y,s.a.z),this.gfx.vertex(s.b.x,s.b.y,s.b.z),this.gfx.vertex(s.c.x,s.c.y,s.c.z)}if(this.gfx.endShape(),i>0){var o=0,a=this.gfx.stroke;if(a&&(o=this.gfx.strokeColor),r=t.vertices.length,e)for(n=0;r>n;n++){var h=t.vertices[n],u=h.add(h.normal.scale(i));p=h.normal.scale(127),this.gfx.stroke(p.x+128,p.y+128,p.z+128),this.gfx.line(h.x,h.y,h.z,u.x,u.y,u.z)}else{var c=1/3;for(r=t.faces.length,n=0;r>n;n++){var s=t.faces[n],l=s.a.add(s.b).addSelf(s.c).scaleSelf(c),f=l.add(s.normal.scale(i)),p=s.normal.scale(127);this.gfx.stroke(p.x+128,p.y+128,p.z+128),this.gfx.line(l.x,l.y,l.z,f.x,f.y,f.z)}}a?this.gfx.stroke(o):this.gfx.noStroke()}},meshNormalMapped:function(t,e,i){this.gfx.beginShape(this.app.TRIANGLES);var n=0,r=t.faces.length;if(e)for(n=0;r>n;n++){var s=t.faces[n],o=this._normalMap.applyTo(s.a.normal);this.gfx.fill(o.x,o.y,o.z),this.gfx.normal(s.a.normal.x,s.a.normal.y,s.a.normal.z),this.gfx.vertex(s.a.x,s.a.y,s.a.z),o=this._normalMap.applyTo(s.b.normal),this.gfx.fill(o.x,o.y,o.z),this.gfx.normal(s.b.normal.x,s.b.normal.y,s.b.normal.z),this.gfx.vertex(s.b.x,s.b.y,s.b.z),o=this._normalMap.applyTo(s.c.nromal),this.gfx.fil(o.x,o.y,o.z),this.gfx.normal(s.c.normal.x,s.c.normal.y,s.c.normal.z),this.gfx.vertex(s.c.x,s.c.y,s.c.z)}else for(n=0;r>n;n++){var s=t.faces[n];this.gfx.normal(s.normal.x,s.normal.y,s.normal.z),this.gfx.vertex(s.a.x,s.a.y,s.a.z),this.gfx.vertex(s.b.x,s.b.y,s.b.z),this.gfx.vertex(s.c.x,s.c.y,s.c.z)}if(this.gfx.endShape(),i>0)if(e)for(r=t.vertices.length,n=0;r>n;n++){var a=t.vertices[n],h=a.add(a.normal.scale(i)),o=a.normal.scale(127);this.gfx.stroke(o.x+128,o.y+128,o.z+128),this.gfx.line(a.x,a.y,a.z,h.x,h.y,h.z)}else for(r=t.faces.length,n=0;r>n;n++){var s=t.faces[n],u=s.getCentroid(),c=u.add(s.normal.scale(i)),o=s.normal.scale(127);this.gfx.stroke(o.x+128,o.y+128,o.z+128),this.gfx.line(u.x,u.y,u.z,c.x,c.y,c.z)}},origin:function(){var t=void 0,e=void 0;1==arguments.length?(e=arguments[0],t=r.ZERO):(t=arguments[0],e=arguments[1]),this.gfx.stroke(255,0,0),this.gfx.line(t.x,t.y,t.z,t.x+e,t.y,t.z),this.gfx.stroke(0,255,0),this.gfx.line(t.x,t.y,t.z,t.x,t.y+e,t.z),this.gfx.stroke(0,0,255),this.gfx.line(t.x,t.y,t.z,t.x,t.y,t.z+e)},plane:function(t,e){this.mesh(t.toMesh(e),!1,0)},point:function(t){void 0===t.z?this.gfx.point(t.x,t.y):this.gfx.point(t.x,t.y,t.z)},points2D:function(t){this.processVertices2D(t,this.app.POINTS,!1)},points3D:function(t){this.processVertices3D(t,this.app.POINTS,!1)},polygon2D:function(t){this.processVertices2D(t.vertices,this.app.POLYGON,!1)},processVertices2D:function(t,e,i){(void 0===t.hasNext||void 0===t.next)&&(t=new this.app.ObjectIterator(t)),this.gfx.beginShape(e);for(var n=void 0;t.hasNext();)this.gfx.vertex(n.x,n.y);i?this.gfx.endShape(this.app.CLOSE):this.gfx.endShape()},processVertices3D:function(t,e,i){(void 0===t.hasNext||void 0===t.next)&&(t=new this.app.ObjectIterator(t)),this.gfx.beginShape(e);for(var n=void 0;t.hasNext();)this.gfx.vertex(n.x,n.y,n.z);i?this.gfx.endShape(this.app.CLOSE):this.gfx.endShape()},ray:function(t,e){var i=t.getPointAtDistance(e);void 0===t.z?this.gfx.line(t.x,t.y,i.x,i.y):this.gfx.line(t.x,t.y,t.z,i.x,i.y,i.z)},rect:function(t,e){if(void 0===e&&(e=this.app.CORNER),e===this.app.CORNER)this.gfx.rect(t.x,t.y,t.width,t.height);else if(e===this.app.CORNERS)this.gfx.rect(t.x,t.y,t.x+t.width,t.y+t.height);else if(e===this.app.CENTER)this.gfx.rect(t.x+.5*t.widt,t.y+.5*t.height,t.width,t.height);else if(e===this.app.RADIUS){var i=.5*t.width,n=.5*t.height;this.gfx.rect(t.x+i,t.y+n,i,n)}},setGraphics:function(t){this.gfx=t},sphere:function(t,e,i){this.mesh(t.toMesh(e),i)},texturedMesh:function(t,e,i){this.gfx.beginShape(this.app.TRIANGLES),this.gfx.texture(e);var n=0,r=t.faces.length;if(i)for(n=0;r>n;n++){var s=t.faces[n];void 0!==s.uvA&&void 0!==s.uvB&&void 0!==s.uvC?(this.gfx.normal(s.a.normal.x,s.a.normal.y,s.a.normal.z),this.gfx.vertex(s.a.x,s.a.y,s.a.z,s.uvA.x,s.uvA.y),this.gfx.normal(s.b.normal.x,s.b.normal.y,s.b.normal.z),this.gfx.vertex(s.b.x,s.b.y,s.b.z,s.uvB.x,s.uvB.y),this.gfx.normal(s.c.normal.x,s.c.normal.y,s.c.normal.z),this.gfx.vertex(s.c.x,s.c.y,s.c.z,s.uvC.x,s.uvC.y)):(this.gfx.vertex(s.a.x,s.a.y,s.a.z),this.gfx.vertex(s.b.x,s.b.y,s.b.z),this.gfx.vertex(s.c.x,s.c.y,s.c.z))}else for(n=0;r>n;n++){var s=t.faces[n];this.gfx.normal(s.normal.x,s.normal.y,s.normal.z),void 0!==s.uvA&&void 0!==s.uvB&&void 0!==s.uvC?(this.gfx.vertex(s.a.x,s.a.y,s.a.z,s.uvA.x,s.uvA.y),this.gfx.vertex(s.b.x,s.b.y,s.b.z,s.uvB.x,s.uvB.y),this.gfx.vertex(s.c.x,s.c.y,s.c.z,s.uvC.x,s.uvC.y)):(this.gfx.vertex(s.a.x,s.a.y,s.a.z),this.gfx.vertex(s.b.x,s.b.y,s.b.z),this.gfx.vertex(s.c.x,s.c.y,s.c.z))}this.gfx.endShape()},triangle:function(t,e){var i=function(){return void 0!==t.a&&void 0!==t.b&&void 0!==t.c?void 0!==t.a.x:!1},n=function(){return i()?void 0!==t.a.z:!1};if((e||void 0===e)&&this.gfx.beginShape(this.app.TRIANGLES),n()){var r=t.computeNormal();this.gfx.normal(r.x,r.y,r.z),this.gfx.vertex(t.a.x,t.a.y,t.a.z),this.gfx.vertex(t.b.x,t.b.y,t.b.z),this.gfx.vertex(t.c.x,t.c.y,t.c.z)}else this.gfx.vertex(t.a.x,t.a.y),this.gfx.vertex(t.b.x,t.b.y),this.gfx.vertex(t.c.x,t.c.y);(e||void 0===e)&&this.gfx.endShape()},vertex:function(t){void 0===t.z?this.gfx.vertex(t.x,t.y):this.gfx.vertex(t.x,t.y,t.z)}},i.exports=o}),i("toxi/processing",["require","exports","module","./processing/ToxiclibsSupport"],function(t,e,i){i.exports={ToxiclibsSupport:t("./processing/ToxiclibsSupport")}}),i("toxi/THREE/ToxiclibsSupport",["../internals/is"],function(t){var e=function(t){if(void 0===THREE)throw new Error("THREE.js has not been loaded");this.scene=t,this.objectDictionary={}};return e.createLineGeometry=function(t,i){return e.createMeshGeometry({vertices:[t.a,t.b]},i)},e.createMeshGeometry=function(e,i){i=i||new THREE.Geometry;var n,r,s,o,a,h={};if(a=t.Array(e)?e:e.vertices,o=a.length,!a)throw new Error("no vertices found");for(r=0;o>r;r++)n=a[r],i.vertices[r]=new THREE.Vector3(n.x,n.y,n.z),h[n.id]=r;if(e.faces)for(o=e.faces.length,r=0;o>r;r++)s=e.faces[r],i.faces[r]=new THREE.Face3(h[s.a.id],h[s.b.id],h[s.c.id],new THREE.Vector3(s.normal.x,s.normal.y,s.normal.z));return i.computeCentroids(),i.computeVertexNormals(),i},e.createMesh=function(t,i){void 0===i&&(i=new THREE.MeshBasicMaterial);var n=e.createMeshGeometry(t);return new THREE.Mesh(n,i)},e.createParticle=function(t,e){var i=new THREE.Particle(e);return i.position.x=t.x,i.position.y=t.y,i.position.z=t.z,i},e.prototype={addLine:function(t,i){void 0===i&&(i=new THREE.LineBasicMaterial);var n=e.createLineGeometry(t),r=new THREE.Line(n,i);return this.scene.add(r),r},addMesh:function(t,e){var i;1==arguments.length?(i=t.geometry,e=t.materials):i=t;var n=this.createMesh(i,e);return this.scene.add(n),n},addParticles:function(e,i){void 0===i&&(i=new THREE.ParticleBasicMaterial),e=t.Array(e)?e:[e];for(var n,r=new THREE.Geometry,s=0,o=e.length;o>s;s++)n=e[s],r.vertices[s]=new THREE.Vector3(n.x,n.y,n.z);var a=new THREE.ParticleSystem(r,i);return this.scene.add(a),r},createMeshGeometry:function(t){return e.createMeshGeometry(t)},createMesh:function(t,i){return e.createMesh(t,i)}},e}),i("toxi/THREE",["require","exports","module","./THREE/ToxiclibsSupport"],function(t,e,i){i.exports={ToxiclibsSupport:t("./THREE/ToxiclibsSupport")}}),i("toxi/util/datatypes/ArraySet",["require","exports","module","../../internals"],function(t,e,i){var n=t("../../internals"),r=function(t){if(Array.apply(this),arguments.length>=1)for(var e=0,i=t.length;i>e;e++){var n=t[e];this.indexOf(n)<0&&this.push(n)}};n.extend(r,Array),n.mixin(r.prototype,{add:function(t){return this.contains(t)?!1:(this.push(t),!0)},addAll:function(t){for(var e=0,i=t.length;i>e;e++)this.push(t[e])},clear:function(){this.retainAll([])},clone:function(){return new r(this)},contains:function(t){return this.indexOf(t)>=0},containsAll:function(t){for(var e=0,i=t.length;i>e;e++){var n=t[e];if(!this.contains(n))return!1}return!0},containsAny:function(t){for(var e=0,i=t.length;i>e;e++)if(this.contains(t[e]))return!0;return!1},equals:function(t){return this===t},get:function(t){return this[t]},iterator:function(){return new n.Iterator(this)},isEmpty:function(){return this.length<1},remove:function(t){var e=this.indexOf(t);return e>=0?(this.splice(e,1),!0):!1},removeAll:function(){this.retainAll([])},retainAll:function(t){for(var e=!1,i=0;i<this.length;i++){var n=this[i];t.indexOf(n)<0&&(this.splice(i,1),e=!0,i--)}return e},size:function(){return this.length},toArray:function(t){t=t||[];for(var e=0;e<this.length;e++)this.hasOwnProperty()&&(t[e]=this[e]);return t}}),i.exports=r}),i("toxi/util/datatypes/UndirectedGraph",["require","exports","module","./ArraySet"],function(t,e,i){var n=t("./ArraySet"),r=function(){this._nodeLinks={},this._nodeIDs=[]};r.prototype={add:function(t){void 0===this._nodeLinks[t]&&(this._nodeLinks[t]=new n,this._nodeIDs.push(t))},connect:function(t,e){if(void 0===this._nodeLinks[t])throw new Error("nodeA has not been added");if(void 0===this._nodeLinks[e])throw new Error("nodeB has not been added");this._nodeLinks[t].push(e),this._nodeLinks[e].push(t)},disconnect:function(t,e){if(void 0===this._nodeLinks[t])throw new Error("nodeA has not been added");if(void 0===this._nodeLinks[e])throw new Error("nodeB has not been added");this._nodeLinks[t].splice(this._nodeLinks[t].indexOf(e),1),this._nodeLinks[e].splice(this._nodeLinks[e].indexOf(t),1)},getConnectedNodesFor:function(t){if(void 0===this._nodeLinks[t])throw new Error("node has not been added");return this._nodeLinks[t]},getNodes:function(){return this._nodeIDs},remove:function(t){var e=this._nodeLinks[t];if(void 0!==e){for(var i=0,n=e.length;n>i;i++){var r=e[i],s=r.indexOf(t);r.splice(s,1)}delete this._nodeLinks[t];var i=this._nodeIDs.indexOf(t);this._nodeIDs.splice(t,1)}}},i.exports=r}),i("toxi/util/datatypes",["require","exports","module","./datatypes/ArraySet","./datatypes/FloatRange","./datatypes/UndirectedGraph"],function(t,e,i){i.exports={ArraySet:t("./datatypes/ArraySet"),FloatRange:t("./datatypes/FloatRange"),UndirectedGraph:t("./datatypes/UndirectedGraph")}}),i("toxi/util",["require","exports","module","./util/datatypes"],function(t,e){e.datatypes=t("./util/datatypes")}),i("toxi/main",["require","exports","./color","./geom","./internals","./math","./physics2d","./processing","./THREE","./util"],function(t,e){e.color=t("./color"),e.geom=t("./geom"),e.internals=t("./internals"),e.math=t("./math"),e.physics2d=t("./physics2d"),e.processing=t("./processing"),e.THREE=t("./THREE"),e.util=t("./util")}),i("toxi",["./toxi/main"],function(t){return t}),i.unordered=!0,toxi=e("toxi"),toxi.VERSION="0.2.7"}();